‎
<!DOCTYPE html>
<html>
<head>
    <style>
        table td {
            font-size:50%;
            border: 1px solid red;‏
            height:3%;
             width:3%;
        }

        a.dp-choose-date {
	float: left;
	width: 16px;
	height: 16px;
	padding: 0;
	margin: 5px 3px 0;
	display: block;
	text-indent: -2000px;
	overflow: hidden;
	background: url(calendar.png) no-repeat; 
}
a.dp-choose-date.dp-disabled {
	background-position: 0 -20px;
	cursor: default;
}
/* makes the input field shorter once the date picker code
 * has run (to allow space for the calendar icon
 */
input.dp-applied {
	width: 140px;
	float: left;
}
    </style>
    <title>אפלייקצית Info</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <!--<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.1/themes/base/jquery-ui.css" />-->
    <!--<script src="http://code.jquery.com/ui/1.9.1/jquery-ui.js"></script>-->
    
    <!--<link href="../css/themes/default/rtl.jquery.mobile-1.4.0.css" rel="stylesheet" />
    <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>-->
    <link href="jquery.mobile-1.4.5.min.css" rel="stylesheet" />
      <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <!--<link href="css/themes/default/rtl.jquery.mobile-1.4.0.css" rel="stylesheet" />-->
    <script src="scripts/jquery-1.11.3.min.js"></script>
    <!--<script src="scripts/jquery.mobile-1.4.5.min.js"></script>-->
    <script src="scripts/rtl.jquery.mobile-1.4.0.js"></script>
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false&libraries=places"></script>
    <script type="text/javascript" src="http://www.google.com/jsapi"></script>
    <script src ="http://maps.googleapis.com/maps/api/js"></script>
    <link href="css/themes/default/rtl.jquery.mobile-1.4.0.css" rel="stylesheet" />

        <script type="text/javascript" src="js/ui/jquery.ui.datepicker.js"></script>
        <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
        <!--<script src="js/jquery-ui-1.9.2.custom.min.js"></script>-->
        <!--<script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
        <script type="text/javascript" src="js/ui/jquery.ui.core.js"></script>-->


        <script type="text/javascript">

            function RemovePage() {
                $(document).on('pagebeforehide', function (event) {
                    $('#mypanel').remove();
                });
            }


            //_________________ FIRST PAGE ________________

            //מקבל את המיקום שאיתו רוצים להשוות
            //מחשב מרחק
            var distances;//המשתנה יחיל את המרחק בין
            var x = 0;
            var y = 0;
            var Latitude = '';
            var Longitude = '';
            var Mindistances = '';//מרחק מינימלי מעבודה
            var EnterDate1 = '';//שומר את התאריך של GetDestination
            var datepicker;
            var GlobalDate;
            var GlobalTime;
            var Globaladdress;

            //$(function () {
            //    $.datepicker.setDefaults(
            //      $.extend($.datepicker.regional[''])
            //    );
            //    $('#Vacations2Years').datepicker({
            //        beforeShow: function (input) {
            //            $(input).css('background-color', '#orange');
            //        },
            //        onSelect: function (dateText, obj) {
            //            $(this).css('background-color', 'grey');
            //        },
            //        onClose: function (dateText, obj) {
            //            var date = "";
            //            date = $('#Vacations2Years').val()[3];
            //            date += $('#Vacations2Years').val()[4];
            //            date += '/';
            //            date += $('#Vacations2Years').val()[0];
            //            date += $('#Vacations2Years').val()[1];
            //            date += '/';
            //            date += $('#Vacations2Years').val()[6];
            //            date += $('#Vacations2Years').val()[7];
            //            date += $('#Vacations2Years').val()[8];
            //            date += $('#Vacations2Years').val()[9];
            //            if (date.indexOf("defined") != -1) {
            //                date = "";
            //            }
            //            $('#Vacations2Years').val(date);
            //            $(this).css('background-color', '');
            //        }

            //    });
            //});


            //$(function () {
            //    $.datepicker.setDefaults(
            //      $.extend($.datepicker.regional[''])
            //    );
            //    $('#Vacations2Yearsend').datepicker({
            //        beforeShow: function (input) {
            //            $(input).css('background-color', '#ff0');
            //        },
            //        onSelect: function (dateText, obj) {
            //            $(this).css('background-color', '');
            //        },
            //        onClose: function (dateText, obj) {

            //            var date = "";
            //            date = $('#Vacations2Yearsend').val()[3];
            //            date += $('#Vacations2Yearsend').val()[4];
            //            date += '/';
            //            date += $('#Vacations2Yearsend').val()[0];
            //            date += $('#Vacations2Yearsend').val()[1];
            //            date += '/';
            //            date += $('#Vacations2Yearsend').val()[6];
            //            date += $('#Vacations2Yearsend').val()[7];
            //            date += $('#Vacations2Yearsend').val()[8];
            //            date += $('#Vacations2Yearsend').val()[9];
            //            if (date.indexOf("defined") != -1) {
            //                date = "";
            //            }
            //            $('#Vacations2Yearsend').val(date);

            //            $(this).css('background-color', '');
            //        }
            //    });
            //});

            //$(function () {
            //    $.datepicker.setDefaults(
            //      $.extend($.datepicker.regional[''])
            //    );
            //    $('#Vacations2Yearss').datepicker({
            //        beforeShow: function (input) {
            //            $(input).css('background-color', '#ff0');
            //        },
            //        onSelect: function (dateText, obj) {
            //            $(this).css('background-color', '');
            //        },
            //        onClose: function (dateText, obj) {
            //            var date = "";
            //            date = $('#Vacations2Yearss').val()[3];
            //            date += $('#Vacations2Yearss').val()[4];
            //            date += '/';
            //            date += $('#Vacations2Yearss').val()[0];
            //            date += $('#Vacations2Yearss').val()[1];
            //            date += '/';
            //            date += $('#Vacations2Yearss').val()[6];
            //            date += $('#Vacations2Yearss').val()[7];
            //            date += $('#Vacations2Yearss').val()[8];
            //            date += $('#Vacations2Yearss').val()[9];
            //            if (date.indexOf("defined") != -1)
            //            {
            //                date = "";
            //            }
            //            $('#Vacations2Yearss').val(date);

            //            $(this).css('background-color', '');
            //        }
            //    });
            //});



            //$(function () {
            //    $.datepicker.setDefaults(
            //      $.extend($.datepicker.regional[''])
            //    );
            //    $('#Vacations2Yearsends').datepicker({
            //        beforeShow: function (input) {
            //            $(input).css('background-color', '#ff0');
            //        },
            //        onSelect: function (dateText, obj) {
            //            $(this).css('background-color', '');
            //        },
            //        onClose: function (dateText, obj) {

            //            var date = "";
            //            date = $('#Vacations2Yearsends').val()[3];
            //            date += $('#Vacations2Yearsends').val()[4];
            //            date += '/';
            //            date += $('#Vacations2Yearsends').val()[0];
            //            date += $('#Vacations2Yearsends').val()[1];
            //            date += מצב מחלקה עדכני
            //            date += $('#Vacations2Yearsends').val()[6];
            //            date += $('#Vacations2Yearsends').val()[7];
            //            date += $('#Vacations2Yearsends').val()[8];
            //            date += $('#Vacations2Yearsends').val()[9];
            //            if (date.indexOf("defined") != -1) {
            //                date = "";
            //            }
            //            $('#Vacations2Yearsends').val(date);
            //            $(this).css('background-color', '');
            //        }
            //    });
            //});


            //$(function () {
            //    $.datepicker.setDefaults(
            //      $.extend($.datepicker.regional[''])
            //    );
            //    $('#ByYear').datepicker({
            //        beforeShow: function (input) {
            //            $(input).css('background-color', '#ff0');
            //        },
            //        onSelect: function (dateText, obj) {
            //            $(this).css('background-color', '');
            //        },
            //        onClose: function (dateText, obj) {

            //            var date = "";
            //            date = $('#ByYear').val()[3];
            //            date += $('#ByYear').val()[4];
            //            date += '/';
            //            date += $('#ByYear').val()[0];
            //            date += $('#ByYear').val()[1];
            //            date += '/';
            //            date += $('#ByYear').val()[6];
            //            date += $('#ByYear').val()[7];
            //            date += $('#ByYear').val()[8];
            //            date += $('#ByYear').val()[9];
            //            if (date.indexOf("defined") != -1) {
            //                date = "";
            //            }
            //            $('#ByYear').val(date);
            //            $(this).css('background-color', '');
            //        }
            //    });
            //});


            //$(function () {
            //    $.datepicker.setDefaults(
            //      $.extend($.datepicker.regional[''])
            //    );
            //    $('#ByYearManger').datepicker({
            //        beforeShow: function (input) {
            //            $(input).css('background-color', '#ff0');
            //        },
            //        onSelect: function (dateText, obj) {
            //            $(this).css('background-color', '');
            //        },
            //        onClose: function (dateText, obj) {

            //            var date = "";
            //            date = $('#ByYearManger').val()[3];
            //            date += $('#ByYearManger').val()[4];
            //            date += '/';
            //            date += $('#ByYearManger').val()[0];
            //            date += $('#ByYearManger').val()[1];
            //            date += '/';
            //            date += $('#ByYearManger').val()[6];
            //            date += $('#ByYearManger').val()[7];
            //            date += $('#ByYearManger').val()[8];
            //            date += $('#ByYearManger').val()[9];
            //            if (date.indexOf("NaN/undefinedundefined/undefinedundefinedundefinedundefined") != -1) {
            //                date = "";
            //            }
            //            $('#ByYearManger').val(date);
            //            $(this).css('background-color', '');
            //        }
            //    });
            //});



            function GetDestination() {
                var Latitude1 = 0;
                var Longitude1 = 0;
                //var WebServiceURL = "http://ruppinmobile.ac.il.preview26.livedns.co.il/site08/Enterence.asmx"

                var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetDestination",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'Latitude':'" + Latitude + "','Longitude':'" + Longitude + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        return;
                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        Latitude = WorkersObj[0].Latitude;
                        Longitude = WorkersObj[0].Longitude;
                        Mindistances = WorkersObj[0].Distance;
                        return;
                    }
                });
            }



            function initMap() {
                //  y = $("#Times3").toString();
                var radius = 6378.1;
                var bounds = new google.maps.LatLngBounds;
                var markersArray = [];
                var origin1 = { lat: x, lng: y };

                var radlat1 = Math.PI * x / 180
                var radlat2 = Math.PI * Latitude / 180
                var radlon1 = Math.PI * y / 180
                var radlon2 = Math.PI * Longitude / 180
                var theta = y - Longitude
                var radtheta = Math.PI * theta / 180
                var dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);
                dist = Math.acos(dist)
                dist = dist * 180 / Math.PI
                dist = dist * 60 * 1.1515
                dist = dist * 1.609344

                distances = dist * 1000;
                distances = parseInt(distances);
                        $("#DistenceOrNOT").html(" העובד נמצא במרחק של " + distances + " מטרים מהעבודה... המינימום הוא  " + Mindistances + " מטרים ");
                        if (distances <= Mindistances) {

                            flag = true;
                            myFunction2();
                            myFunction5();
                            myFunction6();
                            flagexit = true;
                        }

                        if (flag == false) {
                            myFunction6();
                        }
                        if (flag == true) {
                            $("#DistancefromWork").html("מרחק עדכני של עובד מהעבודה הוא:" + distances + " מטרים");
                            $("#EndWorking").empty();
                            $("#DistenceOrNOT").empty();
                            $.mobile.changePage('#WorkStatus',{ 'transition': 'none' });;
                        }
                        return;
                    }
            //    });
            //}




            function CheckifVacationDay() {

                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetPresence",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        VacationObjs = JSON.parse(data.d); //or data["d"]
                        var CurrentDate = ($.datepicker.formatDate('yy/mm/dd', new Date()));
                        var Stat_Date;
                        var End_Date
                        var d1;
                        var flagVacation = false;
                        for (var i = 0; i < VacationObjs.length; i++) {
                            if (VacationObjs[i].ID == ID && VacationObjs[i].Confirmed_By_Worker == true) {
                                Stat_Date = VacationObjs[i].Stat_Date[6];
                               

                                End_Date = VacationObjs[i].End_Date[6];


                                if (Date.parse(Stat_Date) <= Date.parse(CurrentDate) && Date.parse(CurrentDate) <= Date.parse(End_Date)) {
                                    flagVacation = true;
                                    $("#DistenceOrNOT").html("עובד נמצא בחופשה");
                                    return;
                                }
                            }
                        }
                        if (flagVacation == false) {
                            initMap();
                            return;
                        }
                    }

                });

            }




            function WorkersStatusPre() {
                WorkersStatus();
            }

            function WorkersStatus() {
                TimeEventsManger();
                $.mobile.changePage('#WorkersStatus',{ 'transition': 'none' });;
                $.mobile.changePage('#WorkersStatus',{ 'transition': 'none' });;
            }

            function WorkersDepartments() {
                TimeEventsManger();
                $.mobile.changePage('#WorkersDepartments', { 'transition': 'slide' });;
                $.mobile.changePage('#WorkersDepartments', { 'transition': 'slide' });;
                GetWorkersDepartments();
            }

            ///שולף מיקום
            function getLocation2() {
                $("#DistenceOrNOT").html("בודק מיקום....");
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(showPosition2);
                } else {
                    //$("#DistenceOrNOT").html("שגיאה בווידאוי מיקום");
                    return;
                }

            }


            function showPosition2(position) {
                x = position.coords.latitude;
                y = position.coords.longitude
                //  $("#Times3").html(y);
                CheckifVacationDay();

            }




            //////////////משתנים גלובלאיים
            var daysinmonth = 0;
            var GlobalName = "";
            var GlobalDepartment = "";
            var ID;
            var location;
            var GlobalStartHour = "";
            var Month;
            var MonthManger;
            var tempPresenceID = 0;
            var Department = ' ';
            var flagexit = 0;
            var names = {};
            var Daysarray = {};
            var namescounter = 0;
            var daysinmonth = 0;
            var flagclicked = false;
            var Daysarray = {};
            var Firstdatearray = {};
            var Firstdatearraycounter = 0;
            var flag = false;
            var Firstdate = false;
            var Latitude;
            var Longitude;
            var Locationss;
            var GlobalStartHour;
            var MangerOfficalID = 0;
            var OriginalID = 0;
            var tempDepartment = "";
            var VacationDetails;
            var Workername;
            var Workerselect;
            var WorkerID;
            var WorkerGlogalID = 0;
            var Time;

            $(document).on("pageinit", "#firstpage", function (event) {
                EventsFirstPage();
            });


            /////////////////////////////////////////////////////////////////////////פונקציות לדפי עובדים/////////////
            //עובר לדף הראשי
            function EventsFirstPage() {
                $("#loginBTN").on("tap", function () {
                    var WorkerMail = $('#fpInputNameId').val();
                    var PassWord = $('#fpInputName3').val();
                    var WorkerName = "";
                    var mail = ' ';
                    var pass;
                    if (WorkerMail == '' && PassWord == '') {
                        $('#LoginError').html("נא מלא פרטים");
                        return;
                    }


                    $('#LoginError').html("מנסה להתחבר");
                             var WebServiceURL = "Enterence.asmx";

                    $.ajax({

                        url: WebServiceURL + "/GetWorkers",
                        dataType: "json",
                        type: "POST",   //use only POST!
                        // data: "{'num':'" + num + "' }",

                        data: "{'WorkerName':'" + WorkerName + "','PassWord':'" + PassWord + "'}",

                        contentType: "application/json; charset=utf-8",
                        error: function (jqXHR, exception) {
                            alert("error");
                        },

                        success: function (data) {
                            WorkersObj = JSON.parse(data.d); //or data["d"]
                            for (var i = 0; i < WorkersObj.length; i++) {

                                pass = WorkersObj[i].PassWord;
                                mail = WorkersObj[i].WorkerMail;
                                ID = WorkersObj[i].ID;
                                WorkerGlogalID = WorkersObj[i].ID;
                                Department = WorkersObj[i].WorkerDepartment;
                                //WorkersObj[i].Active == true

                                if (WorkersObj[i].PassWord == PassWord && WorkersObj[i].WorkerMail == WorkerMail && WorkersObj[i].Active == true) {
                                    GlobalName = WorkersObj[i].WorkerName;
                                    //   $.mobile.changePage('#IndexPage',{ 'transition': 'none' });;
                                    //myFunction();
                                    TimeEvents();
                                    $.mobile.changePage('#IndexPage',{ 'transition': 'none' });;
                                    $("#DistenceOrNOT").html(" ");
                                    //GetDestination();
                                    //myFunction4();
                                    //getLocation2();
                                    return;
                                }

                            }
                            wireEventsFirstPageManger();
                            checkCookie();
                        }

                    });
                });


            }


            function setCookie(cmai,cpass, cvalue,cvalue2, exdays) {
                var d = new Date();
                d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
                var expires = "expires=" + d.toGMTString();
                document.cookie = cmai + "=" + cvalue + "; " + expires;
                document.cookie = cpass + "=" + cvalue2 + "; " + expires;
            }

            function getCookie(cname) {
                var name = cname + "=";
                var ca = document.cookie.split(';');
                for (var i = 0; i < ca.length; i++) {
                    var c = ca[i];
                    while (c.charAt(0) == ' ') c = c.substring(1);
                    if (c.indexOf(name) == 0) {
                        return c.substring(name.length, c.length);
                    }
                }
                return "";
            }

            function checkCookie() {
                var mail = getCookie($('#fpInputNameId').val());
                var pass = getCookie($('#fpInputName3').val());
                if (mail != "" || pass!="") {
                    $('#fpInputNameId').html(mail);
                    $('#fpInputName3').html(pass);
                } else {
                    if (mail != "" && mail != null && pass != "" && pass != null) {
                        setCookie($('#fpInputNameId').val(), $('#fpInputName3').val(), mail, pass, 365);
                    }
                }
            }


            //מנהלים:
            //יצירת טבלת מנהלים
            function GetManagers() {
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetManagers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {

                    },

                    success: function (data) {
                        MangerObj = JSON.parse(data.d); //or data["d"]
                        var str = "";
                        str += "<option value=" + 0 + ">" + "בחר מנהל</option>";
                        for (var i = 0; i < MangerObj.length; i++) {
                            str += "<option value=" + MangerObj[i].ID + ">" + MangerObj[i].MangerName + "</option>"
                        }
                        $("#MangerSelect").empty();
                        $("#MangerSelect").html(str);
                    }
                });
            }


            //מראה נתונים של מנהל
            function ShowManagers() {
                var MangerID = $("#MangerSelect").val();
                //var MangerID = $("#MangerSelect").val();

                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetManagers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {

                    },

                    success: function (data) {
                        MangerObj = JSON.parse(data.d); //or data["d"]
                        var i = 0;
                        var str = "";
                        for (var i = 0; i < MangerObj.length; i++) {

                            if (MangerObj[i].Active == null)
                            {
                                MangerObj[i].Active = "";
                            }

                            if (MangerObj[i].MangerLocation == null) {
                                MangerObj[i].Active = "";
                            }

                            if (MangerObj[i].Active == true) {
                                MangerObj[i].Active = "פעיל";
                            }

                            if (MangerObj[i].Active == false) {
                                MangerObj[i].Active = "לא פעיל";
                            }
                        }
                        for (i = 0; i < MangerObj.length; i++) {
                            if (MangerID == MangerObj[i].ID)
                                //<a href="mailto:test@theearth.com?subject=Circle Around&body=Some blah" name="emailLink">Email</a>

                                str += "שם:" + MangerObj[i].MangerName + "<br> <br>" + "<a href=" + "mailto:" + MangerObj[i].MangerMail + "?subject=Circle Around&body=Some blah" + "target=_top>" + "" + " שלח מייל</a>" + "" + "<br> <br>" + "מספר טלפון: <a href=" + "tel:" + "0" + MangerObj[i].MangerPhone + ">" + "0" + MangerObj[i].MangerPhone + "</a> <br> <br>" + "מיקום:" + MangerObj[i].MangerLocation + "<br> <br>" + "כתובת:" + MangerObj[i].MangerAddress + " <br> <br>" + "האם פעיל?:" + MangerObj[i].Active + " <br> <br>";

                        }

                        CleanManagers();
                        $("#ShowManagers").append(str).collapsibleset('refresh');
                    }
                });
            }


            function CleanManagers() {
                $("#ShowManagers").empty();
            }




            //שולף זמן ותאריך מהדטה בייס
            function TimeEvents() {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetTimeAndDate",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'Time':'" + Time + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {

                    },
                    success: function (data) {

                        var str = "";
                        Time = data.d;
                        str = Time[0];
                        $("#Times1").html(str);
                        $("#VacationsReportTimes1").html(str);
                        $("#VacationsTimes1").html(str);
                        $("#VacationUpdatesTimes1").html(str);
                        $("#VacationUpdatessTimes1").html(str);
                        $("#WorkersInfoTimes1").html(str);
                        $("#ConnectMangerTimes1").html(str);
                        GlobalDate = str;
                        var MonthTime;
                        MonthTime = str[3] + str[4];
                        str = Time[1]
                        $("#Times2").html(str);
                        $("#VacationsReportTimes2").html(str);
                        $("#VacationsTimes2").html(str);
                        $("#VacationUpdatesTimes2").html(str);
                        $("#VacationUpdatessTimes2").html(str);
                        $("#WorkersInfoTimes2").html(str);
                        $("#ConnectMangerTimes2").html(str);
                        GlobalTime = str;
                        //IDEvents();
                    }


                });
            }




            //פונקציות לעדכון כניסה ושליפת תאריך כניסה

            //פונקציות לעדכון כניסה ושליפת תאריך כניסה
            function IDEvents() {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetWorksDate",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var WorksDateID = 1;
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (WorksDateID == WorkersObj[i].WorksDateID)
                                WorksDateID++;
                        }

                        EnterStartHour(WorksDateID);
                    }

                });
            }


            function EnterStartHour(WorksDateID) {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/EnterDate",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "','WorksDateID':'" + WorksDateID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        IDEvents2();
                        myFunction3();
                        flag = false;
                    }

                });
            }

            function IDEvents2() {
                         var WebServiceURL = "Enterence.asmx";


                $.ajax({

                    url: WebServiceURL + "/GetWorksDate",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        flag = false;
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (ID == WorkersObj[i].ID && WorkersObj[i].EndHour == null) {
                                EnterDate1 = WorkersObj[i].EnterDate;
                                GlobalStartHour = WorkersObj[i].StartHour;
                                flag = true;
                                if (WorkersObj[i].EndHour == null) {
                                    document.getElementById("myBtn").disabled = true;
                                    document.getElementById("myBtn2").disabled = false;
                                }
                                break;
                            }
                        }
                        $("#StarWorking").empty();
                        if (flag == true) {
                            var str = "שעת התחלה עבודה:" + GlobalStartHour;
                            $("#StarWorking").html(str);
                        }
                        flag = false;
                        return;
                    }
                });
            }



            function ReportEvents2() {
                var yeartemp = "";
                var d = new Date();
                var n = d.getFullYear();
                $("#VacationsReportStatus").html(" ");
                Month = $("#Moneths2").val();
                yeartemp = $("#Yearstring").val();
                if (yeartemp < n || yeartemp == "") {
                $("#VacationsReportStatus").html("שגיאה,נא להכניס שנה תקינה");

                    return;
                }

                var MonthTemp = 0;
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/GetDaysInMonth",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'year':'" + yeartemp + "','month':'" + Month + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        $("#VacationsReportStatus").html("שגיאה,נא להכניס שנה תקינה");
                    },
                    success: function (data) {
                        var str = "";
                        str = data.d;
                        Daysarray = str;
                        daysinmonth = str[0];
                        return;
                    }

                });
            }


            ///יציאה מהאפליקצייה
            function Exit() {
                location.reload();
                $.mobile.changePage('#firstpage',{ 'transition': 'none' });;
                $('#LoginError').html("");
            }

            function ExitApp() {
                navigator.app.exitApp();
            }

            function MainPage() {
                $.mobile.changePage('#IndexPage',{ 'transition': 'none' });;
                TimeEvents();
            }



            //פונקציית עדכון
            function UpdateEvents() {
                var ENDdate = EnterDate1;
                var now = new Date(Date.now());
                var hours = now.getHours();
                var minutes = now.getMinutes();
                var seconds = now.getSeconds();

                if (minutes < 10) { minutes = "0" + minutes; }
                if (seconds < 10) { seconds = "0" + seconds; }
                if (hours < 10) { hours = "0" + hours; }

                var formatted = hours + ":" + minutes + ":" + seconds;
                         var WebServiceURL = "Enterence.asmx";
                var DatetoCompare;
                //שעת התחלה סכימה
                $.ajax({
                    url: WebServiceURL + "/UpdateDate",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "','EnterDate1':'" + EnterDate1 + "','StartHour':'" + GlobalStartHour + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        $("#EndWorking").html("סיום עבודה עודכן בהצלחה בשעה: " + formatted);
                        document.getElementById("myBtn").disabled = false;
                        document.getElementById("myBtn2").disabled = true;
                        ENDdate += '-';
                        ENDdate += formatted;

                        EnterDate1 += '-';
                        EnterDate1 += GlobalStartHour;
                        //$.mobile.changePage('#firstpage',{ 'transition': 'none' });;

                    }

                });
            }

            //מוודא מיקום
            function GetDistance() {
                var WebServiceURL = "Enterence.asmx";;
                $.ajax({

                    url: WebServiceURL + "/GetManagers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        MangerDateObj = JSON.parse(data.d); //or data["d"]
                        //  $.mobile.changePage('#IndexPage',{ 'transition': 'none' });;
                        myFunction2();


                    }

                });
            }

            //מקבל מיקום
            function getLocation() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(showPosition, showError);
                } else {
                    x.innerHTML = "Geolocation is not supported by this browser.";
                }
            }

            function showPosition(position) {
                var latlon = position.coords.latitude + "," + position.coords.longitude;


                var img_url = "http://maps.googleapis.com/maps/api/staticmap?center="
                + latlon + "&zoom=14&size=400x300&sensor=false";


            }

            //חוזר לדף הראשי
            function BackToman() {
                window.history.back();
            }


            ////////************************************************************פונקציית חופשות
            function VacationsPage() {
                flag = false;
                Vacations();

            }
            function Vacations() {
                if (flag != "Update") {
                    $.mobile.changePage('#Vacations',{ 'transition': 'none' });;
                    $.mobile.changePage('#Vacations',{ 'transition': 'none' });;
                    $("#VacationUpdatesSelect").empty();
                    $("#VacationsKind").empty();
                    $("#Vacations2Yearss").empty();
                    $("#Vacations2Yearsends").empty();
                    $("#VacationsSTatus").empty();
                    $("#Vacations2Years").empty();
                    $("#Vacations2Yearsend").empty();
                }
                GetWorkerVacations();


            }


            function GetWorkerVacations() {
                var WebServiceURL = "Enterence.asmx";
                document.getElementById("VecationStart").disabled = true;
                $.ajax({
                    url: WebServiceURL + "/GetWorkerVacations",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                    },

                    success: function (data) {

                        var str = "";
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        //$("#VacationStaus").text(" ");
                        if (flag == "Update" || flag == "Update2" || flag == "Delete" || flag == "Delete2") {
                            str += "<option value=" + 0 + ">בחירת חופשה<br>";
                            for (var i = 0; i < WorkersObj.length; i++) {
                                if ($("#VacationUpdatesSelect").val() == WorkersObj[i].Stat_Date && flag == "Update2" && WorkersObj[i].ID == ID && WorkersObj[i].Confirmed_By_Worker != true) {
                                    if (WorkersObj[i].Vacation_Days != 0) {
                                        $("#VacationsKind").val("חופשה כללית");
                                    }

                                    if (WorkersObj[i].Sick_Days != 0) {
                                        $("#VacationsKind").val("חופשת מחלה");
                                    }

                                    $("#Vacations2Yearss").val(WorkersObj[i].Stat_Date);
                                    $("#Vacations2Yearsends").val(WorkersObj[i].End_Date);

                                    if (WorkersObj[i].Active == null) {
                                        $('#VacationsSTatus').val("ממתין לאישור");
                                    }

                                    if (WorkersObj[i].Active == false) {
                                        $('#VacationsSTatus').val("בקשה נדחתה,ערוך או הגש בקשה חדשה");
                                    }

                                    if (WorkersObj[i].Active == true) {
                                        document.getElementById("VecationStart").disabled = false;
                                        $('#VacationsSTatus').val("בקשה אושרה,לחץ כדיי לאשרר בקשה");
                                    }
                                    $('#OriginalStat_Date').val(WorkersObj[i].Stat_Date);
                                    break;

                                }
                                if (WorkersObj[i].ID == ID && WorkersObj[i].Confirmed_By_Worker != true) {
                                    str += "<option value=" + WorkersObj[i].Stat_Date + ">בקשת חופשה לתאריכים: " + WorkersObj[i].Stat_Date + " עד : " + WorkersObj[i].End_Date + "<br></option>"
                                }
                            }


                            if (flag == "Update") {
                                flag = "Update2";
                                $("#VacationUpdatesSelect").append(str).collapsibleset('refresh');
                            }
                            if (flag == "Delete") {

                                flag = "Delete2";
                                $("#VacationDeleteSelect").append(str).collapsibleset('refresh');
                            }
                        }
                    }
                });
            }



            //ד"וח חופשות
            function VacationsReport() {
                $.mobile.changePage('#VacationsReport',{ 'transition': 'none' });;
                $.mobile.changePage('#VacationsReport',{ 'transition': 'none' });;
                ReportCleaning();
                $("#Yearstring").val("");
                $("#VacationsReportStatus").html("");

            }


            function VacationsUpdates() {
                $.mobile.changePage('#VacationUpdates',{ 'transition': 'none' });;
                VacationUpdatesClean();

            }

            //עמוד עדכון בקשת חופשות
            function VacationsUpdatess() {
                $.mobile.changePage('#VacationUpdatess',{ 'transition': 'none' });;
                VacationUpdatessClean();
                $("#VacationUpdatesSelect").empty();
                flag = "Update";
                $("#VacationsKind").empty();
                $("#Vacations2Yearss").empty();
                $("#Vacations2Yearsends").empty();
                $("#VacationsSTatus").empty();
                Vacations();

            }

            function VacationUpdatesClean() {
                $("#Vacations2Years").val("");
                $("#Vacations2Yearsend").val("");
                $("#VacationLegalornot").html(" ");
            }


            //עמוד מחיקת בקשת חופשות
            function VacationDeleteSelect() {
                $.mobile.changePage('#DeleteVacation',{ 'transition': 'none' });;
                $.mobile.changePage('#DeleteVacation',{ 'transition': 'none' });;
                flag = "Delete";
                $("#VacationDeleteSelect").empty();
                Vacations();
            }

            //ד"וח חופשות
            function UpdatePresence() {
                //var tempPresenceID = 0;
                var i = 0;

                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetPresence",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObjs = JSON.parse(data.d); //or data["d"]
                        debugger;
                        flag = false;
                    }

                });
                var StarDate = $("#Vacations2Years").val();
                var Endate = $("#Vacations2Yearsend").val();

                var d1;

                d1 = StarDate[8];
                d1 += StarDate[9];
                d1 += '-';
                d1 += StarDate[5];
                d1 += StarDate[6];
                d1 += '-';
                d1 += StarDate[0];
                d1 += StarDate[1];
                d1 += StarDate[2];
                d1 += StarDate[3];
                StarDate = d1;
                OriginalStarDate = StarDate;

                d1 = Endate[8];
                d1 += Endate[9];
                d1 += '-';
                d1 += Endate[5];
                d1 += Endate[6];
                d1 += '-';
                d1 += Endate[0];
                d1 += Endate[1];
                d1 += Endate[2];
                d1 += Endate[3];
                Endate = d1;
                OriginalEndate = Endate;
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetPresenceHistory",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (i = 0; i < WorkersObjs.length; i++) {
                            if (StarDate == WorkersObjs[i].Stat_Date && Endate == WorkersObjs[i].End_Date && ID == WorkersObjs[i].ID) {
                                $('#VacationLegalornot').html("נתוני בקשת חופשה כבר קיימים או שגיאה בפרטים");
                                return;
                            }
                        }

                        for (i = 0; i < WorkersObj.length; i++) {

                            if (StarDate == WorkersObj[i].Stat_Date && Endate == WorkersObj[i].End_Date && ID == WorkersObj[i].ID) {
                                $('#VacationLegalornot').html("נתוני בקשת חופשה כבר קיימים או שגיאה בפרטים");
                                return;
                            }
                        }
                        debugger;
                        flag = false
                        InsertPresence(OriginalStarDate, OriginalEndate);

                    }

                });
            }




            function InsertPresence(OriginalStarDate, OriginalEndate) {

                if (flag != "בקשה שמנהל התחייס") {
                    var StarDate = $("#Vacations2Years").val();
                    var Endate = $("#Vacations2Yearsend").val();
                }

                if (flag == "בקשה שמנהל התחייס") {
                    Status = $('#VacationsSTatus').val();
                    var StarDate = $("#Vacations2Yearss").val();
                    var Endate = $("#Vacations2Yearsends").val();
                    OriginalStarDate = StarDate;
                    OriginalEndate = Endate;
                    flag = false;;
                }

                var d1;
                var d2;
                var tempyear = ($.datepicker.formatDate('yy/mm/dd', new Date()));



                d1 = StarDate[0];
                d1 += StarDate[1];
                d1 += StarDate[2];
                d1 += StarDate[3];
                d1 += '-';
                d1 += StarDate[5];
                d1 += StarDate[6];
                d1 += '-';
                d1 += StarDate[8];
                d1 += StarDate[9];
                StarDate = d1;

                d2 = Endate[0];
                d2 += Endate[1];
                d2 += Endate[2];
                d2 += Endate[3];
                d2 += '-';
                d2 += Endate[5];
                d2 += Endate[6];
                d2 += '-';
                d2 += Endate[8];
                d2 += Endate[9];
                Endate = d2;




                var PresenceID = 1;
                d1 = Date.parse(StarDate);
                d2 = Date.parse(Endate);
                var d3 = Date.parse(tempyear);
                if (d1 > d2 || d1 < d3) {
                    $('#VacationLegalornot').html("נתוני בקשת חופשה שגויים");
                    return;
                }

                var Flag = $("#Reasons").val();

                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/InsertPresence",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "','Stat_Date':'" + StarDate + "','End_Date':'" + Endate + "','Active':'" + false + "','Reasons':'" + Flag + "','PresenceID':'" + PresenceID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        $('#VacationLegalornot').html(" נתוני בקשת חופשה כבר קיימים או שגיאה בתאריכי החופשה");
                    },
                    success: function (data) {
                        debugger;
                        flag = false;


                        Vacations();
                    }

                });
            }


            //מעדכן את החופשה
            function UpdatePresences() {
                var OriginalStat_Date = $('#OriginalStat_Date').val();
                var Status = $('#VacationsSTatus').val();
                var StarDate = $("#Vacations2Yearss").val();
                var OriginalStarDate = StarDate;
                var Endate = $("#Vacations2Yearsends").val();
                var OriginalEndate = Endate;
                var tempyear = ($.datepicker.formatDate('yy/mm/dd', new Date()));
                var d1;
                var d2;
                var d4;

                if (StarDate[0] != 2 || Endate[0] != 2)
                {
                    $('#VacationLegalornot2').html("נא מלא פרטי חופשה בשתי השדות");
                    return;
                }

                var d3 = Date.parse(tempyear);
                d1 = Date.parse(StarDate);
                d2 = Date.parse(Endate);


                var PresenceID = 1;

                if (d1 > d2 || d1 < d3) {
                    $('#VacationLegalornot2').html("נתוני בקשת חופשה שגויים");
                    return;
                }


                var tempdate1
                var tempdate2


                var Flag = $("#Reasonss").val();
                var PresenceID = $("#VacationUpdatesSelect").val();
                         var WebServiceURL = "Enterence.asmx";
                if (Status == "ממתין לאישור") {

                    $.ajax({

                        url: WebServiceURL + "/UpdatePresence",
                        dataType: "json",
                        type: "POST",   //use only POST!
                        data: "{'ID':'" + ID + "','OriginalStat_Date':'" + OriginalStat_Date + "','Stat_Date':'" + StarDate + "','End_Date':'" + Endate + "','Active':'" + false + "','Reasons':'" + Flag + "'}",

                        contentType: "application/json; charset=utf-8",
                        error: function (jqXHR, exception) {
                            $('#VacationLegalornot2').html("נתוני בקשת חופשה שגויים");
                            debugger;
                            debugger;
                        },
                        success: function (data) {
                            debugger;
                            Vacations();
                            return;
                        }

                    });
                }
                if (Status != "ממתין לאישור") {
                    flag = "בקשה שמנהל התחייס";
                    $.ajax({
                        url: WebServiceURL + "/DeleteVacations",
                        dataType: "json",
                        type: "POST",   //use only POST!
                        data: "{'ID':'" + ID + "','Stat_Date':'" + OriginalStat_Date + "'}",

                        contentType: "application/json; charset=utf-8",
                        error: function (jqXHR, exception) {
                            $('#VacationLegalornot2').html("נתוני בקשת חופשה שגויים");
                            debugger;
                        },
                        success: function (data) {
                            InsertPresence(OriginalStarDate, OriginalEndate);
                            debugger;
                        }

                    });
                }
            }


            //var Status = $('#VacationsSTatus').val();
            //var StarDate = $("#Vacations2Yearss").val();
            //var Endate = $("#Vacations2Yearsends").val();
            //var d1 = Date.parse(StarDate);
            //var d2 = Date.parse(Endate);





            function VacationsConfrimed() {
                if ($("#VacationsSTatus").val() != "בקשה אושרה,לחץ כדיי לאשרר בקשה") {
                    $('#VacationLegalornot2').html("לא ניתן לאשרר חופשה לפני אישור מנהל");
                    return;
                }
                var status = true;
                var Stat_Date = $("#Vacations2Yearss").val();
                var d1;


                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/ConfrimPresence",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "','Stat_Date':'" + Stat_Date + "','Confrimed':'" + status + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        $('#VacationLegalornot2').html("שגיאה");
                        debugger;
                    },
                    success: function (data) {
                        Vacations();
                        debugger;

                    }

                });
            }

            //שולף את פרטי החופשה של עובד ספציפי
            function VacationsReportEvents() {
                $("#WorkersSelect4").empty();
                var MonthString = $("#Moneths2").val();
                var flagfound = false;
                if (MonthString == "00") {
                    return;
                }
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/GetPresenceHistory",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {

                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var content = "לא נמצאו חופשות";
                        var flaging = false;
                        var Yearstring = $("#Yearstring").val();

                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (WorkersObj[i].ID == ID && MonthString[0] == WorkersObj[i].Stat_Date[5] && MonthString[1] == WorkersObj[i].Stat_Date[6] && Yearstring[0] == WorkersObj[i].Stat_Date[0] && Yearstring[1] == WorkersObj[i].Stat_Date[1] && Yearstring[2] == WorkersObj[i].Stat_Date[2] && Yearstring[3] == WorkersObj[i].Stat_Date[3]) {

                                if (flagfound == false)
                                {
                                    flagfound = true;
                                    content = "";
                                }
                                if (flaging == false) {
                                    flaging = true;
                                    content += "<div data-role=main class=ui-content> <div data-role=collapsible><h1>" + "הצג פרטי חופשה לאותה שנה" + "</h1>";
                                }


                                if (WorkersObj[i].Permitted == true) {
                                    WorkersObj[i].Permitted = "כן";
                                }
                                if (WorkersObj[i].Confirmed_By_Worker == true) {
                                    WorkersObj[i].Confirmed_By_Worker = "כן";
                                }

                                if (WorkersObj[i].Permitted == null || WorkersObj[i].Permitted == false) {
                                    WorkersObj[i].Permitted = "לא";
                                }

                                if (WorkersObj[i].Confirmed_By_Worker == null || WorkersObj[i].Confirmed_By_Worker == false) {
                                    WorkersObj[i].Confirmed_By_Worker = "לא";
                                }

                                if (WorkersObj[i].Vacation_Days == null) {
                                    WorkersObj[i].Vacation_Days = 0;
                                }






                                content += "<p></p><div data-role=collapsible><h1>פרטי חופשה לתאריכים:" + WorkersObj[i].Stat_Date + "-" + WorkersObj[i].End_Date + "<br>" + "<br>" + " </h1><p>" + "<br>" + "ימי חופשה: " + WorkersObj[i].Vacation_Days + "<br>" + "<br>" + "ימי מחלה: " + WorkersObj[i].Sick_Days + "<br>" + "<br>" + "מספר ימים כולל: " + WorkersObj[i].Total_Days + "<br>" + "<br>" + "מספר שעות: " + WorkersObj[i].Total_Hours + "<br>" + "<br>" + "אושר על ידי מנהל: " + WorkersObj[i].Permitted + "<br>" + "<br>" + "סיבה: " + WorkersObj[i].Reason + "<br>" + "<br>" + "אושרר על ידי עובד: " + WorkersObj[i].Confirmed_By_Worker + "<br>" + "<br>" + "</p></div>";
                            }
                        }

                        content += "</div></div>";

                        $("#WorkersSelect4").append(content).collapsibleset('refresh');


                        $.mobile.changePage('#VacationsReport',{ 'transition': 'none' });;
                    }

                });
            }
            //מעדכן סיום חופשה
            function VecationsEnding() {
                var StarDate = "";
                var EndDate = "";
                var SickDays = 0;
                var DaysOff = 0;
                var Vacation_Days = 0;
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/GetWorkerVacations",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {

                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (WorkersObj[i].ID == ID) {
                                flag = WorkersObj[i].Active;
                                StarDate = WorkersObj[i].Stat_Date;
                                EndDate = WorkersObj[i].End_Date;
                                SickDays = WorkersObj[i].Sick_Days;
                                if (SickDays == 0) {
                                    Vacation_Days = WorkersObj[i].Vacation_Days;
                                }

                            }
                            break;
                        }

                        if (flag == true) {
                            flag = "Ending";

                            VecationsEndingUpdate(StarDate, EndDate, SickDays, Vacation_Days);
                        }
                    }

                });
            }




            //מעדכן את החופשה
            function VecationsEndingUpdate(StarDate, EndDate, SickDays, Vacation_Days) {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/UpdatePresenceHistory",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "','StarDate':'" + StarDate + "','EndDate':'" + EndDate + "','SickDays':'" + SickDays + "','Vacation_Days':'" + Vacation_Days + "'}",

                    //,'StarDate':'" + StarDate + "','Endate':'" + Endate + "','SickDays':'" + SickDays + "','Vacation_Days':'" + Vacation_Days + "'
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {

                        //DeleteVacations();
                    }

                });
            }

            ///מוחק את הבקשה
            function DeleteVacations() {

                var OriginalStat_Date = $('#OriginalStat_Date').val();
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/DeleteVacations",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "','Stat_Date':'" + OriginalStat_Date + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        if (flag != "NormalVacation" && flag != "Sick") {
                            Vacations();
                        }
                    }

                });
            }

            function ChangeVacationsKind() {
                var VacationsKind = $("#Reasonss").val();
                if (VacationsKind == "Sick") {
                    VacationsKind = "חופשת מחלה";
                }
                if (VacationsKind == "NormalVacation") {
                    VacationsKind = "חופשה כללית";
                }
                $("#VacationsKind").val(VacationsKind);
            }

            //טבלת חופשות שנתית
            function VacationsReportEventsTable() {
                if (Month == "00") {
                    $("#WorkersSelect4").empty();
                    return;
                }

                var MonthsArry = {};
                MonthsArry[1] = "ינואר";
                MonthsArry[2] = "פבואר";
                MonthsArry[3] = "מרץ";
                MonthsArry[4] = "אפריל";
                MonthsArry[5] = "מאי";
                MonthsArry[6] = "יוני";
                MonthsArry[7] = "יולי";
                MonthsArry[8] = "אוגוסט";
                MonthsArry[9] = "ספטמבר";
                MonthsArry[10] = "אוקטובר";
                MonthsArry[11] = "נובמבר";
                MonthsArry[12] = "דצמבר";

                $("#WorkersSelect4").empty();
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/GetPresenceHistory",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function () {
                        debugger;
                    },
                    success: function (data) {
                        VacationsArray = JSON.parse(data.d); //or data["d"]
                    }
                });


                $.ajax({
                    url: WebServiceURL + "/GetWorksDate",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function () {
                        debugger;
                    },
                    success: function (data) {
                        WorksDateArray = JSON.parse(data.d); //or data["d"]

                        var flagsum = false;
                        if (flag == "sumReport") {
                            flagsum = true;
                        }
                        if (flag == "sumDaily") {
                            flagsum = "sumDaily";
                        }

                        flag = false;
                        var counter = 0;
                        var flagDateID = false;
                        var flagfound = false;
                        var tableid = 1;
                        var WorkerName = "";
                        var tableid2 = "";
                        var tempyears = $("#Yearstring");
                        var tempyears2 = 0;
                        var tempyears3 = 0;
                        var str = "";
                        var str2 = "";
                        var str3 = "";
                        var sum = 0;
                        var k = 0;
                        var d = 1;
                        var j = 0;
                        var tempday = 0;
                        var tempdayE = 0;
                        var sumdays = 0;
                        var sumlatedays = 0;
                        var flaglate = false;
                        var MonthTemp = 0;
                        var MonthTempE = 0;
                        var tempdates = 0;
                        var tempdatee = 0;
                        var tempdatee2 = 0;
                        var VacationDays = 0;
                        var hours = minutes = seconds = 0;
                        var sumdailyhours = 0;

                        for (j = 0; j < namescounter; j = j + 10) {
                            if (ID == names[j]) {
                                WorkerName = names[j + 1];
                                break;
                            }
                        }


                        if (Month > 00) {

                            str += "<table id=" + tableid + "<tr>";
                            for (var i = 0; i < daysinmonth; i++) {
                                if (counter == 7) {
                                    str += "</tr> <tr>";
                                    counter = 0;
                                }
                                for (j = 0; j < WorksDateArray.length; j++) {
                                    if (flagDateID == true) {
                                        break;
                                    }
                                    if (ID == WorksDateArray[j].ID) {
                                        MonthTemp = (WorksDateArray[j].EnterDate[3] + WorksDateArray[j].EnterDate[4]);
                                        tempday = (WorksDateArray[j].EnterDate[0] + WorksDateArray[j].EnterDate[1]);
                                        tempyears2 = (WorksDateArray[j].EnterDate[6] + WorksDateArray[j].EnterDate[7] + WorksDateArray[j].EnterDate[8] + WorksDateArray[j].EnterDate[9]);
                                        if (tempday == tableid && Month == MonthTemp && tempyears.val() == tempyears2) {
                                            if (WorksDateArray[j].Arrived_Late == true && flaglate==false)
                                            {
                                                flaglate = true;
                                                sumlatedays++;
                                            }
                                            if (WorksDateArray[j].EndHour == null) {
                                                WorksDateArray[j].EndHour = "";
                                            }


                                            hours = minutes = seconds = 0;
                                            sumdailyhours = WorksDateArray[j].Total_Hours * 3600;

                                            while (sumdailyhours >= 3600) {
                                                hours++;
                                                sumdailyhours -= 3600;
                                            }

                                            while (sumdailyhours >= 60) {
                                                minutes++;
                                                sumdailyhours -= 60;
                                            }
                                            seconds = parseInt(sumdailyhours);

                                            if (hours < 10) { hours = "0" + hours; }
                                            if (minutes < 10) { minutes = "0" + minutes; }
                                            if (seconds < 10) { seconds = "0" + seconds; }

                                            sumdailyhours = hours + ":" + minutes + ":" + seconds;


                                            sum = sum + WorksDateArray[j].Total_Hours;
                                            sumdays = sumdays + 1;
                                            if (flagfound == false) {
                                                flagfound = true;
                                                str += "<td> " + tableid + "<br>";
                                            }

                                            if (WorksDateArray[j].Arrived_Late == true)
                                            {
                                                WorksDateArray[j].Arrived_Late = "כן";
                                            }

                                            if (WorksDateArray[j].Arrived_Late == null || WorksDateArray[j].Arrived_Late == false) {
                                                WorksDateArray[j].Arrived_Late = "לא";
                                            }

                                            str += "" + "" + "תאריך:  <br> " + WorksDateArray[j].EnterDate + "<br>" + Daysarray[d] + "" + "<br>" + "שעת התחלה: " + WorksDateArray[j].StartHour + "" + "<br><br><br><br>" + "שעת סיום: " + WorksDateArray[j].EndHour + "" + "<br><br><br>";
                                            str2 += "<div data-role=" + "collapsible" + "><h3>סיכום עבודה לתאריך:" + WorksDateArray[j].EnterDate + "</h3><br><br> <p>עובד:" + WorkerName + "</p><br><br> שעת התחלה: " + WorksDateArray[j].StartHour + "<br><br>" + "שעת סיום: " + WorksDateArray[j].EndHour + "<br><br> האם איחר?: " + WorksDateArray[j].Arrived_Late + "<br><br>" + "מספר שעות: " + sumdailyhours + "<br><br></p><br><br></div><br><br>";
                                            WorksDateArray[j].ID = -1;
                                            flag = true;
                                            //break;

                                        }
                                    }
                                }
                                flagfound = false;
                                for (j = 0; j < VacationsArray.length; j++) {
                                    if (flagDateID == true) {
                                        break;
                                    }
                                    MonthTempE =  (VacationsArray[j].End_Date[5] + VacationsArray[j].End_Date[6]);
                                    tempdayE = (VacationsArray[j].End_Date[8] + VacationsArray[j].End_Date[9]);
                                    tempyears3 = (VacationsArray[j].End_Date[0] + VacationsArray[j].End_Date[1] + VacationsArray[j].End_Date[2] + VacationsArray[j].End_Date[3]);

                                    MonthTemp = (VacationsArray[j].Stat_Date[5] + VacationsArray[j].Stat_Date[6]);
                                    tempday = (VacationsArray[j].Stat_Date[8] + VacationsArray[j].Stat_Date[9]);
                                    tempyears2 = (VacationsArray[j].Stat_Date[0] + VacationsArray[j].Stat_Date[1] + VacationsArray[j].Stat_Date[2] + VacationsArray[j].Stat_Date[3]);
                                    tempdates = (VacationsArray[j].Stat_Date[8] + VacationsArray[j].Stat_Date[9] + VacationsArray[j].Stat_Date[5] + VacationsArray[j].Stat_Date[6] + VacationsArray[j].Stat_Date[0] + VacationsArray[j].Stat_Date[1] + VacationsArray[j].Stat_Date[2] + VacationsArray[j].Stat_Date[3]);
                                    tempdatee = (VacationsArray[j].End_Date[8] + VacationsArray[j].End_Date[9] + VacationsArray[j].End_Date[5] + VacationsArray[j].End_Date[6] + VacationsArray[j].End_Date[0] + VacationsArray[j].End_Date[1] + VacationsArray[j].End_Date[2] + VacationsArray[j].End_Date[3]);
                                    if (ID == VacationsArray[j].ID && Month == MonthTempE && MonthTemp < MonthTempE && VacationsArray[j].Permitted == true) {
                                        tempdates = "0";
                                        tempdates += (1 + VacationsArray[j].End_Date[5] + VacationsArray[j].End_Date[6] + VacationsArray[j].End_Date[0] + VacationsArray[j].End_Date[1] + VacationsArray[j].End_Date[2] + VacationsArray[j].End_Date[3]);
                                    }


                                    if ((ID == VacationsArray[j].ID && Month == MonthTemp && tempyears.val() == tempyears2 && tempday == tableid && VacationsArray[j].Permitted == true && VacationsArray[j].Confirmed_By_Worker==true) || (ID == VacationsArray[j].ID && Month == MonthTempE && tempyears.val() == tempyears3 && tempdayE > tableid && MonthTempE != MonthTemp && VacationsArray[j].Permitted == true && VacationsArray[j].Confirmed_By_Worker==true)) {
                                        if (MonthTemp != MonthTempE) {
                                            tempdatee2 = tempdatee;
                                            tempdatee = 99999999;

                                        }
                                        if (MonthTemp != Month) {
                                            tempdatee = tempdatee2;
                                        }

                                        flagDateID = true;
                                        break;
                                    }
                                }


                                if (flagDateID == true && tempdates < tempdatee) {
                                    if (counter == 7) {
                                        str += "</tr> <tr>";
                                        counter = 0;
                                    }
                                    VacationDays++;
                                    str += "<td> " + tableid + "<br>";
                                    str += "" + "" + Daysarray[d] + "" + "<h3>" + "חופשה" + "</h3>" + "" + "";
                                    flag = true;
                                    tempdates = parseInt(tempdates) + 1000000;

                                }

                                if (parseInt(tempdates) == parseInt(tempdatee)) {
                                    flagDateID = false;
                                }


                                if (flag == false) {
                                    str += "<td> " + tableid + "<br>" + Daysarray[d];
                                }
                                str += "</td>";
                                counter++;
                                flag = false;
                                tableid++;
                                tempday = 0;
                                MonthTemp = 0;
                                flaglate = false;
                                d++;

                            }

                            hours = minutes = seconds = 0;
                            sum = sum * 3600;
                            while (sum >= 3600) {
                                hours++;
                                sum -= 3600;
                            }

                            while (sum >= 60) {
                                minutes++;
                                sum -= 60;
                            }

                            seconds = parseInt(sum);
                            if (hours < 10) { hours = "0" + hours; }
                            if (minutes < 10) { minutes = "0" + minutes; }
                            if (seconds < 10) { seconds = "0" + seconds; }

                            sum = hours + ":" + minutes + ":" + seconds;

                            str += "</tr>" + "</table>";
                            if (flagsum == true) {
                                $("#WorkersSelect4").empty();

                                str = "<div data-role=" + "collapsible" + "><h3>סיכום עבודה לחודש נבחר</h3> <p>מספר ימי עבודה:" + sumdays + "</p><br><br><br> <p>מספר שעות עבודה: " + sum + "</p><br><br><p>מספר איחרים:" + sumlatedays + "</p><br><br><p>מספר ימי חופשה:" + VacationDays + "</p></div><br><br>";
                                $("#WorkersSelect4").append(str).collapsibleset('refresh');
                            }

                            if (flagsum == "sumDaily") {
                                $("#WorkersSelect4").empty();
                                str2 += "<div data-role=" + "collapsible" + "><h3>סיכום עבודה לחודש :" + MonthsArry[parseInt(Month)] + "</h3><br><br><p>עובד:" + WorkerName + "</p><br><br> מספר ימי עבודה: " + sumdays + "<br><br>" + " מספר שעות: " + sum +"<br><br>"+" מספר איחורים:" + sumlatedays + "<br><br>" + "מספר ימי חופשה:" + VacationDays + "<br><br></p><br><br></div><br><br>";
                                $("#WorkersSelect4").append(str2).collapsibleset('refresh');
                            }

                            debugger;
                            if (flagsum == false) {
                                $("#WorkersSelect4").append(str).collapsibleset('refresh');
                                $.mobile.changePage('#VacationsReport',{ 'transition': 'none' });;
                            }
                            flag = null;
                            return;

                        }
                    }
                });

            }



            function Reportsums() {
                flag = "sumReport";
                VacationsReportEventsTable();
                return;
            }


            function ReportDaily() {
                NamesTable3();
                NamesTable3();
                flag = "sumDaily";
                VacationsReportEventsTable();
                return;
            }


            function ReportEventsTable() {
                flag = false;
                VacationsReportEventsTable();
                return;
            }





            function myFunction() {
                document.getElementById("myBtn").disabled = true;
                document.getElementById("myBtn2").disabled = true;
                //document.getElementById("myBtn5").disabled = true;
                //document.getElementById("myBtn6").disabled = true;
            }

            function myFunction2() {

                document.getElementById("myBtn").disabled = false;
                IDEvents2();
            }
            function myFunction3() {

                document.getElementById("myBtn2").disabled = false;
                document.getElementById("myBtn").disabled = true;

            }

            function myFunction4() {
                //document.getElementById("myBtn4").disabled = false;
            }

            function myFunction5() {
                //document.getElementById("myBtn4").disabled = true;
                document.getElementById("myBtn5").disabled = false;
            }
            function myFunction6() {
                document.getElementById("myBtn").disabled = false;
                //document.getElementById("myBtn2").disabled = false;
                document.getElementById("myBtn5").disabled = false;
                document.getElementById("myBtn6").disabled = false;
            }

            function showError(error) {
                debugger;
                switch (error.code) {
                    case error.PERMISSION_DENIED:
                        x.innerHTML = "User denied the request for Geolocation."
                        break;
                    case error.POSITION_UNAVAILABLE:
                        x.innerHTML = "Location information is unavailable."
                        break;
                    case error.TIMEOUT:
                        x.innerHTML = "The request to get user location timed out."
                        break;
                    case error.UNKNOWN_ERROR:
                        x.innerHTML = "An unknown error occurred."
                        break;
                }
            }

            //*************************************************************************

            //מעביר דף
            function ConnectEvents() {

                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/UpdateDate",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {

                        flag = 1;
                        myFunction2();
                        return;
                    }

                });
            }

            ///מחלקות והודעות********************************************///////////////////////////
            ///מערך שמות
            function NamesTable3Manger() {
                var Workerselect2 = "";
                var WorkerName = "";
                var PassWord = "";
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetWorkers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {

                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        namescounter = 0;
                        var j = 0;
                        for (var i = 0; i < WorkersObj.length; i++) {
                            names[j] = WorkersObj[i].ID;
                            names[j + 1] = WorkersObj[i].WorkerName;
                            names[j + 2] = WorkersObj[i].WorkerMail;
                            names[j + 3] = WorkersObj[i].WorkerDepartment;
                            names[j + 4] = WorkersObj[i].WorkerLocation;
                            names[j + 5] = WorkersObj[i].WorkerPhone;
                            names[j + 6] = WorkersObj[i].WorkerDistance;
                            names[j + 7] = WorkersObj[i].WorkerAddress;
                            names[j + 8] = "לא פעיל";
                            if (WorkersObj[i].Active == true) {
                                names[j + 8] = "פעיל";
                            }
                            names[j + 9] = WorkersObj[i].DepartmentID;
                            j = j + 10;
                            namescounter = namescounter + 10;
                        }

                    }
                });
            }


            //שליפת עובדים לפי מחלקה

            //פונקציה ששולפת נתוני עובד
            function WorkersInfo() {
                $.mobile.changePage('#WorkersInfo',{ 'transition': 'none' });;
                $.mobile.changePage('#WorkersInfo', { 'transition': 'none' });;
                TextCleaning();
                MessagsCleaning();
                GetDepartmentForums();
            }


            function GetDepartmentForums() {
                NamesTable3();
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + WorkerGlogalID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        DepartmentObj = JSON.parse(data.d); //or data["d"]
                        GettingWorkersForForums(DepartmentObj);
                    }
                });

            }


            function GetWorkersDepartments() {
                var WebServiceURL = "Enterence.asmx";
                $("#WorkersDepartments").empty();
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetWorkersDepartments",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + WorkerGlogalID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        WorkersDepartmentsObj = JSON.parse(data.d); //or data["d"]

                        var DepartmentsID;
                        var counter=0;
                        var Departmentsflaing = false;
                        var Workerflaing = false;
                        var flagfind = false;
                        var str;
                        var j = 0;
                        DepartmentsID = -1;

                        for(var i=0;i<WorkersDepartmentsObj.length;i++)  
                        {
                            if(DepartmentsID!=WorkersDepartmentsObj[i].DepartmentID)
                            {
                                if (flagfind == true)
                                {
                                    flagfind = false;
                                    str += "</tr>" + "</table>";
                                }
                                DepartmentsID = WorkersDepartmentsObj[i].DepartmentID;
                                Departmentsflaing=false;
                                Workerflaing = false;

                            }

                            if(Departmentsflaing==false)
                            {
                                str += "<br>";
                                counter++;
                                str += "<table id=" + counter + "<tr>";
                                str += "<td> " + "מחלקה" + "</td>";
                                str += "<td> " + "מספר עובדים" + "</td>";
                                str += "<td> " + "מספר הודעות" + "</td>";
                                str += "<td> " + "טלפון מחלקה" + "</td>";
                                str += "<td> " + "מייל מחלקה" + "</td>";
                                str += "</tr><tr>";

                                str += "<td> " + WorkersDepartmentsObj[i].Department + "</td>";
                                if (WorkersDepartmentsObj[i].Number_Of_Employees == null) {
                                    WorkersDepartmentsObj[i].Number_Of_Employees = 0;
                                }
                                str += "<td> " + WorkersDepartmentsObj[i].Number_Of_Employees + "</td>";

                                if (WorkersDepartmentsObj[i].Number_Of_Message == null) {
                                    WorkersDepartmentsObj[i].Number_Of_Message = 0;
                                }

                                str += "<td> " + WorkersDepartmentsObj[i].Number_Of_Message + "</td>";
                                str += "<td>0" + WorkersDepartmentsObj[i].PhoneNumber + "</td>";
                                str += "<td> " + WorkersDepartmentsObj[i].Email + "</td>";
                                str += "</tr>" + "</table>";
                                str += "</tr><tr><br>";
                                Departmentsflaing=true;

                            }

                            if(Departmentsflaing==true && WorkersDepartmentsObj[i].WorkerName!=null)
                                {
                                if(Workerflaing==false)
                                {
                                    str += "<table id=" + counter + "<tr>";
                                    str += "<td> " + "שם עובד" + "</td>";
                                    str += "<td> " + "מייל עובד" + "</td>";
                                    str += "<td> " + "מיקום עובד" + "</td>";
                                    str += "<td> " + "טלפון עובד" + "</td>";
                                    str += "<td> " + "כתובת עובד" + "</td>";
                                    str += "</tr><tr>";
                                    Workerflaing=true;
                                }
                                    }

                            if (WorkersDepartmentsObj[i].WorkerName != null &&  DepartmentsID == WorkersDepartmentsObj[i].DepartmentID)
                                {
                                        str += "<td> " + WorkersDepartmentsObj[i].WorkerName + "</td>";
                                        str += "<td> " + WorkersDepartmentsObj[i].WorkerMail + "</td>";
                                        str += "<td> " + WorkersDepartmentsObj[i].WorkerLocation + "</td>";
                                        str += "<td>" + "0" + WorkersDepartmentsObj[i].WorkerPhone + "</td>";
                                        str += "<td> " + WorkersDepartmentsObj[i].WorkerAddress + "</td>";
                                        str += "</tr><tr>";
                                        str += "<br>";
                                        flagfind = true;
                                    }
                        }
                        str += "</tr>" + "</table><br>";
                        $("#WorkersDepartments").append(str).collapsibleset('refresh');

                    }
                });
            }


            function GettingWorkersForForums(DepartmentObj) {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetWorkers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        flag = false;
                        var WorkersNames = "";
                        var Nametemp = "";
                        var nextId = 1;
                        var nextId2 = 100;
                        var nextId3 = 1000;
                        var nextId4 = 10000;
                        var nextId5 = 100000;
                        var nextId6 = 1000000;
                        var nextId7 = 10000000;
                        var tempDepartment = "";
                        var tempDepartment2 = "";
                        var content = "";
                        content += "<option value=" + nextId2 + ">" + "בחר עובד מחלקה " + "</option>";

                        DepartmentObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (ID == WorkersObj[i].ID) {
                                tempDepartment = WorkersObj[i].WorkerDepartment;
                            }

                        }

                        for (i = 0; i < WorkersObj.length; i++) {
                            if (tempDepartment == WorkersObj[i].WorkerDepartment) {
                                content += "<option value=" + WorkersObj[i].ID + ">" + WorkersObj[i].WorkerName + "</option>";
                            }
                            nextId2 = nextId2 + 1;
                        }

                        tempDepartment2 = "<h1>";
                        tempDepartment2 += tempDepartment;
                        tempDepartment2 += "</h1>";
                        $("#Departmentname").html(tempDepartment2);
                        $("#DepartmentsForums").html(content);
                    }
                });
            }


            // הודעות לפי משתמשים

            function MessageOld2New() {
                var tempID = $("#DepartmentsForums").val();
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var flag = 0;
                        $("#ForumsMessagesTable").empty();
                        var WorkersNames = "";
                        var Nametemp = "";
                        var max = 0;
                        var tempnum = 0;
                        var temptext = "";
                        var content = "";
                        var nextId = 1;
                        var nextId2 = 100;
                        var nextId3 = 1000;
                        var nextId4 = 10000;
                        var nextId5 = 100000;
                        var nextId6 = 1000000;
                        var k = 0;
                        var l = 0;
                        var j = 0;
                        var p = 0;
                        var TempTopic;
                        var TempTopicID;
                        var tempname = "";

                        content += "<div data-role=content>"
                        for (var u = 0 ; u < MassagingObj.length; u++) {
                            if (MassagingObj[u].ID == tempID && MassagingObj[u].Manger != true) {
                                TempTopic = MassagingObj[u].Message_Topic;
                                TempTopicID = MassagingObj[u].Message_ID;
                                TopicID = MassagingObj[u].ID;
                                TopicMessageID = MassagingObj[u].Message_ID;
                                Topicdatetime = MassagingObj[u].Message_datetime;
                                temptext = MassagingObj[u].Message_datetime;

                                content += "</p><div data-role=collapsible><h1>" + tempname + "<br>" + MassagingObj[u].Message_Topic + "<br>" + MassagingObj[u].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + temptext + "><br>";
                                //content += "</p><div data-role=collapsible><h1>" + tempname + "<br>" + "<br>" + WorkersObj[p].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + temptext + "><br>" + WorkersObj[p].Message_Content + "<br><br><br><br>" +
                                //   "<input type=textarea  id=" + nextId2 + " placeholder=" + "הכנס-הודעה" + " />" + "<br>" + "<br>";
                                content += MassagingObj[u].Message_Content + "</h3><br><br><br><br>";

                                content += "<br></div><br></p>";

                                //"<button type=button onclick=GetDMessagesID4replay(" + flagQuote + "," + "document.getElementById(" + nextId2 + ").value" + "," + TempID + "," + MessageID + ",'" + Message_datetime + "');>" + "הגב  להודעה " + "</button>" +
                            }
                        }
                        $("#ForumsMessagesTable").append(content).collapsibleset('refresh');


                    }
                });
            }


            function MessagNew2Old() {
                var tempID = $("#DepartmentsForums").val();
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {

                        debugger;
                    },

                    success: function (data) {
                        MassagingObj = JSON.parse(data.d); //or data["d"]
                        var flag = false;
                        var flag2 = false;
                        $("#ForumsMessagesTable").empty();
                        var WorkersNames = "";
                        var Nametemp = "";
                        var max = 0;
                        var tempnum = 0;
                        var temptext = "";
                        var content = "";
                        var nextId = 1;
                        var nextId2 = 100;
                        var nextId3 = 1000;
                        var nextId4 = 10000;
                        var nextId5 = 100000;
                        var nextId6 = 1000000;
                        var k = 0;
                        var l = 0;
                        var j = 0;
                        var p = 0;
                        var TempTopic;
                        var TempTopicID;
                        var tempname = "";

                        content += "<div data-role=content>"
                        for (var u = (MassagingObj.length - 1) ; u != -1; u--) {
                            if (MassagingObj[u].ID == tempID && MassagingObj[u].Manger != true) {
                                TempTopic = MassagingObj[u].Message_Topic;
                                TempTopicID = MassagingObj[u].Message_ID;
                                TopicID = MassagingObj[u].ID;
                                TopicMessageID = MassagingObj[u].Message_ID;
                                Topicdatetime = MassagingObj[u].Message_datetime;
                                temptext = MassagingObj[u].Message_datetime;

                                content += "</p><div data-role=collapsible><h1>" + tempname + "<br>" + MassagingObj[u].Message_Topic + "<br>" + MassagingObj[u].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + temptext + "><br>";
                                //content += "</p><div data-role=collapsible><h1>" + tempname + "<br>" + "<br>" + WorkersObj[p].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + temptext + "><br>" + WorkersObj[p].Message_Content + "<br><br><br><br>" +
                                //   "<input type=textarea  id=" + nextId2 + " placeholder=" + "הכנס-הודעה" + " />" + "<br>" + "<br>";
                                content += MassagingObj[u].Message_Content + "</h3><br><br><br><br>";

                                content += "<br></div><br></p>";

                                //"<button type=button onclick=GetDMessagesID4replay(" + flagQuote + "," + "document.getElementById(" + nextId2 + ").value" + "," + TempID + "," + MessageID + ",'" + Message_datetime + "');>" + "הגב  להודעה " + "</button>" +
                            }
                        }
                        $("#ForumsMessagesTable").append(content).collapsibleset('refresh');
                    }
                });
            }

            //סימון הודעה אחרונה
            function TrueNewestPost() {
                var tempID = 0;
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var flag = 0;
                        var WorkersNames = "";
                        var Nametemp = "";
                        var max = 0;
                        var tempnum = 0;
                        var Tempdate = "";
                        var temptext = "";
                        var content = "";
                        var nextId = 1;
                        var k = 0;
                        var l = 0;
                        var j = 0;
                        var p = 0;
                        flag = false;
                        for (var i = 0; i < WorkersObj.length; i++) {
                            for (j = 0; j < WorkersObj[i].Message_datetime.length; j++) {
                                if (WorkersObj[i].Message_datetime[j] >= 0 && WorkersObj[i].Message_datetime[j] <= 9) {
                                    flag = true;
                                    max += WorkersObj[i].Message_datetime[j];
                                    tempID = WorkersObj[i].ID;

                                }
                            }
                            if (flag == true) {
                                break;
                            }
                        }

                        flag = false;
                        for (k = 0; k < WorkersObj.length; k++) {
                            while (l < WorkersObj[k].Message_datetime.length) {
                                if (WorkersObj[k].Message_datetime[l] >= 0 && WorkersObj[k].Message_datetime[l] <= 9) {
                                    tempnum += WorkersObj[k].Message_datetime[l];


                                }
                                l++;
                            }
                            if (max < tempnum) {
                                max = tempnum;
                                tempID = WorkersObj[k].ID;
                                Tempdate = WorkersObj[k].Message_datetime;
                                temptext = WorkersObj[k].Message_Content;
                            }
                            tempnum = 0;
                            l = 0;

                        }


                        $.ajax({
                            url: WebServiceURL + "/UpdateTrueForMaxDate",
                            dataType: "json",
                            type: "POST",   //use only POST!
                            data: "{'ID':'" + tempID + "','Tempdate':'" + Tempdate + "','Message_Content':'" + temptext + "'}",

                            contentType: "application/json; charset=utf-8",
                            error: function (jqXHR, exception) {

                                debugger;
                            },
                            success: function (data) {
                                WorkersInfo();
                                MessagesForums();
                                $.mobile.changePage('#WorkersInfo',{ 'transition': 'none' });;

                            }

                        });
                    }
                });
            }











            //הודעות פרטיות
            function PrivateSendedNew2Old() {
                var tempID = $("#DepartmentsForums").val();
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        flag = 0;
                        $("#ForumsMessagesTable").empty();
                        var WorkersNames = "";
                        var Private = true;
                        var Nametemp = "";
                        var max = 0;
                        var tempnum = 0;
                        var temptext = "";
                        var content = "";
                        var nextId = 1;
                        var nextId2 = 100;
                        var nextId3 = 1000;
                        var nextId4 = 10000;
                        var nextId5 = 100000;
                        var nextId6 = 1000000;
                        var k = 0;
                        var l = 0;
                        var j = 0;
                        var p = 0;
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (WorkersObj[i].ID == ID && WorkersObj[i].Message_ID == tempID && WorkersObj[i].Private_Message == true) {
                                for (j = 0; j < WorkersObj[i].Message_datetime.length; j++) {
                                    if (WorkersObj[i].Message_datetime[j] >= 0 && WorkersObj[i].Message_datetime[j] <= 9) {
                                        max += WorkersObj[i].Message_datetime[j];

                                    }
                                }
                                while (k < WorkersObj.length) {
                                    if (WorkersObj[k].ID == ID && WorkersObj[k].Message_ID == tempID && WorkersObj[k].Private_Message == true && WorkersObj[k].Message_datetime != "1") {
                                        if (flag == 0) {
                                            p = k;
                                            flag = 1;
                                        }
                                        while (l < WorkersObj[k].Message_datetime.length) {
                                            if (WorkersObj[k].Message_datetime[l] >= 0 && WorkersObj[k].Message_datetime[l] <= 9) {
                                                tempnum += WorkersObj[k].Message_datetime[l];

                                            }
                                            l++;
                                        }
                                        if (max < tempnum) {
                                            max = tempnum;
                                            p = k;
                                        }
                                    }
                                    tempnum = 0;
                                    l = 0;
                                    k++;
                                }

                                if (flag == 1) {

                                    temptext = WorkersObj[p].Message_datetime;
                                    content += "<table id=" + nextId3 + "<tr> <td> <input type=" + "radio" + " name=" + "ClassMessage" + " value=" + temptext + ">" + "נשלח ב:" + WorkersObj[p].Message_datetime + "<br>" + WorkersObj[p].Message_Content + "<br></td> </tr>" + "</table>";

                                    WorkersObj[p].Message_datetime = "1";
                                }
                            }
                            tempnum = 0;
                            max = 0;
                            l = 0;
                            flag = 0;
                            k = 0;
                            j = 0;
                            nextId3 = nextId3 + 1;
                        }
                        $("#ForumsMessagesTable").append(content).collapsibleset('refresh');


                    }
                });
            }


            function PrivateMessages() {
                var tempID = $("#DepartmentsForums").val();
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var flag = 0;
                        $("#ForumsMessagesTable").empty();
                        var WorkersNames = "";
                        var Nametemp = "";
                        var max = 0;
                        var tempnum = 0;
                        var temptext = "";
                        var content = "";
                        var nextId = 1;
                        var nextId2 = 100;
                        var nextId3 = 1000;
                        var nextId4 = 10000;
                        var nextId5 = 100000;
                        var nextId6 = 1000000;
                        var flagQuote = true;
                        var k = 0;
                        var l = 0;
                        var j = 0;
                        var p = 0;
                        var TopicID = 0;
                        var TopicMessageID = 0;
                        var Topicdatetime = 0;
                        var Private = true;

                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (tempID == WorkersObj[i].ID && WorkersObj[i].Private_Message == true && ID == WorkersObj[i].Message_ID) {
                                for (j = 0; j < WorkersObj[i].Message_datetime.length; j++) {
                                    if (WorkersObj[i].Message_datetime[j] >= 0 && WorkersObj[i].Message_datetime[j] <= 9) {
                                        max += WorkersObj[i].Message_datetime[j];

                                    }
                                }
                                while (k < WorkersObj.length) {
                                    if (tempID == WorkersObj[k].ID && WorkersObj[k].Message_datetime != "1" && WorkersObj[k].Private_Message == true && ID == WorkersObj[k].Message_ID) {
                                        if (flag == 0) {
                                            p = k;
                                            flag = 1;
                                        }
                                        while (l < WorkersObj[k].Message_datetime.length) {
                                            if (WorkersObj[k].Message_datetime[l] >= 0 && WorkersObj[k].Message_datetime[l] <= 9) {
                                                tempnum += WorkersObj[k].Message_datetime[l];

                                            }
                                            l++;
                                        }
                                        if (max < tempnum) {
                                            max = tempnum;
                                            p = k;
                                        }
                                    }
                                    tempnum = 0;
                                    l = 0;
                                    k++;
                                }

                                if (flag == 1) {
                                    temptext = WorkersObj[p].Message_datetime;
                                    Topicdatetime = temptext;
                                    TopicMessageID = WorkersObj[p].Message_ID

                                    TopicID = WorkersObj[p].ID;
                                    //"," + TopicMessageID + ",'" + Topicdatetime + "," + TopicID +
                                    content += "<table id=" + nextId3 + "<tr> <td> <input type=" + "radio" + " name=" + "ClassMessage" + " value=" + temptext + ">" + "נשלח ב:" + WorkersObj[p].Message_datetime + "<br>" + WorkersObj[p].Message_Content + "<br><br><button type=button onclick=PrivatePage(" + flagQuote + "," + TopicID + "," + TopicMessageID + ",'" + Topicdatetime + "');>" + "הגב ישירות להודעה פרטית " + "</button>" + "<br></td> </tr>" + "</table>";
                                    WorkersObj[p].Message_datetime = "1";
                                }
                            }
                            tempnum = 0;
                            max = 0;
                            l = 0;
                            flag = 0;
                            k = 0;
                            j = 0;
                            nextId3 = nextId3 + 1;
                        }
                        $("#ForumsMessagesTable").append(content).collapsibleset('refresh');


                    }
                });
            }

            function MessagesForums() {
                var tempID = $("#DepartmentsForums").val();
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetManagers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                    },

                    success: function (data) {
                        MangerObj = JSON.parse(data.d); //or data["d"]
                        GetDepartmentsMassagingWorker(MangerObj);
                    }
                });

            }

            function GetDepartmentsMassagingWorker(MangerObj) {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        MassagingObj = JSON.parse(data.d); //or data["d"]
                        MessagesForumsWrker(MassagingObj, MangerObj)
                    }
                });

            }


            function MessagesForumsWrker(MassagingObj, MangerObj) {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetWorkers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'WorkerName':'" + WorkerName + "','PassWord':'" + PassWord + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {

                    },

                    success: function (data)
                    {

                        OriginalWorkersObj = JSON.parse(data.d); //or data["d"]
                        MessagesForumsWrker2(OriginalWorkersObj, MassagingObj, MangerObj);
                    }
                });

            }

            function MessagesForumsWrker2(OriginalWorkersObj, MassagingObj, MangerObj)
            {
                        var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {

                    },

                    success: function (data)
                    {
                        var content = "";
                        var status;
                        var TempWorkerDepartment;
                        DepartmentsObj = JSON.parse(data.d); //or data["d"]
                        for (var l = 0; l < OriginalWorkersObj.length; l++)
                        {
                            if(ID==OriginalWorkersObj[l].ID)
                            {
                                TempWorkerDepartment = OriginalWorkersObj[l].WorkerDepartment;
                            }
                        }

                        for (l = 0; l < DepartmentsObj.length; l++) {
                            if (TempWorkerDepartment == DepartmentsObj[l].Department) {
                                status = DepartmentsObj[l].Active;
                            }
                        }
                        if (status==false)
                        {
                            content = "מחלקה לא פעילה,אין גישה לעובדים";
                            $("#ForumsMessagesTable").append(content).collapsibleset('refresh');
                            return;
                        }
                        var flag = false;
                        var flag2 = false;
                        var flag3 = false;
                        var flag4 = false;
                        var flagmanger = false;
                        $("#ForumsMessagesTable").empty();
                        var WorkersNames = "";
                        var Nametemp = "";

                        var min = 0;
                        var minday = 0
                        var minmonth = 0
                        var minyear = 0
                        var minsec = 0
                        var minin = 0
                        var minhour = 0

                        var tempnum = 0;
                        var tempnumday = 0
                        var tempnumonth = 0
                        var tempnumyear = 0
                        var tempnumsec = 0
                        var tempnummin = 0
                        var tempnumhour = 0


                        var tempname = 0;
                        var TempTopic = "";
                        var temptext = "";
                        var tempWorkersObj;
                        var Message_datetime = "";
                        var TempID = 0;
                        var MessageID = 0;
                        var TopicID = 0;
                        var TopicMessageID = 0;
                        var Topicdatetime = "";
                        var nextId = 1;
                        var nextId2 = 100;
                        var nextId3 = 1000;
                        var nextId4 = 10000;
                        var nextId5 = 100000;
                        var nextId6 = 1000000;
                        var counter = 0;
                        var mul = 1;
                        var nextId6 = 1000000;
                        var something;
                        var k = 0;
                        var QuotedMemberID = 0;
                        var l = 0;
                        var j = 0;
                        var p = 0;
                        var y = 0;
                        var i = 0;
                        var q = 0;
                        var QuotedMemberID = 0;
                        var QuotedMember;
                        var TempTopicID = 0;
                        var flagQuote = false;
                        var flagTopic = false;
                        var tempdates = 0;
                        var d = 0;

                        for (y = 0; y < namescounter; y = y + 10) {
                            if (names[y] == ID) {
                                TempWorkerDepartment = names[y + 3];
                                break;
                            }
                        }


                        //for (var z = 0; z < WorkersObj.length; z++)
                        //{
                        //    if(WorkersObj[z].Unread==true)
                        //    {

                        //        temptext = WorkersObj[0];
                        //        WorkersObj[0]=WorkersObj[z];
                        //        WorkersObj[z] = temptext;

                        //    }
                        //}
                        //TempWorkerDepartment = Department;
                        content += "<div data-role=content>"
                        for (var u = (MassagingObj.length - 1) ; u != -1; u--) {
                            if (MassagingObj[u].Department == TempWorkerDepartment) {
                                flag3 = true;
                                TempTopic = MassagingObj[u].Message_Topic;
                                TempTopicID = MassagingObj[u].Message_ID;




                                //האם הודעת פתיח
                                if (flag2 == false && MassagingObj[p].Topic == true) {


                                    TopicID = MassagingObj[u].ID;
                                    TopicMessageID = MassagingObj[u].Message_ID;
                                    Topicdatetime = MassagingObj[u].Message_datetime;
                                    temptext = MassagingObj[u].Message_datetime;
                                    flagQuote = true;
                                    flagTopic = true;


                                    for (y = 0; y < OriginalWorkersObj.length; y++) {
                                        if (OriginalWorkersObj[y].ID == TopicID) {
                                            tempname = OriginalWorkersObj[y].WorkerName;
                                            break;
                                        }
                                    }

                                    for (y = 0; y < MangerObj.length; y++) {
                                        if (MangerObj[y].ID == TopicID && MassagingObj[u].Manger == true) {
                                            tempname = MangerObj[y].MangerName;
                                            flagmanger = true;
                                            break;
                                        }
                                    }



                                    if (flagmanger == true) {
                                        content += "</p><div data-role=collapsible><h1>" + tempname + "<br> מנהל" + "<br>" + MassagingObj[u].Message_Topic + "<br>" + MassagingObj[u].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + temptext + "><br>";
                                    }
                                    if (flagmanger == false) {
                                        content += "</p><div data-role=collapsible><h1>" + tempname + "<br>" + MassagingObj[u].Message_Topic + "<br>" + MassagingObj[u].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + temptext + "><br>";
                                    }
                                    flagmanger = false;;
                                    //content += "</p><div data-role=collapsible><h1>" + tempname + "<br>" + "<br>" + WorkersObj[p].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + temptext + "><br>" + WorkersObj[p].Message_Content + "<br><br><br><br>" +
                                    //   "<input type=textarea  id=" + nextId2 + " placeholder=" + "הכנס-הודעה" + " />" + "<br>" + "<br>";
                                    content += MassagingObj[u].Message_Content + "</h3><br><br><br><br>";
                                    if (ID == TopicID && MassagingObj[u].Manger != true) {
                                        content += "<button type=button onclick=UpdateOrDeletePage(" + flagTopic + "," + MassagingObj[u].Departments_MessagesID + "," + TopicID + "," + TopicMessageID + ",'" + Topicdatetime + "');>" + "ערוך או מחק הודעה" + "</button>";
                                    }

                                    if (ID == TempID) {
                                        content += "<button type=button onclick=UpdateOrDeletePage(" + flagTopic + "," + MassagingObj[u].Departments_MessagesID + "," + MassagingObj[u].Departments_MessagesID + "," + TempID + "," + MessageID + ",'" + Message_datetime + "');>" + "ערוך או מחק הודעה" + "</button>";
                                    }

                                    content += "<br></div><br>";

                                    flagmanger = false;;

                                    //"<button type=button onclick=GetDMessagesID4replay(" + flagQuote + "," + "document.getElementById(" + nextId2 + ").value" + "," + TempID + "," + MessageID + ",'" + Message_datetime + "');>" + "הגב  להודעה " + "</button>" +


                                    nextId2++;
                                    counter++;
                                    flag2 = true;
                                    tempnum = "";
                                    min = "";
                                    l = 0;
                                    flagmanger = false;
                                    flag = false;
                                    k = 0;
                                    j = 0;
                                    nextId3 = nextId3 + 1
                                    nextId2 = nextId2 + 1;
                                    nextId6 = nextId6 + 1;
                                    tempnum = "";
                                    min = "";
                                    l = 0;
                                    flag = false;
                                    flagTopic = false;

                                    //}

                                    flag2 = false;
                                    flag3 = false;
                                }
                            }
                        }


                        $("#ForumsMessagesTable").append(content).collapsibleset('refresh');

                    }
                });
            }
            



            //חיפוש הודעות

            //ניקוי טקסט
            function TextCleaning() {
                var str = "";
                $("#SearchMessages").val("");
                $("#ByYear").val("");
            }



            function OrdertmentsMassaging(DepartmentsMessagesID) {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },

                    success: function (data) {
                        MessagesObj = JSON.parse(data.d); //or data["d"]
                        OriginalID = DepartmentsMessagesID;
                        OrderingtmentsMassaging(MessagesObj);
                        OriginalID = ID;
                    }

                });
            }

            function OrderingtmentsMassaging(MessagesObj) {
                var Departments_MessagesID = OriginalID;
                var i = OriginalID;
                if (i < MessagesObj.length) {
                    var TempID = MessagesObj[i].ID;
                    var Message_Content = MessagesObj[i].Message_Content;
                    var Message_datetime = MessagesObj[i].Message_datetime;
                }

                if (i > MessagesObj.length) {
                    i--;
                    var TempID = MessagesObj[i].ID;
                    var Message_Content = MessagesObj[i].Message_Content;
                    var Message_datetime = MessagesObj[i].Message_datetime;
                }

                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/UntrueMessages",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + TempID + "','Departments_MessagesID':'" + Departments_MessagesID + "','Message_Content':'" + Message_Content + "','Message_datetime':'" + Message_datetime + "'}",

                    //"','Departments_MessagesID':'" + Departments_MessagesID + "','Message_Content':'" + Message_Content + "','Message_datetime':'" + Message_datetime +
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        //while (OriginalID < (MessagesObj.length + 1)) {
                        //    OriginalID++;
                        //    OrderingtmentsMassaging(MessagesObj);
                        //}
                        debugger;
                    }
                });


            }







            ///מחפש הודעות
            function SearchMessages() {
                MessagsCleaning();
                var tempID = $("#DepartmentsForums").val();
                var MessageWords = $("#SearchMessages").val();
                var datetime = $("#ByYear").val();


                var d1;

                d1 = datetime[8];
                d1 += datetime[9];
                d1 += '/';
                d1 += datetime[5];
                d1 += datetime[6];
                d1 += '/';
                d1 += datetime[0];
                d1 += datetime[1];
                d1 += datetime[2];
                d1 += datetime[3];
                datetime = d1;


                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },

                    success: function (data) {
                        var tempdate = "";
                        var n = "";
                        var nextId3 = 1000;
                        var j = 0;
                        var content = "<div data-role=content>";
                        MassagingObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < MassagingObj.length; i++) {
                            if (MassagingObj[i].Message_datetime.indexOf(datetime) != -1 && MassagingObj[i].Message_Content.indexOf(MessageWords) != 1 && tempID == MassagingObj[i].ID || tempdate.indexOf(datetime) != 1 && MassagingObj[i].Message_Topic.indexOf(MessageWords) != -1 && tempID == MassagingObj[i].ID) {
                                content += "</p><div data-role=collapsible><h1>" + " " + "<br>" + MassagingObj[i].Message_Topic + "<br>" + MassagingObj[i].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + MassagingObj[i].Message_datetime + "><br>";
                                content += MassagingObj[i].Message_Content + "</h3><br><br><br><br>";
                                content += "<br></div><br></p>";
                            }

                            tempdate = "";
                        }
                        $("#ForumsMessagesTable").append(content).collapsibleset('refresh');
                    }
                });
            }



            function UserDetails() {
                var tempID = $("#DepartmentsForums").val();
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetWorksDate",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + tempID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var flag = 0;
                        var content = "";
                        var j = 0;
                        var i = 0;
                        var situation;
                        var Starthours;
                        $("#ForumsMessagesTable").empty();

                        Starthours = "לא התחיל לעבוד";
                        situation = " לא נמצא בעבודה כרגע";
                        for (var i = 0 ;i<WorkersObj.length;i++) {
                            if (tempID == WorkersObj[i].ID && WorkersObj[i].EndHour == null) {

                                situation = "נמצא בעבודה כרגע";
                                Starthours = WorkersObj[i].StartHour;
                                break;
                            }
                        }

                        for (i = 0; i < namescounter; i = i + 10) {
                            if (tempID == names[i]) {
                                content += "שם=" + names[j + 1] + "<br> <br>איימייל: " + "<a href=" + "mailto:" + names[j + 2] + "?subject=Circle Around&body=Some blah" + "target=_top>" + "" + names[j + 2] + "</a><br> <br>" + "מיקום=" + names[j + 4] + "<br> <br>" + " טלפון: <a href=tel:" + "0" + names[j + 5] + ">" + "0" + names[j + 5] + "</a><br> <br>" + "מרחק=" + names[j + 6] + "<br> <br>" + "כתובת;=" + names[j + 7] + " <br> <br>" + "מצב=" + names[j + 8] + " <br> <br>" + "שעת התחלת עבודה=" + Starthours + " <br> <br>" + "עובד כרגע?=" + situation;
                                break;
                            }
                            j = j + 10;
                        }
                        $("#ForumsMessagesTable").append(content).collapsibleset('refresh');
                    }
                });
            }



            //פונקציה דף יצירת נושא
            function CreateTopicPage() {
                $.mobile.changePage('#CreateTopicPage',{ 'transition': 'none' });;
                $.mobile.changePage('#CreateTopicPage',{ 'transition': 'none' });;
                $('#DepartmentForumsError').html(" ");
            }





            /////////////////////////////////////////////////////////////////////////////////שליחת הודועת
            //הודעה פרטית

            //function PrePrivatePage() {
            //    var TempID = $("#DepartmentsForums").val();
            //    if (ID == TempID || TempID == 100) {
            //        return;
            //    }
            //    var MessageID = null;
            //    var Message_datetime = null;
            //    var flagQuote = false;
            //    PrivatePage(flagQuote, TempID, MessageID, Message_datetime)
            //}


            //function PrivatePage(flagQuote, TempID, MessageID, Message_datetime) {
            //    //TempID, MessageID, Message_datetime,
            //    if (ID == TempID || TempID == 100)
            //    {

            //        return;
            //    }
            //    $.mobile.changePage('#SendPrivate',{ 'transition': 'none' });;
            //    $.mobile.changePage('#SendPrivate', { 'textID': 'flip' });
            //    $("#Message_datetime").html(Message_datetime);
            //    $("#Message_datetime").hide();
            //    $("#MessageID").html(MessageID);
            //    $("#MessageID").hide();
            //    $("#textQoute").html(flagQuote);
            //    $("#textQoute").hide();
            //    $("#textID").html(TempID);
            //    $("#textID").hide();
            //    return;
            //}

            //function SendPrivateMessage() {
            //    var Message_Content = $('#AreaTextsPrivate').val();
            //    var MessageID = $('#textID').text();
            //    var MessageDepartment;
            //    var NumberOfMessages = 0;
            //    var TempID = ID;
            //    var Private_Message = true;
            //    var Quoted_Message = "";
            //    var flagQuote = "";
            //    var flagQuote = $('#textQoute').text();
            //    var Message_datetime = $('#Message_datetime').text();
            //        var WebServiceURL ="http://ruppinmobile.ac.il.preview26.livedns.co.il/site08/Enterence.asmx"
            //    $.ajax({
            //        url: WebServiceURL + "/GetDepartmentsMassaging",
            //        dataType: "json",
            //        type: "POST",   //use only POST!
            //        data: "{'ID':'" + ID + "'}",
            //        contentType: "application/json; charset=utf-8",
            //        error: function (jqXHR, exception) {
            //            debugger;
            //        },
            //        success: function (data) {
            //            WorkersObj = JSON.parse(data.d); //or data["d"]
            //            for (var i = 0; i < WorkersObj.length; i++) {
            //                if (WorkersObj[i].ID == MessageID && WorkersObj[i].Message_ID == ID && flagQuote == "true" && WorkersObj[i].Private_Message == true) {
            //                    Quoted_Message = WorkersObj[i].Message_Content;
            //                    MessageDepartment = WorkersObj[i].Department
            //                    var Topic = false;
            //                    break;
            //                }

            //            }
            //            var Message_Topic = null
            //            flag = false;
            //            Topic = true;
            //            AddDMessages(Private_Message, TempID, MessageID, Quoted_Message, Message_Topic, Message_Content, MessageDepartment, Topic);
            //        }

            //    });
            //}







            //הודעות פרטיות
            function GetDPrivate4replay(TempID, MessageID, Message_datetime) {
                return;
                var Quoted_Message = null;
                var Private_Message = true;
                var Message_Topic = "";
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (WorkersObj[i].ID == TempID && WorkersObj[i].Message_ID == MessageID && WorkersObj[i].Message_datetime == Message_datetime) {
                                Quoted_Message = WorkersObj[i].Message_Content;
                                MessageDepartment = WorkersObj[i].Department;
                                break;
                            }

                        }
                        flag = true;
                        var Topic = false;
                        AddDMessages(Private_Message, TempID, MessageID, Quoted_Message, Message_Topic, Message_Content, MessageDepartment, Topic);
                        return;
                    }

                });
            }






            function GetDMessagesID4replay(flagQuote, Message_Content, TempID, MessageID, Message_datetime) {

                var Quoted_Message = null;
                var Message_Topic = "";
                var MessageDepartment;
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (WorkersObj[i].Departments_MessagesID == MessageID) {
                                MessageDepartment = WorkersObj[i].Department;
                                Message_Topic = WorkersObj[i].Message_Topic;
                                MessageID = WorkersObj[i].Message_ID;
                                if (flagQuote == true) {
                                    Quoted_Message = WorkersObj[i].Message_Content;

                                }
                                break;
                            }

                        }
                        var Private_Message = false;
                        flag = true;
                        var Topic = false;
                        AddDMessages(Private_Message, TempID, MessageID, Quoted_Message, Message_Topic, Message_Content, MessageDepartment, Topic);
                        return;
                    }

                });
            }



            function GetDMessagesID() {

                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {

                        WorkersObj = JSON.parse(data.d); //or data["d"]

                        GetDMessagesIDing(WorkersObj);
                    }

                });
            }


            function GetDMessagesIDing(WorkersObj)
            {
                                var WebServiceURL = "Enterence.asmx";
                        $.ajax({

                            url: WebServiceURL + "/GetDepartment",
                            dataType: "json",
                            type: "POST",   //use only POST!
                            // data: "{'num':'" + num + "' }",

                            data: "{'ID':'" + ID + "'}",

                            contentType: "application/json; charset=utf-8",
                            error: function (jqXHR, exception) {

                            },

                            success: function (data)
                            {
                                DepartmentsObj = JSON.parse(data.d); //or data["d"]
                                var content = "";
                                var status;
                                var TempWorkerDepartment;
                                var Message_ID = 1;
                                var MessageDepartment;
                                var DepartmentID = 0;
                                for (var l = 0; l < WorkersObj.length; l++)
                                {
                                    if (ID == WorkersObj[l].ID)
                                    {
                                        TempWorkerDepartment = WorkersObj[l].Department;
                                    }
                                }

                                for (l = 0; l < DepartmentsObj.length; l++) {
                                    if (TempWorkerDepartment == DepartmentsObj[l].Department) {
                                        status = DepartmentsObj[l].Active;
                                    }
                                }
                                if (status==false)
                                {
                                    content = "מחלקה לא פעילה,אין גישה לעובדים";
                                    $('#DepartmentForumsError').html(content);
                                    return;
                                }


                        for (var j = 0; j < namescounter; j = j + 10) {
                            if (ID == names[j]) {
                                MessageDepartment = names[j + 3];
                            }
                        }

                        j = 1;
                        for (i = 0; i < WorkersObj.length; i++) {
                            if (ID == WorkersObj[i].Message_ID) {
                                j++;
                            }
                        }


                        MessageID = j;

                        var Private_Message = false;
                        var Message_Topic = "";
                        var Message_Content = "";
                        Quoted_Message = false;
                        TempID = 0;
                        flag = true;
                        var Topic = true;
                        AddDMessages(Private_Message, TempID, MessageID, Quoted_Message, Message_Topic, Message_Content, MessageDepartment, Topic);
                        return;
                    }

                });
            }


            function AddDMessages(Private_Message, TempID, MessageID, Quoted_Message, Message_Topic, Message_Content, MessageDepartment, Topic) {
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {

                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var Departments_MessagesID = 1;
                        j = 0;
                        for (i = 0; i < WorkersObj.length; i++) {
                            if (Departments_MessagesID <= WorkersObj[i].Departments_MessagesID) {
                                Departments_MessagesID = WorkersObj[i].Departments_MessagesID;
                                Departments_MessagesID++;
                            }
                        }
                        AddDMessagesToTableWorker(Private_Message, TempID, MessageID, Quoted_Message, Message_Topic, Message_Content, MessageDepartment, Departments_MessagesID, Topic);
                        return;
                    }

                });
            }



            //מוסיף הודעה
            function AddDMessagesToTableWorker(Private_Message, TempID, MessageID, Quoted_Message, Message_Topic, Message_Content, MessageDepartment, Departments_MessagesID, Topic) {
                var Unread = false;
                var DepartmentID = 0;
                if (flag == true) {
                    //UntrueMessages();
                    Unread = true;
                }
                var Reported = false;
                var TempDepartment = "";
                if (TempID == 0) {
                    Message_Content = $("#AreaTexts").val();
                    Message_Topic = $("#textTopic").val();
                }
                if (Message_Content == "" || Message_Topic == "") {
                    $('#DepartmentForumsError').html("לא ניתן להכניס הודעה או כותרת ריקה");
                    return;
                }

                         var WebServiceURL = "Enterence.asmx";


                $.ajax({

                    url: WebServiceURL + "/AddDMessages",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "','Message_ID':'" + MessageID + "','Department':'" + MessageDepartment + "','Message_Content':'" + Message_Content + "','Quoted_Message':'" + Quoted_Message + "','Message_Topic':'" + Message_Topic + "','Private_Message':'" + Private_Message + "','Reported':'" + Reported + "','Unread':'" + Unread + "','Departments_MessagesID':'" + Departments_MessagesID + "','Topic':'" + Topic + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },

                    success: function (data) {
                        debugger;

                        CountMessages(MessageDepartment);
                        SetID(Departments_MessagesID, MessageDepartment);
                        WorkersInfo();
                        $("#ForumsMessagesTable").empty();
                        MessagesForums();
                        return;
                    }

                });
            }

            function SetID(Departments_MessagesID, MessageDepartment) {

                         var WebServiceURL = "Enterence.asmx";
                var DepartmentID = 0;
                $.ajax({

                    url: WebServiceURL + "/GetDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        DepartmentObj = JSON.parse(data.d); //or data["d"]

                        for (var i = 0; i < DepartmentObj.length; i++) {
                            if (DepartmentObj[i].Department == MessageDepartment) {
                                DepartmentID = DepartmentObj[i].DepartmentID;
                                break;
                            }

                        }

                        UpdateDepartmentID(Departments_MessagesID, DepartmentID)
                    }
                });
            }


            function UpdateDepartmentID(Departments_MessagesID, DepartmentID) {

                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/UpdateDepartmentID",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + Departments_MessagesID + "','DepartmentID':'" + DepartmentID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                    }
                });
            }




            //סופר מספר הודעות עדכני
            function CountMessages(MessageDepartment) {
                var Number_Of_Message = 0;
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (MessageDepartment == WorkersObj[i].Department) {
                                Number_Of_Message++;
                            }
                        }
                        UpdateDepartmentMessages(MessageDepartment, Number_Of_Message);
                    }

                });
            }


            //מעדכן מספר הודעות במחלקה
            function UpdateDepartmentMessages(MessageDepartment, Number_Of_Message) {
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/UpdateDepartmentMessages",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'Department':'" + MessageDepartment + "','Number_Of_Message':'" + Number_Of_Message + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                    }

                });
            }



            //////////////////////////////////////////////////////////////////////////////////עדכון הודעה
            //דף עדכון הודעה
            function UpdateOrDeletePage(flagTopic, DepartmentsMessagesID, TempID, MessageID, Message_datetime) {

                if (flagTopic == false) {
                    $.mobile.changePage('#UpdateOrDeletePage',{ 'transition': 'none' });;
                    $.mobile.changePage('#UpdateOrDeletePage',{ 'transition': 'none' });;
                }

                if (flagTopic == true) {
                    $("#DepartmentsMessagesID").val(DepartmentsMessagesID);
                    $.mobile.changePage('#UpdateOrDeletePageWithTopic',{ 'transition': 'none' });;
                    $.mobile.changePage('#UpdateOrDeletePageWithTopic',{ 'transition': 'none' });;
                }
                $("#textDate").empty();
                $("#AreaTexts4update").empty();
                var Message_Content = "";
                var Message_Topic = "";
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (WorkersObj[i].ID == TempID && WorkersObj[i].Message_ID == MessageID && WorkersObj[i].Message_datetime == Message_datetime) {
                                Message_Content = WorkersObj[i].Message_Content;

                                if (flagTopic == true) {
                                    Message_Topic = WorkersObj[i].Message_Topic;
                                    $("#textUpdateTopic").val(Message_Topic);
                                    $("#textDate2").html(Message_datetime);
                                    $("#AreaTexts4update2").html(Message_Content);
                                    return;
                                }
                                break;
                            }

                        }
                        $("#DepartmentsMessagesID").hide();
                        $("#textDate").html(Message_datetime);
                        $("#AreaTexts4update").html(Message_Content);
                        return;
                    }

                });
            }





            function UpdateWithTopic() {
                var Message_Topic = $("#textUpdateTopic").val();
                var Message_datetime = $('#textDate2').text();
                var Message_Content = $("#AreaTexts4update2").val();
                var DepartmentsMessagesID = $("#DepartmentsMessagesID").val();
                var Topic_ID = 0;
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/UpdateWithTopic",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + DepartmentsMessagesID + "','Message_Content':'" + Message_Content + "','Message_Topic':'" + Message_Topic + "','Message_datetime':'" + Message_datetime + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                        WorkersInfo();
                        $("#ForumsMessagesTable").empty();
                        MessagesForums();
                    }
                });
            }


            function GetTopicID(Message_datetime, Message_Topic) {
                var Topic_ID = 0;
                flag = 0;
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (ID == WorkersObj[i].ID && Message_datetime == WorkersObj[i].Message_datetime) {
                                Topic_ID = WorkersObj[i].Message_ID;
                                break;
                            }
                        }
                        UpdateAllTopic(Topic_ID, Message_Topic);
                    }
                });
            }


            function UpdateAllTopic(Topic_ID, Message_Topic) {
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/UpdateAllTopic",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",
                    data: "{'Topic_ID':'" + Topic_ID + "','Message_Topic':'" + Message_Topic + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                        WorkersInfo();
                        $("#ForumsMessagesTable").empty();
                        MessagesForums();
                    }
                });
            }

            //עדכון תגובה רגילה
            function UpdateDepartmentsMassaging() {
                var Message_datetime = $('#textDate').text();
                var Message_Content = $("#AreaTexts4update").val();
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/UpdateDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",
                    data: "{'ID':'" + ID + "','Message_Content':'" + Message_Content + "','Message_datetime':'" + Message_datetime + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                        WorkersInfo();
                        $("#ForumsMessagesTable").empty();
                        MessagesForums();
                    }
                });
            }

            function Search4Last() {
                var Message_ID;
                var MessageDepartment;
                var Message_datetime = $('#textDate').text();
                var Message_datetime2 = "";
                var Message_Content = $("#AreaTexts4update").val();
                var counter = 0;
                var min = "";
                var j = 0;
                flag = false;
                var Topic = "";
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (Message_datetime == WorkersObj[i].Message_datetime && WorkersObj[i].Message_Content == Message_Content && WorkersObj[i].Topic == false) {
                                Topic = WorkersObj[i].Message_Topic;
                                Message_ID = WorkersObj[i].Message_ID;
                                break;
                            }
                        }

                        for (j = 0; j < WorkersObj[i].Message_datetime.length; j++) {
                            if (Message_datetime[j] >= 0 && Message_datetime[j] <= 9) {
                                Message_datetime2 += Message_datetime[j];
                            }
                        }

                        for (i = 0; i < WorkersObj.length; i++) {
                            if (Topic == WorkersObj[i].Message_Topic && Message_ID == WorkersObj[i].Message_ID) {
                                MessageDepartment = WorkersObj[i].Department;
                                for (j = 0; j < WorkersObj[i].Message_datetime.length; j++) {
                                    if (WorkersObj[i].Message_datetime[j] >= 0 && WorkersObj[i].Message_datetime[j] <= 9) {
                                        min += WorkersObj[i].Message_datetime[j];
                                    }
                                }
                                if (Message_datetime2 < min) {
                                    flag = true;
                                    break;
                                }
                            }
                            min = "";
                        }
                        if (flag == true) {
                            return;
                        }
                        if (flag == false) {
                            DeleteDepartmentsMassaging(Message_datetime, MessageDepartment);
                        }

                    }
                });
            }


            function Search4LasTopic() {
                var Message_ID;
                var MessageDepartment;
                var Message_datetime = $('#textDate2').text();
                var Message_datetime2 = "";
                var Message_Content = $("#AreaTexts4update2").val();
                var DepartmentsMessagesID = $("#DepartmentsMessagesID").val();
                
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",
                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]

                        for (var i = 0; i < WorkersObj.length; i++)
                        {
                            if(WorkersObj[i].Departments_MessagesID==DepartmentsMessagesID)
                            {
                                MessageDepartment = WorkersObj[i].Department;
                                break;
                            }
                        }
                        debugger;
                        DeleteDepartmentsMassaging(Message_datetime, MessageDepartment, DepartmentsMessagesID);
            }

                });
            }

            function DeleteDepartmentsMassaging(Message_datetime, MessageDepartment, DepartmentsMessagesID) {

                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/DeleteDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",
                    data: "{'ID':'" + DepartmentsMessagesID + "','Message_datetime':'" + Message_datetime + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                        CountMessages(MessageDepartment);
                        TrueNewestPost();
                        //OrdertmentsMassaging(DepartmentsMessagesID);
                    }
                });
            }


            function MessagsCleaning() {
                //TrueNewestPost();
                $("#ForumsMessagesTable").empty();
            }



            function ReportCleaning() {
                $("#WorkersSelect4").empty();
            }

            //מדווח על הודעה
            function LoadtextWorker() {
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var date = $('input[name="ClassMessage"]:checked').val();
                        var TempID;
                        var content = "";
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (date == WorkersObj[i].Message_datetime) {
                                content = WorkersObj[i].Message_Content;
                                TempID = WorkersObj[i].ID;
                                break;
                            }
                        }
                        ReporText(TempID, content, date);
                    }
                });
            }


            function ReporText(TempID, content, date) {
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/ReporText",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + TempID + "','Message_Content':'" + content + "','Message_datetime':'" + date + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },

                    success: function (data) {
                    }
                });
            }

            //עדכון נוכחות
            function WorkStatus() {
                myFunction();
                TimeEvents();
                GetDestination();
                getLocation2();
                var str = "";
                str = Time[0];
                $("#WorkStatusTimes1").html(str);
                str = Time[1]
                $("#WorkStatusTimes2").html(str);
            }



            ///עבור לדף יצירת קשר עם מנהל
            function ConnectManger() {
                $.mobile.changePage('#ConnectManger',{ 'transition': 'none' });;
                CleanManagers();
                GetManagers();
            }

            /////////////////////////////////////////////////////////////////////////////פונקציות לדפי מנהל///////////////
            function wireEventsFirstPageManger() {
                var MangerMail = $('#fpInputNameId').val();
                var MangerName = "";
                var PassWord = $('#fpInputName3').val();
                var mail = ' ';
                var pass = ' ';
                var pass2 = ' ';
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetManagers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'MangerName':'" + MangerName + "','PassWord':'" + PassWord + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {
                            pass = WorkersObj[i].PassWord;
                            mail = WorkersObj[i].MangerMail;
                            ID = WorkersObj[i].ID;
                            MangerOfficalID = WorkersObj[i].ID;
                            //Department = WorkersObj[i].MangerOffice[i];
                            if (WorkersObj[i].PassWord == PassWord && WorkersObj[i].MangerMail == MangerMail && WorkersObj[i].Active == true) {
                                TimeEventsManger();
                                UpdateDepartmentsWorkers();
                                $.mobile.changePage('#IndexPageManger',{ 'transition': 'none' });;
                                return;

                            }

                        }
                        $('#LoginError').html("חיבור נכשל,אנה בדוק פרטים");
                    }

                });
            }

            //בודק עם מיקום תקין
            function codeAddress() {

                //In this case it gets the address from an element on the page, but obviously you  could just pass it to the method instead
                var geocoder = new google.maps.Geocoder();
                flag = true;
                var address = $('#Destination').val();
                var country = $('#Country').val();
                var Distance = $('#Distance').val();
                if (country == "" || Distance == "" || address == "")
                {
                    $("#UPDistanceStatus").html("שגיאה בנתונים");
                    return;
                }

                address += "," + country;
                geocoder.geocode({ 'address': address }, function (results, status) {
                    if (status == google.maps.GeocoderStatus.OK) {


                        Latitude = results[0].geometry.location.lat();
                        Longitude = results[0].geometry.location.lng();

                        $.mobile.changePage('#LocationConfirm', { 'transition': 'slide' });;
                        CleanMap();
                        //UpdateDistence();
                    }
                    $("#UPDistanceStatus").html("שגיאה בנתונים");
                    return;
                });
                return;
            }
            

            function LoadLocation()
            {
                initialize();
      

            }
            function initialize() {

                var myCenter = new google.maps.LatLng(Latitude, Longitude);

                var mapProp = {
                    center: myCenter,
                    zoom: 5,
                    mapTypeId: google.maps.MapTypeId.ROADMAP

                };
                var map = new google.maps.Map(document.getElementById("googleMap"), mapProp);

                var marker = new google.maps.Marker({
                    position: myCenter,
                    title:'Click to zoom'
                });

                marker.setMap(map);

                // Zoom to 9 when clicking on marker
                google.maps.event.addListener(marker,'click',function() {
                    map.setZoom(9);
                    map.setCenter(marker.getPosition());
                });
            }
            

            function CleanMap()
            {
                $("#googleMap").empty();

    
            }


            function codeAddress2(WorkerLocation) {
                //In this case it gets the address from an element on the page, but obviously you  could just pass it to the method instead
                var geocoder = new google.maps.Geocoder();
                var address = WorkerLocation;
                geocoder.geocode({ 'address': address }, function (results, status) {
                    if (status == google.maps.GeocoderStatus.OK) {
                        flag = false;
                        return;
                    }
                    $("#UPDistanceTimes1").html(str);
                    flag = "הוספת עובד נכשלה,בדוק פרטים"
                });
            }
            





            function MainDepartments() {
                // // location.reload();
                $.mobile.changePage('#Departments',{ 'transition': 'none' });;
                $.mobile.changePage('#Departments',{ 'transition': 'none' });;
                TimeEventsManger();
            }

            function TimeEventsManger() {
                Time = $('#GetTimeAndDate').val();
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetTimeAndDate",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'Time':'" + Time + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                    },
                    success: function (data) {

                        var str = "";
                        Time = data.d;
                        str = Time[0];
                        GlobalDate = str;
                        $("#TimesManger1").html(str);
                        $("#WorkersStatusTimes1").html(str);
                        $("#AddWorkersTimes1").html(str);
                        $("#ReportMangerTimes1").html(str);
                        $("#UPDistanceTimes1").html(str);
                        $("#VacationsMangerTimes1").html(str);
                        $("#DepartmentsManagementTimes1").html(str);
                        $("#VacationsHistoryTimes1").html(str);
                        $("#VecationsMangerTimes1").html(str);
                        $("#DepartmentsTimes1").html(str);
                        $("#UpdateWorkersTimes1").html(str);
                        $("#ChetTimes1").html(str);
                        $("#LocationConfirmTimes1").html(str);
                        $("#WorkersDepartmentsTimes1").html(str);
                        str = Time[1]
                        $("#TimesManger2").html(str);
                        $("#WorkersStatusTimes2").html(str);
                        $("#AddWorkersTimes2").html(str);
                        $("#ReportMangerTimes2").html(str);
                        $("#UPDistanceTimes2").html(str);
                        $("#VacationsMangerTimes2").html(str);
                        $("#VacationsHistoryTimes2").html(str);
                        $("#VecationsMangerTimes2").html(str);
                        $("#DepartmentsTimes2").html(str);
                        $("#DepartmentsManagementTimes2").html(str);
                        $("#UpdateWorkersTimes2").html(str);
                        $("#ChetTimes2").html(str);
                        $("#LocationConfirmTimes2").html(str);
                        $("#WorkersDepartmentsTimes2").html(str);
                        GlobalTime = str;
                        // IDEvents();

                    }


                });
            }


            //מעדכן נתוני מיקום
            function UpdateDistence() {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/DeleteDistance",//קריאה לפונקציה שמוחקת
                    dataType: "json",
                    type: "POST",   //use only POST!

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                    },
                    success: function (data) {
                        UpdateDistence2();
                    }

                });
            }



            //מעדכן נתוני מיקום
            function UpdateDistence2() {
                         var WebServiceURL = "Enterence.asmx";
                var Destination = $('#Destination').val();
                var Distance = $('#Distance').val();
                var Country = $('#Country').val();
                if (Latitude < 0 || Longitude < 0) {
                    return;
                }
                $.ajax({

                    url: WebServiceURL + "/UpdateDistance",//קריאה לפונקציה שמעדכנת
                    dataType: "json",
                    type: "POST",   //use only POST!

                    data: "{'Latitude':'" + Latitude + "','Longitude':'" + Longitude + "','Destination':'" + Destination + "','Distance':'" + Distance + "','Country':'" + Country + "','Country':'" + Country + "','ID':'" + MangerOfficalID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },
                    success: function (data) {
                        BackToIndexManger();
                    }

                });
            }


            function GetDepartmentSelect() {
                var DepartmentSelect = "";
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                    },



                    success: function (data) {
                        var str = "";
                        var str2 = "";
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        str += "<option value=" + 0 + ">" + "בחר מחלקה" + "</option>"
                        for (var i = 0; i < WorkersObj.length; i++) {
                            DepartmentSelect = WorkersObj[i].Department
                            str += "<option value=" + WorkersObj[i].Department + ">" + WorkersObj[i].Department + "</option>";
                        }
                        $("#DepartmentSelect").html(str);
                        $("#DepartmentSelect2").html(str);
                        $.mobile.changePage('#ReportManger', { 'transition': 'none' });;
                        $("#ReportYearsManger").val(" ");
                        $("#ReportTablesStatusing").html(" ");

                    }

                });
            }



            function GetDepartmentSelects() {
                var DepartmentSelect = "";
                var DepartmentID = 0;
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        DepartmentSelect += "<option value=" + 0 + ">" + "בחר מחלקה" + "</option>"

                        for (var i = 0; i < WorkersObj.length; i++) {
                            DepartmentSelect += "<option value=" + WorkersObj[i].DepartmentID + ">" + WorkersObj[i].Department + "</option><br><br>"
                        }

                        $("#WorkerDepartments").html(DepartmentSelect);

                        $("#WorkerDepartmentsUpdate").html(DepartmentSelect);
                        //ReportEvents();

                    }

                });
            }


            function GetDepartmentSelects2() {
                var DepartmentSelect = "";
                var DepartmentID = 0;
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        DepartmentSelect += "<option value=" + 0 + ">" + "בחר מחלקה" + "</option>"

                        for (var i = 0; i < WorkersObj.length; i++) {
                            DepartmentSelect += "<option value=" + WorkersObj[i].DepartmentID + ">" + WorkersObj[i].Department + "</option><br><br>"
                        }

                        $("#WorkerDepartmentsUpdate").html(DepartmentSelect);
                        //ReportEvents();

                    }

                });
            }


            function GetDepartmentSelects() {
                var DepartmentSelect = "";
                var DepartmentID = 0;
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        DepartmentSelect += "<option value=" + 0 + ">" + "בחר מחלקה" + "</option>"

                        for (var i = 0; i < WorkersObj.length; i++) {
                            DepartmentSelect += "<option value=" + WorkersObj[i].DepartmentID + ">" + WorkersObj[i].Department + "</option><br><br>"
                        }

                        $("#WorkerDepartments").html(DepartmentSelect);
                        //ReportEvents();

                    }

                });
            }


            function GetDepartmentToAdd() {
                var DepartmentSelect = "";
                var DepartmentID = $("#WorkerDepartments").val();

                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + DepartmentID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {

                            if (DepartmentID == WorkersObj[i].DepartmentID) {
                                DepartmentSelect = WorkersObj[i].Department;
                                break;

                            }
                        }
                        AddWorker(DepartmentID, DepartmentSelect);
                        return;
                    }

                });
            }



            function FlagupdateWorker() {
                var flagupdate = true;
                GetDepartmentToUdate(flagupdate)
            }

            function FlagToShowWorker() {
                var flagupdate = false;;
                GetDepartmentToUdate(flagupdate)
            }


            function GetDepartmentToUdate(flagupdate) {
                var DepartmentSelect = "";
                var DepartmentID = $("#WorkerDepartmentsUpdate").val();

                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + DepartmentID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {

                            if (DepartmentID == WorkersObj[i].DepartmentID) {
                                DepartmentSelect = WorkersObj[i].Department;
                                break;

                            }
                        }
                        if (flagupdate == false) {
                            $("#WorkerDepartment2").html(DepartmentSelect);
                        }
                        if (flagupdate == true) {
                            UpdateWorker(DepartmentID, DepartmentSelect);
                        }
                        return;
                    }

                });
            }



            //מייצר טבלת שנתית דינמאית
            function ReportEventsManger() {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/GetWorksDate",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {

                        if ($("#ReportYears").val() != 0) {
                            ReportEvents2Manger();
                        }
                        var tempyears = $("#ReportYears");
                        var tempyears2 = 0;
                        ID = $("#WorkersSelect").val();
                        var str = "";
                        var str2 = "";
                        var StartHour = 0;
                        var EndHour = 0;
                        var sum = 0;
                        var MonthTemp;
                        var tempday = 0;
                        var sumdays = 0;
                        var sumlatedays = 0;
                        var flaglate = false;
                        var flagfound = false;
                        flag = false;
                        var counter = 0;
                        var tableid = 1;
                        var tableid2 = "";
                        //$("#Yearstring");
                        var WorkerName1 = $("#WorkersSelect");
                        var Month = $("#Moneths");
                        WorkersDateObj = JSON.parse(data.d); //or data["d"]
                        str += "<table id=" + tableid + "<tr>";

                        for (var i = 0; i < daysinmonth; i++) {
                            if (counter == 7) {
                                str += "</tr> <tr>";
                                counter = 0;
                            }

                            for (var j = 0; j < WorkersDateObj.length; j++) {
                                if (ID == WorkersDateObj[j].ID) {

                                    MonthTemp = (WorkersDateObj[j].EnterDate[3] + WorkersDateObj[j].EnterDate[4]);
                                    tempday = (WorkersDateObj[j].EnterDate[0] + WorkersDateObj[j].EnterDate[1]);
                                    tempyears2 = (WorkersDateObj[j].EnterDate[6] + WorkersDateObj[j].EnterDate[7] + WorkersDateObj[j].EnterDate[8] + WorkersDateObj[j].EnterDate[9]);

                                    if (tempday == tableid && Month.val() == MonthTemp && tempyears.val() == tempyears2) {
                                        if (WorkersDateObj[j].Arrived_Late == true) {
                                            sumlatedays++;
                                        }

                                        if (WorksDateArray[j].EndHour == null) {
                                            WorksDateArray[j].EndHour = "";
                                        }
                                        if (flagfound == false) {
                                            flagfound = true;
                                            str += "<td> " + tableid + "<br> ";
                                        }
                                        sum = sum + WorkersDateObj[j].Total_Hours;
                                        sumdays = sumdays + 1;
                                        str += "" + "" + "תאריך: " + WorkersDateObj[j].EnterDate + "<br>" + "<br>" + "שעת התחלה: " + WorkersDateObj[j].StartHour + "<br>" + "<br>" + "שעת סיום: " + WorkersDateObj[j].EndHour + "<br>" + "<br>";
                                        //WorkersDateObj[j].ID = -1;
                                        flag = true;
                                        //break;
                                    }
                                }
                            }
                            if (flag == false) {
                                str += "<td> " + tableid;
                            }
                            flagfound = false;
                            str += "</td>";
                            counter++;
                            flag = false
                            tableid++;
                            tempday = 0;
                            MonthTemp = 0;

                        }


                        str += "</tr>" + "</table>";

                        $("#StartHour").html(str);
                        //$("#FinishHour").html(str2);
                        $("#SumHours").html(sum);
                        debugger;
                        $.mobile.changePage('#Report',{ 'transition': 'none' });;
                    }

                });
            }

            //שולף מספר ימים בשנה
            function ReportEvents2Manger() {
                var MonthTemp = $("#MonthsManger").val();
                Month = $("#MonthsManger").val();
                $("#ReportFailedOrNot").html(" ");
                var yeartemp = "";
                var yeartemp = $("#ReportYearsManger").val();
                var d = new Date();
                var n = d.getFullYear();
                if (yeartemp == "" || yeartemp < n)
                {
                    $("#ReportTablesStatusing").html("שגיאה בהכנסת שנה,נא הכנס שנה תקינה");
                }
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/GetDaysInMonth",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'year':'" + yeartemp + "','month':'" + MonthTemp + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        $("#ReportTablesStatusing").html("שגיאה בהכנסת שנה,נא הכנס שנה תקינה");
                        debugger;
                    },
                    success: function (data) {
                        var str = "";
                        str = data.d;
                        Daysarray = str;
                        daysinmonth = str[0];
                        return;
                    }

                });
            }


            //טבלת חופשות שנתית
            function VacationsReportEventsTableManger() {
                Month = $("#MonthsManger").val();
                var MonthsArry = {};
                MonthsArry[1] = "ינואר";
                MonthsArry[2] = "פבואר";
                MonthsArry[3] = "מרץ";
                MonthsArry[4] = "אפריל";
                MonthsArry[5] = "מאי";
                MonthsArry[6] = "יוני";
                MonthsArry[7] = "יולי";
                MonthsArry[8] = "אוגוסט";
                MonthsArry[9] = "ספטמבר";
                MonthsArry[10] = "אוקטובר";
                MonthsArry[11] = "נובמבר";
                MonthsArry[12] = "דצמבר";
                var TempID = $("#WorkersSelectManger").val();
                $("#ReportTables").empty();
                if (Month == "00") {
                    return;
                }

                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/GetPresenceHistory",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + TempID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function () {
                        debugger;
                    },
                    success: function (data) {
                        VacationsArray = JSON.parse(data.d); //or data["d"]
                    }
                });


                $.ajax({
                    url: WebServiceURL + "/GetWorksDate",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + TempID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function () {
                        debugger;
                    },
                    success: function (data) {
                        WorksDateArray = JSON.parse(data.d); //or data["d"]

                        var flagsum = false;
                        if (flag == "sumReport") {
                            flagsum = true;
                        }

                        if (flag == "sumDaily") {
                            flagsum = "sumDaily";
                        }


                        flag = false;
                        var flagvacation = false;
                        var counter = 0;
                        var flagDateID = false;
                        var tableid = 1;
                        var tableid2 = "";
                        var tempyears = $("#ReportYearsManger");
                        var tempyears2 = 0;
                        var tempyears3 = 0;
                        var str = "";
                        var str2 = "";
                        var WorkerName = "";
                        var sumdailyhours;
                        var sumhours = 0;
                        var sum = 0;
                        var k = 0;
                        var d = 1;
                        var j = 0;
                        var tempday = 0;
                        var tempdayE = 0;
                        var sumdays = 0;
                        var sumlatedays = 0;
                        var flaglate = false;
                        var MonthTemp = 0;
                        var MonthTempE = 0;
                        var tempdates = 0;
                        var tempdatee = 0;
                        var tempdatee2 = 0;
                        var VacationDays = 0;
                        var sumdailyhours = 0;
                        var flagfound = false;
                        var MonthTemp;
                        var hours = 0;
                        var minutes = 0;
                        var seconds = 0;
                        for (j = 0; j < namescounter; j = j + 10) {
                            if (TempID == names[j]) {
                                WorkerName = names[j + 1];
                                break;
                            }
                        }


                        if (daysinmonth > 0) {
                            str += "<table id=" + tableid + "<tr>";
                            for (var i = 0; i < daysinmonth; i++) {
                                if (counter == 7) {
                                    str += "</tr> <tr>";
                                    counter = 0;
                                }
                                for (j = 0; j < WorksDateArray.length; j++) {
                                    if (flagDateID == true) {

                                        break;
                                    }
                                    if (TempID == WorksDateArray[j].ID) {
                                        MonthTemp = (WorksDateArray[j].EnterDate[3] + WorksDateArray[j].EnterDate[4]);
                                        tempday = (WorksDateArray[j].EnterDate[0] + WorksDateArray[j].EnterDate[1]);
                                        tempyears2 = (WorksDateArray[j].EnterDate[6] + WorksDateArray[j].EnterDate[7] + WorksDateArray[j].EnterDate[8] + WorksDateArray[j].EnterDate[9]);
                                        if (tempday == tableid && Month == MonthTemp && tempyears.val() == tempyears2) {
                                            if (WorksDateArray[j].Arrived_Late == true && flaglate == false) {
                                                flaglate = true;
                                                sumlatedays++;
                                            }
                                            if (WorksDateArray[j].EndHour == null) {
                                                WorksDateArray[j].EndHour = "";
                                            }

                                            hours = minutes = seconds = 0;

                                            sumdailyhours = WorksDateArray[j].Total_Hours * 3600;

                                            while (sumdailyhours >= 3600) {
                                                hours++;
                                                sumdailyhours -= 3600;
                                            }

                                            while (sumdailyhours >= 60) {
                                                minutes++;
                                                sumdailyhours -= 60;
                                            }

                                            seconds = parseInt(sumdailyhours);

                                            if (hours < 10) { hours = "0" + hours; }
                                            if (minutes < 10) { minutes = "0" + minutes; }
                                            if (seconds < 10) { seconds = "0" + seconds; }

                                            sumdailyhours = +hours + ":" + minutes + ":" + seconds;

                                            if (flagfound == false) {
                                                flagfound = true;
                                                str += "<td> " + tableid + "<br>";
                                            }


                                            if (WorksDateArray[j].Arrived_Late == true) {
                                                WorksDateArray[j].Arrived_Late = "כן";
                                            }

                                            if (WorksDateArray[j].Arrived_Late == null || WorksDateArray[j].Arrived_Late == false) {
                                                WorksDateArray[j].Arrived_Late = "לא";
                                            }


                                            str += "" + "" + "תאריך: " + WorksDateArray[j].EnterDate + "<br>" + Daysarray[d] + "<br>" + "" + "שעת התחלה: " + WorksDateArray[j].StartHour + "" + "<br>" + "שעת סיום: " + WorksDateArray[j].EndHour + "<br>" + "<br>";
                                            str2 += "<div data-role=" + "collapsible" + "><h3>סיכום עבודה :" + WorksDateArray[j].EnterDate + "</h3> <p>עובד:" + WorkerName + "</p><br><br><br><br> שעת התחלה: " + WorksDateArray[j].StartHour + "" + "<br><br>" + "שעת סיום: " + WorksDateArray[j].EndHour + "<br><br>" + "מספר שעות" + sumdailyhours + "</p><br><br></div><br><br>";
                                            WorksDateArray[j].ID = -1;
                                            flag = true;
                                            //if (counter == 7) {
                                            //    str += "</tr> <tr>";
                                            //    counter = 0;
                                            //}
                                            //break;

                                        }
                                    }
                                }
                                flagfound = false;
                                for (j = 0; j < VacationsArray.length; j++) {
                                    if (flagDateID == true) {
                                        break;
                                    }
                                    MonthTempE = (VacationsArray[j].End_Date[5] + VacationsArray[j].End_Date[6]);
                                    tempdayE = (VacationsArray[j].End_Date[8] + VacationsArray[j].End_Date[9]);
                                    tempyears3 = (VacationsArray[j].End_Date[0] + VacationsArray[j].End_Date[1] + VacationsArray[j].End_Date[2] + VacationsArray[j].End_Date[3]);

                                    MonthTemp = (VacationsArray[j].Stat_Date[5] + VacationsArray[j].Stat_Date[6]);
                                    tempday = (VacationsArray[j].Stat_Date[8] + VacationsArray[j].Stat_Date[9]);
                                    tempyears2 = (VacationsArray[j].Stat_Date[0] + VacationsArray[j].Stat_Date[1] + VacationsArray[j].Stat_Date[2] + VacationsArray[j].Stat_Date[3]);
                                    tempdates = (VacationsArray[j].Stat_Date[8] + VacationsArray[j].Stat_Date[9] + VacationsArray[j].Stat_Date[5] + VacationsArray[j].Stat_Date[6] + VacationsArray[j].Stat_Date[0] + VacationsArray[j].Stat_Date[1] + VacationsArray[j].Stat_Date[2] + VacationsArray[j].Stat_Date[3]);
                                    tempdatee = (VacationsArray[j].End_Date[8] + VacationsArray[j].End_Date[9] + VacationsArray[j].End_Date[5] + VacationsArray[j].End_Date[6] + VacationsArray[j].End_Date[0] + VacationsArray[j].End_Date[1] + VacationsArray[j].End_Date[2] + VacationsArray[j].End_Date[3]);
                                    if (TempID == VacationsArray[j].ID && Month == MonthTempE && MonthTemp < MonthTempE) {
                                        tempdates = "0";
                                        tempdates += (1 + VacationsArray[j].End_Date[5] + VacationsArray[j].End_Date[6] + VacationsArray[j].End_Date[0] + VacationsArray[j].End_Date[1] + VacationsArray[j].End_Date[2] + VacationsArray[j].End_Date[3]);
                                    }


                                    if ((TempID == VacationsArray[j].ID && Month == MonthTemp && tempyears.val() == tempyears2 && tempday == tableid && VacationsArray[j].Confirmed_By_Worker == true) || (TempID == VacationsArray[j].ID && Month == MonthTempE && tempyears.val() == tempyears3 && tempdayE > tableid && MonthTempE != MonthTemp && VacationsArray[j].Confirmed_By_Worker == true)) {
                                        if (MonthTemp != MonthTempE) {
                                            tempdatee2 = tempdatee;
                                            tempdatee = 99999999;
                                        }
                                        if (MonthTemp != Month) {
                                            tempdatee = tempdatee2;

                                        }

                                        flagDateID = true;
                                        break;
                                    }
                                }

                                if (flagDateID == true && tempdates < tempdatee) {
                                    if (counter == 7) {
                                        str += "</tr> <tr>";
                                        counter = 0;
                                    }
                                    VacationDays++;
                                    str += "<td> " + tableid + "<br>";
                                    str += "" + "" + Daysarray[d] + "" + "<h3>" + "חופשה" + "</h3>" + "" + "";
                                    flag = true;
                                    tempdates = parseInt(tempdates) + 1000000;

                                }

                                if (parseInt(tempdates) == parseInt(tempdatee)) {
                                    flagDateID = false;
                                }


                                if (flag == false) {
                                    str += "<td> " + tableid + "<br>" + Daysarray[d];
                                }
                                str += "</td>";
                                counter++;
                                flag = false;
                                tableid++;
                                tempday = 0;
                                MonthTemp = 0;
                                d++;
                                flaglate = false;
                            }


                            hours = minutes = seconds = 0;


                            sum = sum * 3600;
                            while (sum >= 3600) {
                                hours++;
                                sum -= 3600;
                            }

                            while (sum >= 60) {
                                minutes++;
                                sum -= 60;
                            }

                            seconds = parseInt(sum);
                            if (hours < 10) { hours = "0" + hours; }
                            if (minutes < 10) { minutes = "0" + minutes; }
                            if (seconds < 10) { seconds = "0" + seconds; }


                            sum = hours + ":" + minutes + ":" + seconds;

                            str += "</tr>" + "</table>";

                            if (flagsum == true) {
                                $("#ReportTables").empty();



                                str = "<div data-role=" + "collapsible" + "><h3>סיכום עבודה לחודש נבחר</h3> <p><br>מספר ימי עבודה:<br>" + sumdays + "</p><br><br><br><p><br><br>מספר שעות עבודה:" + sum + "</p><br><br><br>  <p>מספר איחרים:" + sumlatedays + "</p><br><br><br>  <p>מספר ימי חופשה:<br>" + VacationDays + "<br></p></div>";
                                $("#ReportTables").append(str).collapsibleset('refresh');
                            }

                            if (flagsum == "sumDaily") {
                                $("#ReportTables").empty();
                                str2 += "<div data-role=" + "collapsible" + "><h3>סיכום עבודה לחודש :" + MonthsArry[parseInt(Month)] + "</h3> <p>עובד:" + WorkerName + "</p><br><br> מספר ימי עבודה: " + sumdays + "<br><br>" + "מספר שעות: " + sum + "<br><br>" +" <p>מספר איחרים:" + sumlatedays + "</p><br><br><br>"+"מספר ימי חופשה:" + VacationDays + "</p><br><br></div><br><br>";
                                $("#ReportTables").append(str2).collapsibleset('refresh');
                            }


                            debugger;
                            if (flagsum == false) {
                                $("#ReportTables").append(str).collapsibleset('refresh');
                            }
                            flagsum = false;
                            flag = null;
                        }
                    }

                });
            }



            function ReportsumsManger() {
                flag = "sumReport";
                VacationsReportEventsTableManger();
                return;
            }


            function ReportDailyManger() {
                NamesTable3Manger();
                NamesTable3Manger();
                flag = "sumDaily";
                VacationsReportEventsTableManger();
                return;
            }


            function DistencePageChange() {
                $("#UPDistanceStatus").html("");
                $('#Destination').val("");
                $('#Distance').val("");
                $('#Country').val("");
                $.mobile.changePage('#UPDistance',{ 'transition': 'none' });;
            }

            function BackToman() {
                window.history.back();
                //$.mobile.changePage('#firstpage',{ 'transition': 'none' });;
            }


            //חזור לדף הראשי
            function BackToIndexManger() {
                $.mobile.changePage('#IndexPageManger',{ 'transition': 'none' });;
                $.mobile.changePage('#IndexPageManger',{ 'transition': 'none' });;
                TimeEventsManger();

            }


            //דף עדכון עובדים


            //דף הוסף עובד
            function AddWorkers() {
                //// location.reload();
                $('#WorkerEnterStatus').empty();
                $.mobile.changePage('#AddWorkers',{ 'transition': 'flip' });;
                $.mobile.changePage('#AddWorkers', { 'transition': 'flip' });;
                $("#WorkerMails").val("");
                $("#WorkerName").val("");
                $("#PassWord").val("");
                $("#WorkerLocation").val("");
                $("#WorkerPhone").val("");
                $("#WorkerDistance").val("");
                $("#WorkerAddress").val("");
                TimeEventsManger();
                GetDepartmentSelects();
            }

            //דף עדכן עובד
            function UpdateWorkers() {
                //// location.reload();

                $.mobile.changePage('#UpdateWorkers', { 'transition': 'flip' });;
                $.mobile.changePage('#UpdateWorkers', { 'transition': 'flip' });;
                $('#StartWorkStatus').html("");
                $('#WorkStatusAtive').html("");
                $('#WorkStatusManger').html("");
                $('#WorkerUpdatedStatus').html("");
                $('#IfUpdateWorked').html("");
                
                $('#ID2').val("");
                $('#WorkerName2').val("");
                $('#WorkerMail').val("");
                $('#PassWord2').val("");
                $('#WorkerDepartmentsUpdate').val("");
                $('#WorkerLocation2').val("");
                $('#WorkerPhone2').val("");
                $('#WorkStatusManger').val("");
                $('#IfUpdateWorked').val("");
                $('#StartWorkStatus').val("");
                $('#WorkerAddress2').val("");
                $('#WorkerDepartment2').empty();
                $('#WorkerDistance2').val("");
                $('#EndWorkStatus').val("");
                GetDepartmentSelect();
                GetDepartmentSelects2();
            }




            function setflag0() {
                flag = false;
                ID = $("#WorkersSelect2").val();
                ActivityStatus();
            }

            function setflag1() {
                flag = true;
                ID = $("#WorkersSelect2").val();
                ActivityStatus();
            }



            function flagpermission1(tempID, reason, Stat_Date) {
                flag = true;
                GetVacationsHistoryArrayID(tempID, reason, Stat_Date);
            }


            function flagpermission0(tempID, reason, Stat_Date) {
                flag = false;
                GetVacationsHistoryArrayID(tempID, reason, Stat_Date);
            }


            function ActivityStatus() {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/ActivityStatus",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "','flag':'" + flag + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {

                    },

                    success: function (data) {
                        GetWorkerByID();
                    }
                });
                return;
            }

            ///בחירת שם
            function NamesTable2() {
                var Workerselect2 = "";
                var WorkerName = "";
                var PassWord = "";
                $("#WorkersSelectManger").empty();
                var DepartmentSelect = $("#DepartmentSelect").val();
                var DepartmentSelect2 = $("#DepartmentSelect2").val();
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetWorkers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'WorkerName':'" + WorkerName + "','PassWord':'" + PassWord + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {

                    },

                    success: function (data) {
                        var WorkersNames = "";
                        var Nametemp = "";
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        WorkersNames += "<option value=" + 0 + ">" + "בחר עובד" + "</option>"
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (DepartmentSelect == WorkersObj[i].WorkerDepartment || DepartmentSelect2 == WorkersObj[i].WorkerDepartment) {
                                Nametemp = WorkersObj[i].WorkerName;
                                WorkersNames += "<option value=" + WorkersObj[i].ID + ">" + Nametemp + "</option>"
                            }
                        }
                        Workerselect = WorkersNames;
                        $("#WorkersSelectManger").html(WorkersNames);
                        $("#WorkersSelect2").html(WorkersNames);

                    }
                });
            }




            ///מערך שמות
            function NamesTable3() {
                var Workerselect2 = "";
                var WorkerName = "";
                var PassWord = "";
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetWorkers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'WorkerName':'" + WorkerName + "','PassWord':'" + PassWord + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {

                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var j = 0;
                        for (var i = 0; i < WorkersObj.length; i++) {
                            names[j] = WorkersObj[i].ID;
                            names[j + 1] = WorkersObj[i].WorkerName;
                            names[j + 2] = WorkersObj[i].WorkerMail;
                            names[j + 3] = WorkersObj[i].WorkerDepartment;
                            names[j + 4] = WorkersObj[i].WorkerLocation;
                            names[j + 5] = WorkersObj[i].WorkerPhone;
                            names[j + 6] = WorkersObj[i].WorkerDistance;
                            names[j + 7] = WorkersObj[i].WorkerAddress;
                            names[j + 8] = "לא פעיל";
                            names[j + 9] = WorkersObj[i].DepartmentID;
                            if (WorkersObj[i].Active == true) {
                                names[j + 8] = "פעיל";
                            }
                            j = j + 10;
                            namescounter = namescounter + 10;
                        }



                    }
                });
            }



            ////////************************************************************פונקציות חופשות***********************************************************************
            ///טבלת חופשות
            function VacationsArray() {
                //$("#WorkersSelect3").empty();
                var Stat_Date = "";
                var End_Date = "";
                var Workerselect2 = "";
                var WorkerName = "";
                var PassWord = "";
                flag = false;
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetWorkerVacations",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "','Stat_Date':'" + Stat_Date + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                    },

                    success: function (data) {

                        WorkersVacationDetails = JSON.parse(data.d);
                    }

                });
                $.ajax({

                    url: WebServiceURL + "/GetWorkers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        return;
                    },

                    success: function (data) {
                        $("#WorkersSelect3").empty();
                        $("#WorkersSelect3").val();
                        var WorkersNames = "";
                        var Nametemp = "";
                        var content = "לא התקבלו בקשות";
                        var nextId = 1;
                        var nextId2 = 100;
                        WorkersObj = JSON.parse(data.d); //or data["d"
                        for (var i = 0; i < WorkersVacationDetails.length; i++) {
                            for (var j = 0; j < WorkersObj.length; j++) {
                                if (WorkersVacationDetails[i].ID == WorkersObj[j].ID && WorkersVacationDetails[i].Referenced != true) {
                                    flag = true;
                                    if (content == "לא התקבלו בקשות") {
                                        content = "";
                                    }
                                    content += "<div data-role='collapsible' id='set" + nextId + "'><h3>" + WorkersObj[j].WorkerName + "<br>" + WorkersObj[j].WorkerDepartment + "</h3><p> " +
                                      "תאריך התחלה: " + WorkersVacationDetails[i].Stat_Date + "<br>" + "<br>" +
                                      "תאריך סיום: " + WorkersVacationDetails[i].End_Date + "<br>" + "<br>" +
                                      "מספר ימי חופשה  " + WorkersVacationDetails[i].Vacation_Days + "<br>" + "<br>" +
                                      "ימי מחלה: " + WorkersVacationDetails[i].Sick_Days + "<br>" + "<br>" +
                                       "מספר שעות כולל: " + WorkersVacationDetails[i].Total_Hours + "<br>" + "<br>" +
                                     "<button type=button id=" + WorkersVacationDetails[i].ID + " onclick=flagpermission1(" + WorkersVacationDetails[i].ID + "," + "document.getElementById(" + nextId2 + ").value" + ",'" + WorkersVacationDetails[i].Stat_Date + "');>" + "אשר בקשת חופשה " + "</button> " +
                                     "<button type=button onclick=flagpermission0(" + WorkersVacationDetails[i].ID + "," + "document.getElementById(" + nextId2 + ").value" + ",'" + WorkersVacationDetails[i].Stat_Date + "');>" + "דחה בקשת חופשה " + "</button>" + "<br>" + "<br>" +
                                     " <input type=text  id=" + nextId2 + " placeholder=" + "סיבה" + " />" + "<br>" + "<br>" +
                                      "</p></div><br>";
                                    // btn.setAttribute('onclick', functions[i]);
                                    //$("#WorkerAddress").val();

                                }
                                nextId = nextId + 1;
                                nextId2 = nextId2 + 1;

                            }
                        }
                        $.mobile.changePage('#VecationsManger',{ 'transition': 'none' });;
                        $("#WorkersSelect3").append(content).collapsibleset('refresh');
                    }
                });
            }




            ///מכניס להיסטוריה של החופשות

            function GetVacationsHistoryArrayID(tempID, reason, Stat_Date) {

                VacationsHistoryArray(tempID, reason, Stat_Date);

            }




            function VacationsHistoryArray(tempID, reason, Stat_Date) {

                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetWorkerVacations",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + tempID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        VacationDetails = JSON.parse(data.d); //or data["d"]
                        var End_Date = "";
                        var Vacation_Days = 0;
                        var Arrived_Late = 0;
                        var Sick_Days = 0;
                        var Total_Days = 0;
                        var Total_Hours = 0;
                        var Permitted = null;
                        var Recently_Referenced = null;
                        for (var i = 0; i < VacationDetails.length; i++) {
                            if (VacationDetails[i].ID == tempID && Stat_Date == VacationDetails[i].Stat_Date) {
                                End_Date = VacationDetails[i].End_Date
                                Vacation_Days = VacationDetails[i].Vacation_Days
                                Arrived_Late = VacationDetails[i].Arrived_Late
                                Sick_Days = VacationDetails[i].Sick_Days;
                                Total_Days = VacationDetails[i].Total_Days;
                                Total_Hours = VacationDetails[i].Total_Hours;
                                Permitted = flag;
                                break;
                            }
                        }
                        UpdateVacationStatus(tempID, Stat_Date, Permitted, reason);
                    }

                });
            }


            ///מעדכן אם בקשת העבודה אושרה או לא
            function UpdateVacationStatus(tempID, Stat_Date, Permitted, reason) {

              var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/UpdateVacationStatus",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + tempID + "','StarDate':'" + Stat_Date + "','flag':'" + Permitted + "','reason':'" + reason + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        VacationsArray();
                        debugger;
                    }
                });
            }


            ///שולף את פרטי החופשה של עובד ספציפי
            function VacationsReportEventsManger() {
                $("#ReportTables").empty();
                var MonthString = $("#MonthsManger").val();
                var VacationID = $("#WorkersSelectManger").val();
                Month = $("#MonthsManger").val();
                $("#ReportTables").empty();
                if (Month == "00") {
                    return;
                }
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/GetPresenceHistory",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + VacationID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var content = "אין פרטי חופשה לחודש ושנה נבחרים";
                        var flaging = false;
                        var Yearstring = $("#ReportYearsManger").val();
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (WorkersObj[i].ID == VacationID && MonthString[0] == WorkersObj[i].Stat_Date[5] && MonthString[1] == WorkersObj[i].Stat_Date[6] && Yearstring[0] == WorkersObj[i].Stat_Date[0] && Yearstring[1] == WorkersObj[i].Stat_Date[1] && Yearstring[2] == WorkersObj[i].Stat_Date[2] && Yearstring[3] == WorkersObj[i].Stat_Date[3]) {

                                if (flaging == false) {
                                    content = "";
                                    flaging = true;
                                    content += "<div data-role=main class=ui-content> <div data-role=collapsible><h1>" + "הצג פרטי חופשה לאותה שנה" + "</h1>";
                                }

                                if (WorkersObj[i].Vacation_Days == null)
                                {
                                    WorkersObj[i].Vacation_Days = 0;
                                }

                                if (WorkersObj[i].Sick_Days == null) {

                                    WorkersObj[i].Sick_Days = 0;
                                }
                                WorkersObj[i].Confirmed_By_Worker = "כן";
                                WorkersObj[i].Permitted = "כן";

                                content += "<p></p><div data-role=collapsible><h1>פרטי חופשה לתאריכים:" + WorkersObj[i].Stat_Date + "-" + WorkersObj[i].End_Date + "<br>" + "<br>" + " </h1><p>" + "<br>" + "ימי חופש: " + WorkersObj[i].Vacation_Days + "<br>" + "<br>" + "ימי מחלה: " + WorkersObj[i].Sick_Days + "<br>" + "<br>" + "מספר ימים כולל: " + WorkersObj[i].Total_Days + "<br>" + "<br>" + "מספר כולל של שעות: " + WorkersObj[i].Total_Hours + "<br>" + "<br>" + "אושר על ידי מנהל?: " + WorkersObj[i].Permitted + "<br>" + "<br>" + "סיבה: " + WorkersObj[i].Reason + "<br>" + "<br>" + "אושרר על ידי עובד?: " + WorkersObj[i].Confirmed_By_Worker + "<br>" + "<br>" + "</p></div>";
                            }
                        }

                        content += "</div></div>";

                        $("#ReportTables").append(content).collapsibleset('refresh');
                    }

                });
            }




            //טבלת היסטוריה של החפשות
            function GetPresenceHistory() {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetPresenceHistory",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                    },

                    success: function (data) {
                        VacationDetails = JSON.parse(data.d);
                    }
                });
                $.ajax({

                    url: WebServiceURL + "/GetWorkers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {

                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var nextId = 1;
                        var nextId2 = 1;
                        var content = "";
                        var flagnames = false;
                        content = "אין חופשות";
                        $.mobile.changePage('#VacationsHistory',{ 'transition': 'none' });;

                        for (var j = 0; j < WorkersObj.length; j++) {
                            for (var i = 0; i < VacationDetails.length; i++) {
                                if (WorkersObj[j].ID == VacationDetails[i].ID && VacationDetails[i].Referenced == true) {
                                    if (content == "אין חופשות") {
                                        content = "";
                                    }
                                    if (flagnames == false) {
                                        content += "<div data-role=main class=ui-content> <div data-role=collapsible><h1>" + WorkersObj[j].WorkerName + "<br>" + "<br>" + WorkersObj[j].WorkerDepartment + "</h1>";
                                        flagnames = true;
                                    }
                                    if (VacationDetails[i].Confirmed_By_Worker == null || VacationDetails[i].Confirmed_By_Worker == false) {
                                        VacationDetails[i].Confirmed_By_Worker = "עדיין לא";
                                    }
                                    if (VacationDetails[i].Confirmed_By_Worker == true) {
                                        VacationDetails[i].Confirmed_By_Worker = "כן";
                                    }


                                    if (VacationDetails[i].Permitted == true) {
                                        VacationDetails[i].Permitted = "כן";
                                    }

                                    if (VacationDetails[i].Permitted != true) {
                                        VacationDetails[i].Permitted = "לא";
                                    }

                                    if (VacationDetails[i].Arrived_Late == null) {
                                        VacationDetails[i].Arrived_Late = "אין";
                                    }



                                    content += "<p></p><div data-role=collapsible><h1> פרטי חופשה לתאריכים:" + VacationDetails[i].Stat_Date + "-" + VacationDetails[i].End_Date + "<br>" + "<br>" + " </h1><p>" + "<br>" + "ימי חופשה: " + VacationDetails[i].Vacation_Days + "<br>" + "<br>" + "איחורים: " + VacationDetails[i].Arrived_Late + "<br>" + "<br>" + "ימי מחלקה: " + VacationDetails[i].Sick_Days + "<br>" + "<br>" + "מספר ימים כולל: " + VacationDetails[i].Total_Days + "<br>" + "<br>" + "מספר שעות כולל: " + VacationDetails[i].Total_Hours + "<br>" + "<br>" + "האם אושר?: " + VacationDetails[i].Permitted + "<br>" + "<br>" + "סיבה: " + VacationDetails[i].Reason + "<br>" + "<br>" + "אושרר על ידי עובד: " + VacationDetails[i].Confirmed_By_Worker + "<br>" + "<br>" + "</p></div>";

                                }

                            }
                            if (flagnames == true) {
                                content += "</div></div>";
                                flagnames = false;
                            }

                            nextId = nextId + 1;
                            nextId2 = nextId2 + 1;
                        }

                        $("#WorkersSelect4Manger").empty();
                        $("#WorkersSelect4Manger").append(content).collapsibleset('refresh');
                    }
                });
            }




            function VacationsManger() {
                $.mobile.changePage('#VacationsManger',{ 'transition': 'none' });;
                TimeEventsManger();

            }












            ////////////////////////////////////////////////////////פונקציות עובדים///////////////////////////********************************************************************


            ///הוסף עובד
            function AddWorker(DepartmentID, DepartmentSelect) {
                var i = 0;
                flag = false;
                var flaga = false;
                var flagb = false;
                var Department = DepartmentSelect;
                //var WorkerID = $("#ID").val();
                var WorkerMail = $("#WorkerMails").val();
                var WorkerName2 = $("#WorkerName").val();
                var PassWord = $("#PassWord").val();
                var WorkerLocation = $("#WorkerLocation").val();
                var WorkerPhone = $("#WorkerPhone").val();
                var WorkerDistance = $("#WorkerDistance").val();
                var WorkerAddress = $("#WorkerAddress").val();
                var Active = $("#Active").val();
                flag = false;
                var flagDepartment = false;
                var flaginsert = true;
                CheckDepartment(DepartmentID, DepartmentSelect, WorkerMail, WorkerPhone, Active, flaginsert, flagDepartment, WorkerName2);
                return;
            }

            function AddingWorker(DepartmentID, DepartmentSelect, WorkerMail, WorkerPhone, Active, WorkerName2) {
                var flaga = false;
                var flagb = false;
                var str = $('#WorkerEnterStatus').val();
                if (str == "פרטי עובד כבר קיימים") {
                    return;
                }
                var Department = DepartmentSelect;
                var PassWord = $("#PassWord").val();
                var WorkerLocation = $("#WorkerLocation").val();
                var WorkerDistance = $("#WorkerDistance").val();
                var WorkerAddress = $("#WorkerAddress").val();

                codeAddress2(WorkerLocation);

                if (flag == true || flag == "הוספת עובד נכשלה,בדוק פרטי מיקום") {
                    $('#WorkerEnterStatus').html("שגיאה,בדוק פרטי מיקום");
                    str = $('#WorkerEnterStatus').val();
                    return;
                }



                if (WorkerPhone[0] != 0 || WorkerPhone.length!=10) {
                    $('#WorkerEnterStatus').html("הוספת עובד נכשלה,בדוק פרטי טלפון");
                    return;cx
                }


                var emailRegex = new RegExp(/^([\w\.\-]+)@([\w\-]+)((\.(\w){2,3})+)$/i);
                var valid = emailRegex.test(WorkerMail);
                if (!valid) {
                    $('#WorkerEnterStatus').html("הוספת עובד נכשלה,בדוק פרטי מייל");
                    return;
                }


                var regex = /^[a-zA-Z\-\u0590-\u05FF ]+$/;

                if (regex.test(WorkerName2)) {
                    $("#WorkerEnterStatus").html(" ");
                } else {
                    $('#WorkerEnterStatus').html("הוספת עובד נכשלה,בדוק פרטי שם");
                    return;
                }



                flag = $("#Active").val();
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/AddWorker",
                    dataType: "json",
                    type: "POST",

                    //data: "{'ID':'" + DepartmentID + "','WorkerName':'" + WorkerName2 + "','WorkerMail':'" + WorkerMail + "','PassWord':'" + PassWord + "','WorkerDepartment':'" + Department + "','WorkerLocation':'" + WorkerLocation + "','WorkerPhone':'" + WorkerPhone + "','WorkerDistance':'" + WorkerDistance + "','WorkerAddress':'" + WorkerAddress + "'}",

                    data: "{'DepartmentID':'" + DepartmentID + "','WorkerName':'" + WorkerName2 + "','WorkerMail':'" + WorkerMail + "','PassWord':'" + PassWord + "','WorkerDepartment':'" + Department + "','WorkerLocation':'" + WorkerLocation + "','WorkerPhone':'" + WorkerPhone + "','WorkerDistance':'" + WorkerDistance + "','WorkerAddress':'" + WorkerAddress + "','Active':'" + flag + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        $('#WorkerEnterStatus').html("הוספת עובד נכשלה,בדוק פרטים" + "<br>" + jqXHR.responseJSON.Message);

                    },
                    success: function (data) {
                        CountNumberOfWorkers(Department);
                        GetDepartmentSelects();
                        $('#WorkerEnterStatus').html("הוספת עובד הצליחה");
                    }
                });
            }




            function CountNumberOfWorkers(Department) {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetWorkers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        $('#WorkerEnterStatus').html("הוספת עובד נכשלה,בדוק פרטים");

                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var Number_Of_Employees = 0;
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (Department == WorkersObj[i].WorkerDepartment) {
                                Number_Of_Employees++;
                            }
                        }
                        UpdateNumberOfWorkers(Department, Number_Of_Employees);

                    }
                });
            }


            //מעדכן מספר עובדים במחלקה
            function UpdateNumberOfWorkers(Department, Number_Of_Employees) {
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/UpdateNumberOfWorkers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'Department':'" + Department + "','Number_Of_Employees':'" + Number_Of_Employees + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        $('#WorkerEnterStatus').html("הוספת עובד חדש הצליחה");
                    }

                });
            }







            //מוחק עובד
            ///
            function DeleteWorker() {

                var WorkerID = $("#WorkersSelect2").val();

                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/DeleteWorker",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + WorkerID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                        GetIDAfterDelete(WorkerID);
                    }
                });
            }


            function GetIDAfterDelete(WorkerID) {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetWorkers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {

                    },

                    success: function (data) {
                        var Department;
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (WorkerID == WorkersObj[i].ID) {
                                Department = WorkersObj[i].WorkerDepartment;
                                break;
                            }
                        }
                        CountNumberOfWorkers(Department);

                    }
                });
            }





            //שולף נתונים של עובד

            function GetWorkerByID() {

                var WorkerID = $("#WorkersSelect2").val();
                OriginalID = WorkerID;
                if (WorkerID == 0) {
                    $("#ID2").val("");
                    $("#WorkerName2").val("");
                    $("#PassWord2").val("");
                    $("#WorkerDepartment2").html("");
                    $("#WorkerLocation2").html("");
                    $("#WorkerPhone2").html("");
                    $("#WorkerDistance2").val("");
                    $("#WorkerAddress2").val("");
                    $("#WorkStatusManger").html(" ");
                    $("#IfStillWorking").html("");
                    $("#DepartmentID").html("");
                    return;
                }
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetWorkers",
                    dataType: "json",
                    type: "POST",

                    data: "{'ID':'" + WorkerID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var str = '0';
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (WorkerID == WorkersObj[i].ID) {
                                $("#ID2").val(WorkerID);
                                $("#WorkerName2").val(WorkersObj[i].WorkerName);
                                $("#WorkerMail").val(WorkersObj[i].WorkerMail);
                                $("#PassWord2").val(WorkersObj[i].PassWord);
                                $("#WorkerDepartment2").html("מחלקה:<br>"+WorkersObj[i].WorkerDepartment);
                                $("#WorkerLocation2").val(WorkersObj[i].WorkerLocation);
                                str += WorkersObj[i].WorkerPhone;
                                $("#WorkerPhone2").val(str);
                                $("#WorkerDistance2").val(WorkersObj[i].WorkerDistance);
                                $("#WorkerAddress2").val(WorkersObj[i].WorkerAddress);
                                $("#DepartmentID").val(WorkersObj[i].DepartmentID);
                                $("#DepartmentID").hide();
                                $("#WorkStatusAtive").html("לא פעיל");
                                if (WorkersObj[i].Active == true) {
                                    $("#WorkStatusAtive").html(" פעיל");
                                }
                                break;
                            }
                        }
                    }
                });
                $.ajax({
                    url: WebServiceURL + "/GetWorksDate",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        $("#WorkStatusManger").html("לא נמצא בעבודה");
                        $("#StartWorkStatus").empty();
                        document.getElementById("finish").disabled = true;
                        for (var j = 0; j < WorkersObj.length; j++) {
                            if (WorkersObj[j].ID == WorkerID && WorkersObj[j].EndHour == null) {
                                $("#WorkStatusManger").html("נמצא בעבודה");
                                $("#StartWorkStatus").html("שעת התחלה: " + WorkersObj[j].StartHour);
                                document.getElementById("finish").disabled = false;
                                break;
                            }
                        }
                    }
                });
            }


            //מסיים עבודה
            function ForceEndWorking() {
                var WorkerID = $("#WorkersSelect2").val();
                var datestart = "";
                var starthour = "";
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/GetWorksDate",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + WorkerID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var j = 0; j < WorkersObj.length; j++) {
                            if (WorkersObj[j].ID == WorkerID && WorkersObj[j].EndHour == null) {
                                datestart = WorkersObj[j].EnterDate;
                                starthour = WorkersObj[j].StartHour;
                                break;
                            }
                        }
                        EndingWork(WorkerID, datestart, starthour)
                    }
                });
            }

            function EndingWork(WorkerID, datestart, starthour) {
                var now = new Date(Date.now());
                var formatted = now.getHours() + ":" + now.getMinutes() + ":" + now.getSeconds();
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/UpdateDate",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + WorkerID + "','EnterDate1':'" + datestart + "','StartHour':'" + starthour + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        document.getElementById("finish").disabled = true;
                        $("#EndWorkStatus").html(" סיום עבודה עודכן בהצלחה בשעה" + " " + formatted);
                        $("#WorkStatus").empty();
                        $("#WorkStatus").html("לא נמצא בעבודה");
                    }
                });
            }







            //מעדכן נתוני עובד
            function UpdateWorker(DepartmentID, DepartmentSelect) {
                $("#WorkerUpdatedStatus").html("");
                flag = false;
                var OriginalID = $("#ID2").val();
                var WorkerMail = $("#WorkerMail").val();
                var WorkerName2 = $("#WorkerName2").val();
                var PassWord = $("#PassWord2").val();
                var WorkerPhone = $("#WorkerPhone2").val();
                var WorkerDistance = $("#WorkerDistance2").val();
                var WorkerAddress = $("#WorkerAddress2").val();
                var flaginsert = false;
                var flagDepartment = false;
                CheckDepartment(DepartmentID, DepartmentSelect, WorkerMail, WorkerPhone, flag, flaginsert, flagDepartment, WorkerName2);
            }


            function UpdateClean() {
                $("#WorkerLocation2").val("");
                $("#ID2").val("");
                WorkerDistance = $("#WorkerDistance2").val("");
                $("#WorkerMail").val("");
                $("#WorkerName2").val("");
                $("#PassWord2").val("");
                $("#WorkerPhone2").val("");
                $("#WorkerDistance2").val("");
                $("#WorkerAddress2").val("");
            }
            function UpdateingWorker(DepartmentID, DepartmentSelect, WorkerMail, WorkerPhone, DepartmenActive, WorkerName2) {
                {
                    var WorkerLocation = $("#WorkerLocation2").val();
                    var WorkerDistance = $("#WorkerDistance2").val();
                    var WorkerAddress = $("#WorkerAddress2").val();
                    var PassWord = $("#PassWord2").val();
                    var Department = DepartmentSelect;


                    UpdateClean();


                    codeAddress2(WorkerLocation);

                    if (flag == true || flag == "הוספת עובד נכשלה,בדוק פרטים") {
                        $('#WorkerUpdatedStatus').html("שגיאה,בדוק שם");
                        str = $('#WorkerUpdatedStatus').val();
                        return;
                    }

                    if (Department[0] < 'A' || Department[0] > 'Z') {

                        $("#WorkerUpdatedStatus").html("עדכון עובד נכשל,בדוק פרטי שם");
                        return;
                    }

                    if (WorkerPhone[0] != 0 || WorkerPhone.length!=10) {
                        $("#WorkerUpdatedStatus").html("עדכון עובד נכשל,בדוק פרטים");
                        return;
                    }

                    var emailRegex = new RegExp(/^([\w\.\-]+)@([\w\-]+)((\.(\w){2,3})+)$/i);
                    var valid = emailRegex.test(WorkerMail);
                    if (!valid) {
                        $("#WorkerUpdatedStatus").html("עדכון עובד נכשל,בדוק מייל");
                        return;
                    }


                    var regex =/^[a-zA-Z\-\u0590-\u05FF ]+$/;

                    if (regex.test(WorkerName2)) {
                        $("#WorkerUpdatedStatus").html(" ");
                    } else {
                        $('#WorkerUpdatedStatus').html("עדכון עובד נכשל,בדוק שם");
                        return;
                    }


                             var WebServiceURL = "Enterence.asmx";
                    $.ajax({

                        url: WebServiceURL + "/UpdateWorker",
                        dataType: "json",
                        type: "POST",

                        data: "{'DepartmentID':'" + DepartmentID + "','OriginalID':'" + OriginalID + "','WorkerName':'" + WorkerName2 + "','WorkerMail':'" + WorkerMail + "','PassWord':'" + PassWord + "','WorkerDepartment':'" + Department + "','WorkerLocation':'" + WorkerLocation + "','WorkerPhone':'" + WorkerPhone + "','WorkerDistance':'" + WorkerDistance + "','WorkerAddress':'" + WorkerAddress + "'}",

                        contentType: "application/json; charset=utf-8",
                        error: function (jqXHR, exception) {
                            $("#WorkerUpdatedStatus").html("עדכון עובד נכשל,בדוק פרטים");
                            debugger;

                        },
                        success: function (data) {
                            $("#WorkerUpdatedStatus").html("עדכון עובד הצליח");
                            UpdateDepartmentsWorkers();
                        }
                    });
                }
            }

            function UpdateDepartmentsWorkers()
            {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetDepartment",
                    dataType: "json",
                    type: "POST",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var WorkerDepartment = "";
                        for(var i=0;i<WorkersObj.length;i++)
                        {
                            WorkerDepartment = WorkersObj[i].Department;
                            CountNumberOfWorkers(WorkerDepartment);
                        }

                    }
                    });
            }
            
            


            /////////********************************************פונקציות מחלקות********************************************
            function Departments() {
                TimeEventsManger();
                $.mobile.changePage('#Departments',{ 'transition': 'none' });;
                // $.mobile.changePage('#Departments',{ 'transition': 'none' });;
                $("#Departmentable").empty();

            }

            function DepartmentsManagement() {

                $.mobile.changePage('#DepartmentsManagement',{ 'transition': 'flip' });;
                $.mobile.changePage('#DepartmentsManagement', { 'transition': 'flip' });
                $("#AddDepartmentorNot").html(" ");
                $("#Departmentable").empty();
                GetDepartment();
            }



            ///הוספת מחלקה
            function CompareDepartments() {
                $("#AddDepartmentorNot").html(" ");
                var WorkerName = "";
                var PassWord = "";
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetWorkers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'WorkerName':'" + WorkerName + "','PassWord':'" + PassWord + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {

                    },

                    success: function (data) {

                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var flaga = false;
                        var flagb = false;

                        var Department = $("#EnterDepartment").val();
                        //var DepartmentID = $("#DepartmentID").val();
                        var Email = $("#DepartmentPhonemail").val();
                        var DepartmentPhone = $("#DepartmentPhone").val();
                        var Number_Of_Employees = 0;
                        var WorkerName = "";
                        var WorkerAddress = 0;
                        var DepartmenActive = $("#DepartmenActive").val();
                        flag = false;
                        var DepartmenActive = true;
                        var flaginsert = true;
                        var flagDepartment = true;

                        //CheckifExisted(WorkerName, WorkerAddress, Email, Department, DepartmentPhone, flagDepartment, flaginsert);

                        //var str = $("#AddDepartmentorNot").val();


                        //if (flag == true)
                        //{
                        //    $("#AddDepartmentorNot").html("מחלקה או פרטים כבר קיימים");
                        //    flag = true;
                        //    return;
                        //}


                        if (Department[0] < 'A' || Department[0] > 'Z') {
                            $("#AddDepartmentorNot").html("שם מחלקה שגוי");
                            return;
                        }


                        if (DepartmentPhone[0] != 0 || DepartmentPhone.length!=10) {
                            $("#AddDepartmentorNot").html("מספר טלפון שגוי");
                            return;
                        }
                        var emailRegex = new RegExp(/^([\w\.\-]+)@([\w\-]+)((\.(\w){2,3})+)$/i);
                        var valid = emailRegex.test(Email);
                        if (!valid) {
                            $("#AddDepartmentorNot").html("מייל שגוי");
                            return;
                        }

                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (Department == WorkersObj[i].WorkerDepartment) {
                                Number_Of_Employees++;
                            }
                        }

                        CheckDepartment(Number_Of_Employees, Department, Email, DepartmentPhone, DepartmenActive, flaginsert, flagDepartment, WorkerName);
                    }
                });

            }

            //מוסיף מחלקה
            function CheckDepartment(Number_Of_Employees, Department, Email, DepartmentPhone, DepartmenActive, flaginsert, flagDepartment, WorkerName) {
                flag = false;

                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'Time':'" + Time + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                    },
                    success: function (data) {

                        DepartmentObj = JSON.parse(data.d); //or data["d"]

                        var counter = 0;
                        var counterDepartments = 0;
                        if (flaginsert == true) {
                            for (var i = 0; i < DepartmentObj.length; i++) {

                                if (Email == DepartmentObj[i].Email || parseInt(DepartmentPhone) == DepartmentObj[i].PhoneNumber) {
                                    flag = true;
                                    break;
                                }
                                if (flagDepartment == true && Department == DepartmentObj[i].Department) {
                                    flag = true;
                                    break;

                                }

                            }
                        }


                        if (flaginsert == false) {
                            for (var i = 0; i < DepartmentObj.length; i++) {

                                if (Email == DepartmentObj[i].Email || parseInt(DepartmentPhone) == DepartmentObj[i].PhoneNumber) {
                                    counter++;
                                }

                                if (flagDepartment == true && Department == DepartmentObj[i].Department) {
                                    counterDepartments++;
                                }

                                if (counter == 2 || counterDepartments == 2) {
                                    flag = true;
                                    break;

                                }
                            }
                        }


                        if (flag == false) {
                            CheckDWorker(Number_Of_Employees, Department, Email, DepartmentPhone, DepartmenActive, flaginsert, flagDepartment, WorkerName);
                            return;
                        }

                        if (flagDepartment == true) {
                            alert("Department2");
                            $("#AddDepartmentorNot").html("פרטי מחלקה כבר קיימים");
                        }

                        if (flagDepartment == false && flag == true) {
                            $('#WorkerEnterStatus').html("פרטי עובד כבר קיימים");
                            return;
                        }

                    }
                });
            }





            function CheckDWorker(Number_Of_Employees, Department, Email, DepartmentPhone, DepartmenActive, flaginsert, flagDepartment, WorkerName) {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/GetWorkers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'Time':'" + Time + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                    },
                    success: function (data) {

                        WorkerObj = JSON.parse(data.d); //or data["d"]

                        var counter = 0;
                        if (flaginsert == true) {
                            for (i = 0; i < WorkerObj.length; i++) {
                                if (WorkerObj[i].WorkerMail == Email || WorkerObj[i].WorkerPhone == parseInt(DepartmentPhone)) {
                                    flag = true;
                                    break;
                                }


                            }
                        }

                        if (flaginsert == false) {
                            for (i = 0; i < WorkerObj.length; i++) {

                                if (Email == WorkerObj[i].WorkerMail || parseInt(DepartmentPhone) == WorkerObj[i].WorkerPhone) {
                                    counter++;
                                }
                                if (counter == 2) {
                                    flag = true;
                                    break;
                                }

                            }
                        }
                        if (flag == false) {
                            CheckManger(Number_Of_Employees, Department, Email, DepartmentPhone, DepartmenActive, flaginsert, flagDepartment, WorkerName);
                        }

                        if (flagDepartment == true && flag==true) {
                            alert("Departmant0");
                            $("#AddDepartmentorNot").html("פרטי מחלקה כבר קיימים");
                            return;
                        }
                        if (flagDepartment == false && flag == true) {
                            $('#WorkerEnterStatus').html("פרטי עובד כבר קיימים");
                            return;
                        }
                    }



                });

            }


            function CheckManger(Number_Of_Employees, Department, Email, DepartmentPhone, DepartmenActive, flaginsert, flagDepartment, WorkerName) {

                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetManagers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'Time':'" + Time + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                    },
                    success: function (data) {
                        ManagerObj = JSON.parse(data.d); //or data["d"]
                        var counter = 0;
                        if (flaginsert == true) {
                            for (var i = 0; i < ManagerObj.length; i++) {
                                if (Email == ManagerObj[i].MangerMail || parseInt(DepartmentPhone) == ManagerObj[i].MangerPhone) {
                                    flag = true;
                                    break;
                                }


                            }
                        }

                        if (flaginsert == false) {
                            for (i = 0; i < ManagerObj.length; i++) {

                                if (Email == ManagerObj[i].MangerMail || parseInt(DepartmentPhone) == ManagerObj[i].MangerPhone) {
                                    counter++;

                                }
                                if (counter == 2) {
                                    flag = true;
                                    break;

                                }

                            }
                        }

                        if (flag == false && flaginsert == true && flagDepartment == true) {

                            AddDepartment(Number_Of_Employees, Department, Email, DepartmentPhone, DepartmenActive, flaginsert)
                            return;
                        }


                        if (flag == false && flaginsert == true && flagDepartment == false) {

                            AddingWorker(Number_Of_Employees, Department, Email, DepartmentPhone, DepartmenActive, WorkerName)
                            return;
                        }

                        if (flag == false && flaginsert == false && flagDepartment == false) {

                            UpdateingWorker(Number_Of_Employees, Department, Email, DepartmentPhone, DepartmenActive, WorkerName)
                            return;
                        }

                        if (flag == false && flaginsert == false && flagDepartment == true) {

                            UpdatingDepartment(Number_Of_Employees, Department, Email, DepartmentPhone, DepartmenActive, WorkerName);
                            flag = false;
                        }


                        if (flagDepartment == true && flag == true) {
                            alert("department");
                            $("#AddDepartmentorNot").html("פרטי מחלקה כבר קיימים");
                            return;
                        }

                        if (flagDepartment == false && flag == true) {
                            $('#WorkerEnterStatus').html("פרטי עובד כבר קיימים");
                            return;
                        }
                    }
                });

            }



            function AddDepartment(Number_Of_Employees, Department, Email, DepartmentPhone, DepartmenActive) {

                var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/AddDepartment",
                    dataType: "json",
                    type: "POST",

                    data: "{'Department':'" + Department + "','Number_Of_Employees':'" + Number_Of_Employees + "','PhoneNumber':'" + DepartmentPhone + "','Email':'" + Email + "','Active':'" + DepartmenActive + "'}",



                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        $("#AddDepartmentorNot").html("הוספת מחלקה נכשלה" + "<br>" + jqXHR.responseJSON.Message);
                        debugger;

                    },
                    success: function (data) {
                        $("#AddDepartmentorNot").html("הוספת מחלקה הצליחה");
                        //Departments();
                    }
                });
            }




            //מוחק עובד
            ///
            //function DeleteWorker() {

            //    var WorkerID = $("#WorkersSelect2").val();


            //        var WebServiceURL ="http://ruppinmobile.ac.il.preview26.livedns.co.il/site08/Enterence.asmx"";
            //    debugger;
            //    $.ajax({

            //        url: WebServiceURL + "/DeleteWorker",
            //        dataType: "json",
            //        type: "POST",   //use only POST!
            //        // data: "{'num':'" + num + "' }",

            //        data: "{'ID':'" + WorkerID + "'}",

            //        contentType: "application/json; charset=utf-8",
            //        error: function (jqXHR, exception) {
            //            debugger;
            //            alert(formatErrorMessage(jqXHR, exception));
            //            debugger;
            //        },

            //        success: function (data) {
            //            debugger;
            //            alert("successfully Deleted")
            //        }
            //    });
            //}



            function GetDepartment() {
                flag = false;
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {

                        DepartmentsObj = JSON.parse(data.d); //or data["d"]
                        GetDepartmentWorkers(DepartmentsObj);
                    }
                });
            }


            function GetDepartmentWorkers(DepartmentsObj) {
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetWorkers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        return;
                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var k = 0; k < WorkersObj.length; k++) {
                            if (WorkersObj[k].Active == true) {
                                WorkersObj[k].Active = "פעיל";
                            }
                            if (WorkersObj[k].Active == false) {
                                WorkersObj[k].Active = "לא פעיל";
                            }
                        }

                        var TemperID = 0;
                        var WorkersNames = "";
                        var Nametemp = "";
                        var content = "";
                        var DepartmentStatus;
                        var nextId = 1;
                        var j = 0;
                        var nextId2 = 100;
                        var nextId3 = 1000;
                        var nextId4 = 10000;
                        var nextId5 = 100000;
                        var nextId6 = 1000000;
                        var nextId7 = 100000000
                        var nextId8 = 1000000000
                        flag = false;
                        DepartmentStatus = "לא פעילה";
                        for (var i = 0; i < DepartmentsObj.length; i++) {
                            if (flag == false) {
                                content += "<div data-role='collapsible' id='set" + nextId + "'><h3>  פרטי מחלקת" + " " + DepartmentsObj[i].Department + "<br><br>" + "</h3><p>";
                                flag = true;
                            }
                            if (DepartmentsObj[i].Active == true) {
                                DepartmentsObj[i].Active = "פעילה";
                            }


                            if (DepartmentsObj[i].Active == false || DepartmentsObj[i].Active == null) {
                                DepartmentsObj[i].Active = "לא פעילה";
                            }

                            for (j = 0; j < WorkersObj.length; j++) {

                                if (DepartmentsObj[i].Department == WorkersObj[j].WorkerDepartment) {

                                    content += "<p></p><div data-role=collapsible><h1>" + WorkersObj[j].WorkerName + "<br></h1><p>" + "<br>" + "מצב: " + WorkersObj[j].Active + "<br>" + "<br>" + "<br> <br>איימייל: " + "<a href=" + "mailto:" + WorkersObj[j].WorkerMail + "?subject=Circle Around&body=Some blah" + "target=_top>" + "" + WorkersObj[j].WorkerMail + "</a><br><br>" + "<br><a href=tel:0" + WorkersObj[j].WorkerPhone + ">0" + WorkersObj[j].WorkerPhone + "</a> :טלפון</p></div>";

                                }

                            }
                            if (flag == true) {
                                if (DepartmentsObj[i].Number_Of_Message == null)
                                {
                                    DepartmentsObj[i].Number_Of_Message = 0;
                                }
                                content += "<br>" + "<br>" + "ת.ז של  מחלקה:" + DepartmentsObj[i].DepartmentID + "<br><br>" + "מספר עובדים:" + DepartmentsObj[i].Number_Of_Employees + "<br><br><br>" + "מספר הודעות:" + DepartmentsObj[i].Number_Of_Message + "<br><br><br>" + "שם מחלקה:" + " <input type=text  id=" + nextId7 + " value=" + DepartmentsObj[i].Department + " />" + "<br>" + "<br>" +
                               "מספר טלפון:" + " <input type=text  id=" + nextId4 + " value=" + "0" + DepartmentsObj[i].PhoneNumber + " />" + "<br>" + "<br>" +
                                "אימייל:" + " <input type=text  id=" + nextId5 + " value=" + DepartmentsObj[i].Email + " />" + "<br>" + "<br>" + "<select id=" + nextId6 + " name=" + "מצב מחלקה" + "> <option value=" + "true" + ">פעילה</option> <option value=" + "false" + ">לא פעילה</option> </select>" + "<br>" + "<br>" +
                                  "<br>מצב מחלקה עדכני :" + DepartmentsObj[i].Active + "<br>" +
                                   "<button type=button id=" + DepartmentsObj[i].Department + " onclick=UpdateDepartment(" + DepartmentsObj[i].DepartmentID + "," + "document.getElementById(" + nextId7 + ").value" + "," + "document.getElementById(" + nextId4 + ").value" + "," + "document.getElementById(" + nextId5 + ").value" + "," + "document.getElementById(" + nextId6 + ").value" + "," + DepartmentsObj[i].Number_Of_Employees + "," + DepartmentsObj[i].Number_Of_Message + ",'" + DepartmentsObj[i].Department + "');>" + "עדכן מחלקה" + "</button></p></div>";
                                nextId3 = +nextId3 + 100;
                                nextId = nextId + 1;
                                nextId2 = nextId2 + 1;
                                nextId4 = nextId4 + 1;
                                nextId5 = nextId5 + 1;
                                nextId6 = nextId6 + 1;
                                nextId7 = nextId7 + 1;
                                nextId8 = nextId8 + 1;
                                DepartmentsObj[i].Active = "לא פעילה";
                            }
                            flag = false;
                        }
                        $("#Departmentable").append(content).collapsibleset('refresh');
                    }
                });
            }





            function UpdateDepartment(DepartmentID, UpdatedDepartment, PhoneNumber, Email, Active, Number_Of_Employees, Number_Of_Message, OriginalUpdatedDepartment) {
                var flagDepartment = true;
                var flaginsert = false;
                CheckDepartment(DepartmentID, UpdatedDepartment, Email, PhoneNumber, Active, flaginsert, flagDepartment, OriginalUpdatedDepartment)
            }


            function UpdatingDepartment(DepartmentID, UpdatedDepartment, Email, PhoneNumber, Active, OriginalUpdatedDepartment) {

                         var WebServiceURL = "Enterence.asmx";

                var Number_Of_Employees = 0;
                var Number_Of_Message = 0;

                flag = false;
                var flagDepartment = true;
                var WorkerName = "";
                var WorkerAddress = 0;
                var flaginsert = false;
                var emailRegex = new RegExp(/^([\w\.\-]+)@([\w\-]+)((\.(\w){2,3})+)$/i);
                var valid = emailRegex.test(Email);
                if (!valid) {
                    return;
                }

                if (UpdatedDepartment[0] < 'A' || UpdatedDepartment[0] > 'Z') {

                    $("#AddDepartmentorNot").html("עדכון מחלקה נכשל,בדוק פרטים");
                    return;
                }


                if (PhoneNumber[0] != 0 || PhoneNumber.length != 10) {
                    $("#AddDepartmentorNot").html("עדכון מחלקה נכשל,בדוק פרטים");
                    return;
                }

                //for (i = 0; i < OriginalUpdatedDepartment.length; i++) {
                //    if (OriginalUpdatedDepartment[i] <= 9 && OriginalUpdatedDepartment[i] >= 0) {
                //        return;
                //    }
                //}

                $.ajax({

                    url: WebServiceURL + "/UpdateDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",
                    data: "{'DepartmentID':'" + DepartmentID + "','Department':'" + UpdatedDepartment + "','OriginalDepartment':'" + OriginalUpdatedDepartment + "','Number_Of_Employees':'" + Number_Of_Employees + "','Number_Of_Message':'" + Number_Of_Message + "','PhoneNumber':" + PhoneNumber + ",'Email':'" + Email + "','Active':'" + Active + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                        $("#AddDepartmentorNot").html("פרטי מחלקה עודכנו");
                        UpdateDepartment4All(UpdatedDepartment, OriginalUpdatedDepartment);
                    }
                });
            }


            //מעדכן לכל העובדים את המחלקה
            function UpdateDepartment4All(UpdatedDepartment, OriginalUpdatedDepartment) {
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/UpdateWorkerDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",
                    data: "{'Department':'" + UpdatedDepartment + "','OriginalDepartment':'" + OriginalUpdatedDepartment + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                        UpdateForumDepartment(UpdatedDepartment, OriginalUpdatedDepartment);
                    }
                });
            }


            //מעדכן פורום מחלקה
            function UpdateForumDepartment(UpdatedDepartment, OriginalUpdatedDepartment) {
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/UpdateForumDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",
                    data: "{'Department':'" + UpdatedDepartment + "','OriginalDepartment':'" + OriginalUpdatedDepartment + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                        DepartmentsManagement();
                    }
                });
            }

            function BackToForums() {
                $.mobile.changePage('#Chet',{ 'transition': 'none' });;
                $.mobile.changePage('#Chet',{ 'transition': 'none' });;
            }


            function DeleteDepartment(temperDepartment) {

                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/DeleteDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'Department':'" + temperDepartment + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                        DepartmentsManagement();
                    }
                });
            }

            /////////////////////////////////////////////////// פורום מחלקות//////////////////

            //כניסה לעמוד הודעות מחלקה
            function DepartmentForumManger() {
                //location.reload();
                $.mobile.changePage('#Chet',{ 'transition': 'flip' });;
                $.mobile.changePage('#Chet', { 'transition': 'flip' });;
                $("#TextArea").empty();
                $("#Users").empty();
                $("#MessagesTable").empty();
                NamesTable3Manger();
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetWorkers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        WorkersArray = JSON.parse(data.d); //or data["d"]

                        GetDepartmentForumsManger(WorkersArray);
                        TimeEventsManger();

                    }
                });
            }

            //שליפת עובדים לפי מחלקה
            function GetDepartmentForumsManger(WorkersArray) {

                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        flag = false;
                        $("#Users").empty();
                        var WorkersNames = "";
                        var Nametemp = "";
                        var content = "";
                        var nextId = 1;
                        var d = 0;
                        var TemprDepartment = null;
                        var nextId2 = 100;
                        var nextId3 = 1000;
                        var nextId4 = 10000;
                        var nextId5 = 100000;
                        var nextId6 = 1000000;
                        var nextId7 = 10000000;
                        var j = 0;
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        VacationDetails = JSON.parse(data.d);
                        for (var i = 0; i < WorkersObj.length; i++) {
                            for (j = 0; j < WorkersArray.length; j++) {
                                if (WorkersObj[i].Department == WorkersArray[j].WorkerDepartment) {
                                    tempDepartment = WorkersObj[i].Department;
                                    ID = WorkersArray[j].ID;
                                    if (flag == false) {
                                        content += "<div data-role='collapsible' id='set" + nextId + "'><h3>" + WorkersArray[j].WorkerDepartment + "<br>" + "</h3><p> <select id=" + nextId7 + " name=בחר עובד מחלקה>" + "<option value=" + nextId2 + ">" + "בחר עובד מחלקה " + "</option>";

                                        flag = true;
                                    }
                                    content += "<option value=" + WorkersArray[j].ID + ">" + WorkersArray[j].WorkerName + "</option>";

                                    if (TemprDepartment == null) {
                                        TemprDepartment = names[j + 3];
                                    }



                                }

                            }
                                                       
                            if (flag == true) {
                                content += "</select> <br> " + " </br >";
                                content += "<br><button type=button onclick=MessagesManagingManger(document.getElementById(" + nextId7 + ").value" + ",'" + TemprDepartment + "')>" + "הצג הודעות של עובד מהישן לחדש " + "</button>";
                                content += "<br><br><button type=button onclick=MessagesManagingNewtoOldManger(document.getElementById(" + nextId7 + ").value" + ",'" + TemprDepartment + "')>" + "הצג הודעות של עובד מהחדש לישן " + "</button>";
                                content += "<br><br><button type=button onclick=SearchMessagesManger(document.getElementById(" + nextId7 + ").value" + ",'" + TemprDepartment + "')>" + "הצג הודעות לפי חיפוש " + "</button>";
                                content += "<br><br><button type=button onclick=MessagesForumsClicked('" + TemprDepartment + "')>" + "הצג הודעות מחלקה " + "</button>";
                                content += "<br><br><button type=button onclick=ReprtedMessages('" + TemprDepartment + "')>" + "הצג הודעות פורום שדווחו " + "</button></div><br>";
                            }
                            //nextId7 = nextId7 + 1;
                            flag = false;
                            nextId = nextId + 1;
                            nextId2 = nextId2 + 1;
                            nextId3 + nextId3 + 1;
                            nextId4 = nextId4 + 1;
                            nextId5 = nextId5 + 1;
                            nextId6 = nextId6 + 1;
                            nextId7 = nextId7 + 1;
                            TemprDepartment = null
                        }
                        //  $.mobile.changePage('#VecationsManger',{ 'transition': 'none' });;
                        Workerselect = WorkersNames;
                        $("#Users").append(content).collapsibleset('refresh');
                        //MessagesManaging();
                    }
                });
            }


            //פונקציה דף יצירת נושא
            function CreateTopicPageManger() {
                $.mobile.changePage('#CreateTopicPageManger',{ 'transition': 'none' });;
                $.mobile.changePage('#CreateTopicPageManger', { 'transition': 'none' });
                $('#DepartmentForumsMangerError').html("");
                //// location.reload();
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                        debugger;
                    },

                    success: function (data) {
                        flag = 0;
                        var WorkersNames = "";
                        var Nametemp = "";
                        var nextId = 1;

                        var tempDepartment = "";
                        var tempDepartment2 = "";
                        var content = "";

                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        content += "<option value=" + 0 + ">" + "בחר  מחלקה " + "</option>";

                        for (var i = 0; i < WorkersObj.length; i++) {

                            content += "<option value=" + WorkersObj[i].DepartmentID + ">" + WorkersObj[i].Department + "</option>";
                        }
                        $("#DepartmentSelectForums").html(content);
                    }
                });

            }


            ///מחפש הודעות
            function SearchMessagesManger(tempID, TemprDepartment) {
                if (Firstdate != true) {
                    MessagesForumsManger(TemprDepartment);
                }
                $("#MessagesTable").empty();
                var MessageWords = $("#SearchMessages").val();
                var datetime = $("#ByYearManger").val();

                var d1;

                d1 = datetime[8];
                d1 += datetime[9];
                d1 += '/';
                d1 += datetime[5];
                d1 += datetime[6];
                d1 += '/';
                d1 += datetime[0];
                d1 += datetime[1];
                d1 += datetime[2];
                d1 += datetime[3];
                datetime = d1;


                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                        debugger;
                    },

                    success: function (data) {
                        var tempdate = "";
                        var n = "";
                        var nextId3 = 1000;
                        var j = 0;
                        var content = "<div data-role=content>"; WorkersObj = JSON.parse(data.d); //or data["d"]
                        MassagingObj = JSON.parse(data.d); //or data["d"]

                        for (var i = 0; i < MassagingObj.length; i++) {
                            if (MassagingObj[i].Message_datetime.indexOf(datetime) != -1 && MassagingObj[i].Message_Content.indexOf(MessageWords) != 1 && tempID == MassagingObj[i].ID || tempdate.indexOf(datetime) != 1 && MassagingObj[i].Message_Topic.indexOf(MessageWords) != -1 && tempID == MassagingObj[i].ID) {
                                content += "</p><div data-role=collapsible><h1>" + " " + "<br>" + MassagingObj[i].Message_Topic + "<br>" + MassagingObj[i].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + MassagingObj[i].Message_datetime + "><br>";
                                content += MassagingObj[i].Message_Content + "</h3><br><br><br><br>";
                                content += "<br></div><br></p>";
                            }

                            tempdate = "";
                        }
                        $("#MessagesTable").append(content).collapsibleset('refresh');
                    }
                });
            }



            //ניהול הודעות משתמשים
            function MessagesManagingManger(MessageID, TemprDepartment) {

                if (Firstdate != true) {
                    MessagesForumsManger(TemprDepartment);
                }
                ID = MessageID;
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        flag = false;
                        var flag2 = false;
                        $("#MessagesTable").empty();
                        ID = MessageID;
                        if (Firstdate != true) {
                            MessagesForumsManger(TemprDepartment);
                        }
                    }

                });


                $.ajax({
                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                        debugger;
                    },

                    success: function (data) {
                        MassagingObj = JSON.parse(data.d); //or data["d"]
                        flag = false;
                        var flag2 = 0;
                        $("#MessagesTable").empty();
                        var WorkersNames = "";
                        var Nametemp = "";
                        var nulling;

                        var WorkersNames = "";
                        var Nametemp = "";
                        var max = 0;
                        var tempnum = 0;
                        var temptext = "";
                        var content = "";
                        var nextId = 1;
                        var nextId2 = 100;
                        var nextId3 = 1000;
                        var nextId4 = 10000;
                        var nextId5 = 100000;
                        var nextId6 = 1000000;
                        var k = 0;
                        var l = 0;
                        var j = 0;
                        var p = 0;
                        var TempTopic;
                        var TempTopicID;
                        var tempname = "";


                        content += "<div data-role=content>"
                        for (var u = 0; u < MassagingObj.length ; u++) {
                            if (MassagingObj[u].ID == ID && assagingObj[u].Manger!=true) {
                                TempTopic = MassagingObj[u].Message_Topic;
                                TempTopicID = MassagingObj[u].Message_ID;
                                TopicID = MassagingObj[u].ID;
                                TopicMessageID = MassagingObj[u].Message_ID;
                                Topicdatetime = MassagingObj[u].Message_datetime;
                                temptext = MassagingObj[u].Message_datetime;

                                content += "</p><div data-role=collapsible><h1>" + tempname + "<br>" + MassagingObj[u].Message_Topic + "<br>" + MassagingObj[u].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + temptext + "><br>";
                                //content += "</p><div data-role=collapsible><h1>" + tempname + "<br>" + "<br>" + WorkersObj[p].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + temptext + "><br>" + WorkersObj[p].Message_Content + "<br><br><br><br>" +
                                //   "<input type=textarea  id=" + nextId2 + " placeholder=" + "הכנס-הודעה" + " />" + "<br>" + "<br>";
                                content += MassagingObj[u].Message_Content + "</h3><br><br><br><br>";

                                content += "<br></div><br></p>";

                                //"<button type=button onclick=GetDMessagesID4replay(" + flagQuote + "," + "document.getElementById(" + nextId2 + ").value" + "," + TempID + "," + MessageID + ",'" + Message_datetime + "');>" + "הגב  להודעה " + "</button>" +
                            }
                        }


                        $("#MessagesTable").append(content).collapsibleset('refresh');
                        flag = false;

                    }
                });
            }






            function MessagesManagingNewtoOldManger(MessageID, TemprDepartment) {
                ID = MessageID;
                if (Firstdate != true) {
                    MessagesForumsManger(TemprDepartment);
                }
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                        debugger;
                    },

                    success: function (data) {
                        MassagingObj = JSON.parse(data.d); //or data["d"]
                        flag = false;
                        var flag2 = 0;
                        $("#MessagesTable").empty();
                        var WorkersNames = "";
                        var Nametemp = "";
                        var nulling;

                        var WorkersNames = "";
                        var Nametemp = "";
                        var max = 0;
                        var tempnum = 0;
                        var temptext = "";
                        var content = "";
                        var nextId = 1;
                        var nextId2 = 100;
                        var nextId3 = 1000;
                        var nextId4 = 10000;
                        var nextId5 = 100000;
                        var nextId6 = 1000000;
                        var k = 0;
                        var l = 0;
                        var j = 0;
                        var p = 0;
                        var TempTopic;
                        var TempTopicID;
                        var tempname = "";


                        content += "<div data-role=content>"
                        for (var u = (MassagingObj.length - 1) ; u != -1; u--) {
                            if (MassagingObj[u].ID == ID && MassagingObj[u].Manger != true) {
                                TempTopic = MassagingObj[u].Message_Topic;
                                TempTopicID = MassagingObj[u].Message_ID;
                                TopicID = MassagingObj[u].ID;
                                TopicMessageID = MassagingObj[u].Message_ID;
                                Topicdatetime = MassagingObj[u].Message_datetime;
                                temptext = MassagingObj[u].Message_datetime;

                                content += "</p><div data-role=collapsible><h1>" + tempname + "<br>" + MassagingObj[u].Message_Topic + "<br>" + MassagingObj[u].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + temptext + "><br>";
                                //content += "</p><div data-role=collapsible><h1>" + tempname + "<br>" + "<br>" + WorkersObj[p].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + temptext + "><br>" + WorkersObj[p].Message_Content + "<br><br><br><br>" +
                                //   "<input type=textarea  id=" + nextId2 + " placeholder=" + "הכנס-הודעה" + " />" + "<br>" + "<br>";
                                content += MassagingObj[u].Message_Content + "</h3><br><br><br><br>";

                                content += "<br></div><br></p>";

                                //"<button type=button onclick=GetDMessagesID4replay(" + flagQuote + "," + "document.getElementById(" + nextId2 + ").value" + "," + TempID + "," + MessageID + ",'" + Message_datetime + "');>" + "הגב  להודעה " + "</button>" +
                            }
                        }


                        $("#MessagesTable").append(content).collapsibleset('refresh');
                        flag = false;

                    }
                });
                Firstdate = false;
            }


            function ReprtedMessages(TemprDepartment) {
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                        debugger;
                    },

                    success: function (data) {
                        MassagingObj = JSON.parse(data.d); //or data["d"]
                        flag = false;
                        var flag2 = 0;
                        $("#MessagesTable").empty();
                        var WorkersNames = "";
                        var Nametemp = "";
                        var nulling;

                        var WorkersNames = "";
                        var Nametemp = "";
                        var max = 0;
                        var tempnum = 0;
                        var temptext = "";
                        var content = "";
                        var nextId = 1;
                        var nextId2 = 100;
                        var nextId3 = 1000;
                        var nextId4 = 10000;
                        var nextId5 = 100000;
                        var nextId6 = 1000000;
                        var k = 0;
                        var l = 0;
                        var j = 0;
                        var p = 0;
                        var TempTopic;
                        var TempTopicID;
                        var tempname = "";


                        content += "<div data-role=content>"
                        for (var u = (MassagingObj.length - 1) ; u != -1; u--) {
                            if (MassagingObj[u].Department == TemprDepartment && MassagingObj[u].Reported == true && MassagingObj[u].Manger == null) {
                                for (var j = 0; j < namescounter; j = j + 10) {
                                    if (MassagingObj[u].ID == names[j]) {
                                        tempname = names[j + 1];
                                    }
                                }
                                TempTopic = MassagingObj[u].Message_Topic;
                                TempTopicID = MassagingObj[u].Message_ID;
                                TopicID = MassagingObj[u].ID;
                                TopicMessageID = MassagingObj[u].Message_ID;
                                Topicdatetime = MassagingObj[u].Message_datetime;
                                temptext = MassagingObj[u].Message_datetime;


                                content += "</p><div data-role=collapsible><h1>" + tempname + "<br>" + MassagingObj[u].Message_Topic + "<br>" + TemprDepartment + "<br>" + MassagingObj[u].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + temptext + "><br>";

                                content += MassagingObj[u].Message_Content + "</h3><br><br><br><br>";

                                content += "<br></div><br></p>";

                                //"<button type=button onclick=GetDMessagesID4replay(" + flagQuote + "," + "document.getElementById(" + nextId2 + ").value" + "," + TempID + "," + MessageID + ",'" + Message_datetime + "');>" + "הגב  להודעה " + "</button>" +
                            }
                        }


                        $("#MessagesTable").append(content).collapsibleset('refresh');
                        flag = false;

                    }
                });
            }

            function Loadtextblank() {
                flag = false;
                Loadtext();
            }

            function LoadtextWithTopic() {
                flag = true;
                Loadtext();
            }


            function FlagReport() {
                flag = "Report";
                Loadtext();
            }

            function Loadtext() {
                $("#TextArea").empty();
                var content = "";
                var Privateornot = false;
                var Topicontent = "";
                var TopicID = 0;
                var Departments_MessagesID = 0;
                var DepartmentsMessages;
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                        debugger;
                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var date = $('input[name="ClassMessage"]:checked').val();
                        date = date.replace("מנהל", "");
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (date == WorkersObj[i].Message_datetime) {
                                content = WorkersObj[i].Message_Content;
                                Topicontent = WorkersObj[i].Message_Topic;
                                Privateornot = WorkersObj[i].Private_Message;
                                TopicID = WorkersObj[i].Departments_MessagesID;
                                Departments_MessagesID = WorkersObj[i].Departments_MessagesID;
                                DepartmentsMessages = WorkersObj[i].Department;
                                $('#ChetID').val(WorkersObj[i].ID);
                                $('#ChetID').hide();
                                break;

                            }
                        }

                        if (flag == false) {
                            $("#TextArea").append(content).collapsibleset('refresh');
                            return;
                        }

                        if (flag == "Report") {
                            RemoveReport(content, Departments_MessagesID, date, Topicontent, TopicID);
                            flag = false;
                            $("#MessagesTable").empty();
                            DepartmentForum();
                            return;
                        }

                        UpdateWithTopics(content, Departments_MessagesID, date, Topicontent, Privateornot, TopicID, DepartmentsMessages);
                        return;
                    }
                });
            }


            //דף עדכון הודעה
            function UpdateWithTopics(content, TempID, datetime, Topicontent, Privateornot, TopicID, DepartmentsMessages) {
                flag = false;
                flag = Privateornot;
                $.mobile.changePage('#UpdateOrDeletePageWithTopicManger',{ 'transition': 'none' });;
                $.mobile.changePage('#UpdateOrDeletePageWithTopicManger',{ 'transition': 'none' });;
                $("#textUpdateTopicManger").val(Topicontent);
                $("#textDate2Manger").text(datetime);
                $("#AreaTexts4update2Manger").val(content);
                $("#MessageIDManger").val(TopicID);
                $("#MessageIDManger").hide();
                $("#TopicIDManger").val(TopicID);
                $("#TopicIDManger").hide();
                $("#DepartmentssMessages").val(DepartmentsMessages);
                $("#DepartmentssMessages").hide();
            }



            function RemoveReport(content, ID, datetime, Topicontent, TopicID) {
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/RemoveReport",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",
                    data: "{'ID':'" + ID + "','content':'" + content + "','datetime':'" + datetime + "','Topicontent':'" + Topicontent + "','TopicID':'" + TopicID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                    }
                });
            }










            function NULLMessages() {
                if (flag == true) {
                    return;
                }
                flag = true;
                StatusOfTopic();
            }


            function FALSEMessages() {
                if (flag == true) {
                    return;
                }
                flag = false;
                StatusOfTopic();
            }

            function StatusOfTopic() {
                var Message_Topic = $("#textUpdateTopic").val();
                var Topic_ID = $("#TopicID").val();
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/TopicStatus",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + Topic_ID + "','Message_Topic':'" + Message_Topic + "','flag':'" + flag + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                        debugger;
                    },

                    success: function (data) {
                        debugger;
                    }
                });
            }


            function CloseTopic(Message_Topic, Topic_ID) {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/CloseTopic",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + Topic_ID + "','Message_Topic':'" + Message_Topic + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                    }
                });
            }






            function UpdateWithTopicManger() {
                var Message_Topic = $("#textUpdateTopicManger").val();
                var Message_datetime = $('#textDate2Manger').text();
                var Message_Content = $("#AreaTexts4update2Manger").val();
                var Topic_ID = $("#TopicIDManger").val();
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/UpdateWithTopic",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + Topic_ID + "','Message_Content':'" + Message_Content + "','Message_Topic':'" + Message_Topic + "','Message_datetime':'" + Message_datetime + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                        DepartmentForumManger();
                    }
                });
            }


            function GetTopicID(Message_datetime, Message_Topic) {
                var Topic_ID = 0;
                flag = false;
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (ID == WorkersObj[i].ID && Message_datetime == WorkersObj[i].Message_datetime) {
                                Topic_ID = WorkersObj[i].Message_ID;
                                break;
                            }
                        }
                        UpdateAllTopic(Topic_ID, Message_Topic);
                    }
                });
            }


            function UpdateAllTopic(Topic_ID, Message_Topic) {
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/UpdateAllTopic",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",
                    data: "{'Topic_ID':'" + Topic_ID + "','Message_Topic':'" + Message_Topic + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                        //MessagesForums();
                        DepartmentForum();
                    }
                });
            }


            function DeleteMassagingManger() {
                var Message_Topic = $("#textUpdateTopicManger").val();
                var Message_datetime = $('#textDate2Manger').text();
                var Message_Content = $("#AreaTexts4update2Manger").val();
                var ResponeID = $("#MessageIDManger").val();
                var DepartmentsMessagesID = $("#TopicIDManger").val();
                var DepartmentssMessages = $("#DepartmentssMessages").val();
                         var WebServiceURL = "Enterence.asmx";
                OriginalID = DepartmentsMessagesID;
                debugger;
                $.ajax({

                    url: WebServiceURL + "/DeleteDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",
                    data: "{'ID':'" + DepartmentsMessagesID + "','Message_datetime':'" + Message_datetime + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                    }
                });
                //OrdertmentsMassaging(DepartmentsMessagesID);
                CountMessagesManger(DepartmentssMessages);
                TrueNewestPostManger();
            }





            //סימון הודעה אחרונה
            function TrueNewestPostManger() {
                var tempID = 0;
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + tempID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        var flag = 0;
                        var WorkersNames = "";
                        var Nametemp = "";
                        var max = 0;
                        var tempnum = 0;
                        var Tempdate = "";
                        var temptext = "";
                        var content = "";
                        var nextId = 1;
                        var k = 0;
                        var l = 0;
                        var j = 0;
                        var p = 0;
                        flag = false;
                        for (var i = 0; i < WorkersObj.length; i++) {
                            for (j = 0; j < WorkersObj[i].Message_datetime.length; j++) {
                                if (WorkersObj[i].Message_datetime[j] >= 0 && WorkersObj[i].Message_datetime[j] <= 9) {
                                    flag = true;
                                    max += WorkersObj[i].Message_datetime[j];
                                    tempID = WorkersObj[i].ID;

                                }
                            }
                            if (flag == true) {
                                break;
                            }
                        }

                        flag = false;
                        for (k = 0; k < WorkersObj.length; k++) {
                            while (l < WorkersObj[k].Message_datetime.length) {
                                if (WorkersObj[k].Message_datetime[l] >= 0 && WorkersObj[k].Message_datetime[l] <= 9) {
                                    tempnum += WorkersObj[k].Message_datetime[l];


                                }
                                l++;
                            }
                            if (max < tempnum) {
                                max = tempnum;
                                tempID = WorkersObj[k].ID;
                                Tempdate = WorkersObj[k].Message_datetime;
                                temptext = WorkersObj[k].Message_Content;
                            }
                            tempnum = 0;
                            l = 0;

                        }


                        $.ajax({
                            url: WebServiceURL + "/UpdateTrueForMaxDate",
                            dataType: "json",
                            type: "POST",   //use only POST!
                            data: "{'ID':'" + tempID + "','Tempdate':'" + Tempdate + "','Message_Content':'" + temptext + "'}",

                            contentType: "application/json; charset=utf-8",
                            error: function (jqXHR, exception) {
                                debugger;
                            },
                            success: function (data) {
                                DepartmentForumManger();
                                //MessagesForums();

                            }

                        });
                    }
                });
            }



            ///פורום לפי מחלקה

            function MessagesForumsClicked(TemprDepartment) {
                Firstdate = true;
                MessagesForumsManger(TemprDepartment);
                return;
            }




            function MessagesForumsManger(TemprDepartment) {
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/GetManagers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;

                    },

                    success: function (data) {
                        MangerObj = JSON.parse(data.d); //or data["d"]
                        GetDepartmentsMassaging(MangerObj, TemprDepartment);
                    }
                });

            }

            function GetDepartmentsMassaging(MangerObj, TemprDepartment) {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'ID':'" + ID + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        MassagingObj = JSON.parse(data.d); //or data["d"]
                        MassagingForumss(MassagingObj, MangerObj, TemprDepartment);
                    }
                });

            }

            function MassagingForumss(MassagingObj, MangerObj, TemprDepartment) {
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({

                    url: WebServiceURL + "/GetWorkers",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",

                    data: "{'WorkerName':'" + WorkerName + "','PassWord':'" + PassWord + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {

                    },

                    success: function (data) {
                        OriginalWorkersObj = JSON.parse(data.d); //or data["d"]
                        Firstdatearraycounter = 0;
                        var k = 0;
                        var l = 0;
                        var j = 0;
                        var p = 0;
                        var y = 0;
                        var i = 0;
                        var q = 0;
                        var QuotedMemberID = 0;
                        var QuotedMember;
                        var flag = false;
                        var flag2 = false;
                        var flag3 = false;
                        var flag4 = false;
                        var flagmanger = false;
                        if (Firstdate == true) {
                            $("#MessagesTable").empty();
                        }
                        var WorkersNames = "";
                        var Nametemp = "";

                        var min = 0;
                        var minday = 0
                        var minmonth = 0
                        var minyear = 0
                        var minsec = 0
                        var minin = 0
                        var minhour = 0

                        var tempnum = 0;
                        var tempnumday = 0
                        var tempnumonth = 0
                        var tempnumyear = 0
                        var tempnumsec = 0
                        var tempnummin = 0
                        var tempnumhour = 0


                        var tempname = 0;
                        var TempTopic = "";
                        var temptext = "";
                        var tempWorkersObj;
                        var content = "";
                        var Message_datetime = "";
                        var TempID = 0;
                        var MessageID = 0;
                        var TopicID = 0;
                        var TopicMessageID = 0;
                        var Topicdatetime = "";
                        var nextId = 1;
                        var nextId2 = 100;
                        var nextId3 = 1000;
                        var nextId4 = 10000;
                        var nextId5 = 100000;
                        var counter = 0;
                        var mul = 1;
                        var nextId6 = 1000000;
                        var something;
                        var TempTopicID = 0;
                        var QuotedMemberID = 0;
                        var flagQuote = false;
                        var flagTopic = false;
                        var tempdates = 0;
                        var d = 0;
                        var TempWorkerDepartment = TemprDepartment;


                        content += "<div data-role=content>"
                        for (var u = (MassagingObj.length - 1) ; u != -1; u--) {
                            if (MassagingObj[u].Department == TempWorkerDepartment) {

                                flag3 = true;
                                TempTopic = MassagingObj[u].Message_Topic;
                                TempTopicID = MassagingObj[u].Message_ID;




                                //האם הודעת פתיח
                                if (flag2 == false && MassagingObj[u].Topic == true) {


                                    TopicID = MassagingObj[u].ID;
                                    TopicMessageID = MassagingObj[u].Message_ID;
                                    Topicdatetime = MassagingObj[u].Message_datetime;
                                    temptext = MassagingObj[u].Message_datetime;
                                    flagQuote = true;
                                    flagTopic = true;


                                    for (y = 0; y < OriginalWorkersObj.length; y++) {
                                        if (OriginalWorkersObj[y].ID == TopicID) {
                                            tempname = OriginalWorkersObj[y].WorkerName;
                                            break;
                                        }
                                    }

                                    for (y = 0; y < MangerObj.length; y++) {
                                        if (MangerObj[y].ID == TopicID && MassagingObj[u].Manger == true) {
                                            tempname = MangerObj[y].MangerName;
                                            flagmanger = true;
                                            break;
                                        }
                                    }



                                    if (flagmanger == true && MassagingObj[u].ID == MangerOfficalID) {
                                        content += "</p><div data-role=collapsible><h1>" + tempname + "<br> מנהל" + "<br>" + MassagingObj[u].Message_Topic + "<br>" + MassagingObj[u].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + temptext + "><br>";
                                    }

                                    if (flagmanger == true && MassagingObj[u].ID != MangerOfficalID) {
                                        content += "</p><div data-role=collapsible><h1>" + tempname + "<br> מנהל" + "<br>" + MassagingObj[u].Message_Topic + "<br>" + MassagingObj[u].Message_datetime + "</h1><p><br> value= " + temptext + "<br>";
                                    }

                                    if (flagmanger == false) {
                                        content += "</p><div data-role=collapsible><h1>" + tempname + "<br>" + MassagingObj[u].Message_Topic + "<br>" + MassagingObj[u].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + temptext + "><br>";
                                    }
                                    flagmanger = false;;
                                    //content += "</p><div data-role=collapsible><h1>" + tempname + "<br>" + "<br>" + WorkersObj[p].Message_datetime + "</h1><p><br> <input type=" + "radio" + " name=" + "ClassMessage" + " value= " + temptext + "><br>" + WorkersObj[p].Message_Content + "<br><br><br><br>" +
                                    //   "<input type=textarea  id=" + nextId2 + " placeholder=" + "הכנס-הודעה" + " />" + "<br>" + "<br>";
                                    content += MassagingObj[u].Message_Content + "</h3><br><br><br><br>";
                                    if (ID == TopicID && MassagingObj[u].Manger == true) {
                                        content += "<button type=button onclick=UpdateOrDeletePage(" + flagTopic + "," + MassagingObj[u].Departments_MessagesID + "," + TopicID + "," + TopicMessageID + ",'" + Topicdatetime + "');>" + "ערוך או מחק הודעה" + "</button>";
                                    }

                                    if (ID == TempID && MassagingObj[u].Manger == true) {
                                        content += "<button type=button onclick=UpdateOrDeletePage(" + flagTopic + "," + MassagingObj[u].Departments_MessagesID + "," + MassagingObj[u].Departments_MessagesID + "," + TempID + "," + MessageID + ",'" + Message_datetime + "');>" + "ערוך או מחק הודעה" + "</button>";
                                    }

                                    content += "<br></div><br>";

                                    flagmanger = false;;

                                    //"<button type=button onclick=GetDMessagesID4replay(" + flagQuote + "," + "document.getElementById(" + nextId2 + ").value" + "," + TempID + "," + MessageID + ",'" + Message_datetime + "');>" + "הגב  להודעה " + "</button>" +


                                    nextId2++;
                                    counter++;
                                    flag2 = true;
                                    tempnum = "";
                                    min = "";
                                    l = 0;
                                    flagmanger = false;
                                    flag = false;
                                    k = 0;
                                    j = 0;
                                    nextId3 = nextId3 + 1
                                    nextId2 = nextId2 + 1;
                                    nextId6 = nextId6 + 1;
                                    tempnum = "";
                                    min = "";
                                    l = 0;
                                    flag = false;
                                    flagTopic = false;

                                    //}

                                    flag2 = false;
                                    flag3 = false;
                                }
                            }
                        }

                        if (Firstdate == true) {
                            $("#MessagesTable").append(content).collapsibleset('refresh');
                        }
                        Firstdate = true;
                    }
                });
            }




            //פונקציה ששולפת נתוני עובד
            function WorkersInfoManger() {
                $.mobile.changePage('#WorkersInfo',{ 'transition': 'none' });;
                $.mobile.changePage('#WorkersInfo',{ 'transition': 'none' });;
                GetDepartmentForumsManger();
            }



            function UpdateDepartmentsMassagingsManger(Message_datetime, Departments_MessagesID, MessageDepartment) {


                var Message_Content = $("#TextArea").val();
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/UpdateDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",
                    data: "{'ID':'" + Departments_MessagesID + "','Message_Content':'" + Message_Content + "','Message_datetime':'" + Message_datetime + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                        Message_Content = "";
                        $("#TextArea").val(Message_Content);
                        $("#MessagesTable").empty();
                        DepartmentForumManger();
                    }
                });
            }


            //מחפש תעודת זהות

            function FlagUpdateManger() {
                var FlagUpdate = true;
                GetMassagingIDforDeleate(FlagUpdate);
            }

            function FlagDeleteManger() {
                var FlagUpdate = false;
                GetMassagingIDforDeleate(FlagUpdate);
            }

            function GetMassagingIDforDeleate(FlagUpdate) {
                var flagend = false;
                var Departments_MessagesID = 0;
                var Message_datetime = $('input[name="ClassMessage"]:checked').val();
                var MessageDepartment;
                for (var i = 0; i < Firstdatearraycounter; i++) {
                    if (Message_datetime == Firstdatearray[i]) {
                        flagend = true;
                        break;
                    }
                }
                if (flagend == true) {
                    return;
                }
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + Departments_MessagesID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (WorkersObj[i].Message_datetime == Message_datetime) {
                                Departments_MessagesID = WorkersObj[i].Departments_MessagesID;
                                MessageDepartment = WorkersObj[i].Department;
                                break;
                            }

                        }
                        if (FlagUpdate == true) {
                            UpdateDepartmentsMassagingsManger(Message_datetime, Departments_MessagesID, MessageDepartment);
                        }

                        if (FlagUpdate == false) {
                            //שולח את התאריך ואת המחלקה
                            DeleteDepartmentsMassagingManger(Message_datetime, Departments_MessagesID, MessageDepartment);
                        }
                    }

                });
            }



            //פונקצייה למחיקת הודעה לפי תאריך,זמן ותעודת זהות
            function DeleteDepartmentsMassagingManger(Message_datetime, Departments_MessagesID, MessageDepartment) {

                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/DeleteDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",
                    data: "{'ID':'" + Departments_MessagesID + "','Message_datetime':'" + Message_datetime + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                        CountMessagesManger(MessageDepartment);
                    }
                });
            }

            ////סופר מספר הודעות עדכני
            function CountMessagesManger(MessageDepartment) {
                var Number_Of_Message = 0;
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (MessageDepartment == WorkersObj[i].Department) {
                                Number_Of_Message++;
                            }
                        }
                        UpdateDepartmentMessagesManger(MessageDepartment, Number_Of_Message);
                    }

                });
            }



            //מעדכן מספר הודעות במחלקה
            function UpdateDepartmentMessagesManger(MessageDepartment, Number_Of_Message) {
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/UpdateDepartmentMessages",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'Department':'" + MessageDepartment + "','Number_Of_Message':'" + Number_Of_Message + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        DepartmentForumManger();
                    }

                });
            }



            /////////////////////////////////////////////////////////////////////////////////שליחת הודועת
            //הודעה פרטית

            function PrePrivatePage() {
                var TempID = $("#DepartmentsForumsManger").val();
                if (ID == TempID || TempID == 100) {
                    return;
                }
                var MessageID = null;
                var Message_datetime = null;
                var flagQuote = false;
                PrivatePage(flagQuote, TempID, MessageID, Message_datetime)
            }


            function PrivatePage(flagQuote, TempID, MessageID, Message_datetime) {
                //TempID, MessageID, Message_datetime,
                if (ID == TempID || TempID == 100) {

                    return;
                }
                $.mobile.changePage('#SendPrivate',{ 'transition': 'none' });;
                $.mobile.changePage('#SendPrivate', { 'textID': 'flip' });
                $("#Message_datetime").html(Message_datetime);
                $("#Message_datetime").hide();
                $("#MessageIDManger").html(MessageID);
                $("#MessageIDManger").hide();
                $("#textQoute").html(flagQuote);
                $("#textQoute").hide();
                $("#textID").html(TempID);
                $("#textID").hide();
                return;
            }

            function SendPrivateMessage() {
                var Message_Content = $('#AreaTextsPrivateManger').val();
                var MessageID = $('#textIDManger').text();
                var MessageDepartment;
                var NumberOfMessages = 0;
                var TempID = ID;
                var Private_Message = true;
                var Quoted_Message = null;
                var flagQuote = "";
                var flagQuote = $('#textQoute').text();
                var Message_datetime = $('#Message_datetime').text();
                         var WebServiceURL = "Enterence.asmx";
                $.ajax({
                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (WorkersObj[i].ID == MessageID && WorkersObj[i].Message_ID == ID && flagQuote == "true" && WorkersObj[i].Private_Message == true) {
                                Quoted_Message = WorkersObj[i].Message_Content;
                                MessageDepartment = WorkersObj[i].Department
                                break;
                            }

                        }
                        var Message_Topic = null
                        flag = false;
                        var Topic = false;
                        AddDMessagesManger(Private_Message, TempID, MessageID, Quoted_Message, Message_Topic, Message_Content, MessageDepartment, Topic);
                    }

                });
            }







            //הודעות פרטיות
            //function GetDPrivate4replay(TempID, MessageID, Message_datetime) {
            //    return;
            //    var Quoted_Message = null;
            //    var Private_Message = true;
            //    var Message_Topic = "";
            //        var WebServiceURL ="http://ruppinmobile.ac.il.preview26.livedns.co.il/site08/Enterence.asmx"";

            //    $.ajax({

            //        url: WebServiceURL + "/GetDepartmentsMassaging",
            //        dataType: "json",
            //        type: "POST",   //use only POST!
            //        data: "{'ID':'" + ID + "'}",
            //        contentType: "application/json; charset=utf-8",
            //        error: function (jqXHR, exception) {
            //            debugger;
            //        },
            //        success: function (data) {
            //            WorkersObj = JSON.parse(data.d); //or data["d"]
            //            for (var i = 0; i < WorkersObj.length; i++) {
            //                if (WorkersObj[i].ID == TempID && WorkersObj[i].Message_ID == MessageID && WorkersObj[i].Message_datetime == Message_datetime) {
            //                    Quoted_Message = WorkersObj[i].Message_Content;
            //                    MessageDepartment = WorkersObj[i].Department;
            //                    break;
            //                }

            //            }
            //            flag = true;
            //            var Topic = false;
            //            AddDMessagesManger(Private_Message, TempID, MessageID, Quoted_Message, Message_Topic, Message_Content, MessageDepartment, Topic);
            //            return;
            //        }

            //    });
            //}






            function GetDMessagesID4replay(flagQuote, Message_Content, TempID, MessageID, Message_datetime) {

                var Quoted_Message = null;
                var Message_Topic = "";
                var MessageDepartment = "";
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (WorkersObj[i].Departments_MessagesID == MessageID) {
                                MessageDepartment = WorkersObj[i].Department;

                                Message_Topic = WorkersObj[i].Message_Topic;
                                if (flagQuote == true) {
                                    Quoted_Message = WorkersObj[i].Message_Content;
                                }
                                break;
                            }
                        }

                        var Private_Message = false;
                        flag = true;
                        var Topic = false;
                        AddDMessagesManger(Private_Message, TempID, MessageID, Quoted_Message, Message_Topic, Message_Content, MessageDepartment, Topic);
                        return;
                    }

                });
            }



            function GetDMessagesIDManger() {
                var Message_ID = MangerOfficalID;


                var DepartmentID = $("#DepartmentSelectForums").val();


                if (DepartmentID == 0) {
                    $('#DepartmentForumsMangerError').html("שגיאה,בחר מחלקה");
                    return;
                }


                var Message_Topic = $("#textTopicManger").val();
                var Message_Content = $("#AreaTextsManger").val();
                if (Message_Topic == "" || Message_Content == "")
                {
                    $('#DepartmentForumsMangerError').html("לא ניתן לשלוח הודעה עם תוכן או נושא ריק");
                    return;
                }
                         var WebServiceURL = "Enterence.asmx";
                var MessageDepartment;
                $.ajax({

                    url: WebServiceURL + "/GetDepartment",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        $('#DepartmentForumsError').html("שגיאה בהכנסת הודעה");
                        debugger;
                    },
                    success: function (data) {

                        DepartmentObj = JSON.parse(data.d); //or data["d"]
                        for (var j = 0; j < DepartmentObj.length; j++) {
                            if (DepartmentID == DepartmentObj[j].DepartmentID) {
                                MessageDepartment = DepartmentObj[j].Department
                            }
                        }

                        var Private_Message = false;
                        var Quoted_Message = null;
                        var TempID = 0;
                        flag = true;
                        var Topic = true;
                        AddDMessagesManger(Private_Message, TempID, Message_ID, Quoted_Message, Message_Topic, Message_Content, MessageDepartment, Topic);
                        return;
                    }

                });
            }

            function AddDMessagesManger(Private_Message, TempID, MessageID, Quoted_Message, Message_Topic, Message_Content, MessageDepartment, Topic) {
                         var WebServiceURL = "Enterence.asmx";
                var Departments_MessagesID = 1;
                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + Departments_MessagesID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        $('#DepartmentForumsError').html("שגיאה בהכנסת הודעה");
                        debugger;
                    },
                    success: function (data) {

                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (i = 0; i < WorkersObj.length; i++) {
                            if (Departments_MessagesID <= WorkersObj[i].Departments_MessagesID) {
                                Departments_MessagesID  = WorkersObj[i].Departments_MessagesID
                                Departments_MessagesID++;
                            }
                        }
                        AddDMessagesToTable(Private_Message, TempID, MessageID, Quoted_Message, Message_Topic, Message_Content, MessageDepartment, Departments_MessagesID, Topic);
                        return;
                    }

                });
            }




            //מוסיף הודעה
            function AddDMessagesToTable(Private_Message, TempID, MessageID, Quoted_Message, Message_Topic, Message_Content, MessageDepartment, Departments_MessagesID, Topic) {
                var Unread = false;
                var DepartmentID = 0;
                if (flag == true) {
                    //UntrueMessages();
                    Unread = true;
                }
                var Reported = false;
                var TempDepartment = "";
                if (TempID == 0) {
                    Message_Content = $("#AreaTextsManger").val();
                    Message_Topic = $("#textTopicManger").val();
                }

                         var WebServiceURL = "Enterence.asmx";

                for (var i = 0; i < namescounter; i = i + 10) {
                    if (TempID == names[i]) {
                        TempDepartment = names[i + 3];
                        DepartmentID = names[i + 9];
                        break;
                    }
                }

                $.ajax({

                    url: WebServiceURL + "/AddDMessages",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + MangerOfficalID + "','Message_ID':'" + MessageID + "','Department':'" + MessageDepartment + "','Message_Content':'" + Message_Content + "','Quoted_Message':'" + Quoted_Message + "','Message_Topic':'" + Message_Topic + "','Private_Message':'" + Private_Message + "','Reported':'" + Reported + "','Unread':'" + Unread + "','Departments_MessagesID':'" + Departments_MessagesID + "','Topic':'" + Topic + "','DepartmentID':'" + DepartmentID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        $('#DepartmentForumsError').html("שגיאה בהכנסת הודעה");
                        debugger;
                    },
                    success: function (data) {
                        debugger;
                        $('#DepartmentForumsError').html("");
                        SetID(Departments_MessagesID, MessageDepartment);
                        MangerMessage(Departments_MessagesID);
                        CountMessagesManger(MessageDepartment);
                        $("#MessagesTable").empty();
                        MessagesForumsManger(MessageDepartment);
                        DepartmentForumManger();
                        return;
                    }

                });
            }


            //מעדכן שהודעת מנהל
            function MangerMessage(Departments_MessagesID) {
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/MangerMessage",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + Departments_MessagesID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                    }

                });
            }




            //מעדכן מספר הודעות במחלקה
            function UpdateDepartmentMessages(MessageDepartment, Number_Of_Message) {
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/UpdateDepartmentMessages",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'Department':'" + MessageDepartment + "','Number_Of_Message':'" + Number_Of_Message + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                    }

                });
            }





            //////////////////////////////////////////////////////////////////////////////////עדכון הודעה
            //דף עדכון הודעה
            function UpdateOrDeletePageManger(flagTopic, DepartmentsMessagesID, TempID, MessageID, Message_datetime) {
                if (flagTopic == false) {
                    $.mobile.changePage('#UpdateOrDeletePageManger',{ 'transition': 'none' });;
                    $.mobile.changePage('#UpdateOrDeletePageManger',{ 'transition': 'none' });;
                }

                if (flagTopic == true) {
                    $("#DepartmentsMessagesID").val(DepartmentsMessagesID);
                    $("#DepartmentsMessagesID").hide();
                    $.mobile.changePage('#UpdateOrDeletePageWithTopicManger',{ 'transition': 'none' });;
                    $.mobile.changePage('#UpdateOrDeletePageWithTopicManger',{ 'transition': 'none' });;
                }
                $("#textDateManger").empty();
                $("#AreaTexts4updateManger").empty();
                var Message_Content = "";
                var Message_Topic = "";
                         var WebServiceURL = "Enterence.asmx";

                $.ajax({

                    url: WebServiceURL + "/GetDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    data: "{'ID':'" + ID + "'}",
                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                    },
                    success: function (data) {
                        WorkersObj = JSON.parse(data.d); //or data["d"]
                        for (var i = 0; i < WorkersObj.length; i++) {
                            if (WorkersObj[i].Departments_MessagesID == DepartmentsMessagesID) {
                                Message_Content = WorkersObj[i].Message_Content;

                                if (flagTopic == true) {
                                    Message_Topic = WorkersObj[i].Message_Topic;
                                    $("#textUpdateTopicManger").val(Message_Topic);
                                    $("#textDate2Manger").html(Message_datetime);
                                    $("#AreaTexts4update2Manger").html(Message_Content);
                                    return;
                                }
                                break;
                            }

                        }
                        $("#textDateManger").html(Message_datetime);
                        $("#AreaTexts4updateManger").html(Message_Content);
                        return;
                    }

                });
            }



            //עדכון תגובה רגילה
            function UpdateDepartmentsMassaging() {
                var Message_datetime = $('#textDateManger').text();
                var Message_Content = $("#AreaTexts4updateManger").val();
                         var WebServiceURL = "Enterence.asmx";
                debugger;
                $.ajax({

                    url: WebServiceURL + "/UpdateDepartmentsMassaging",
                    dataType: "json",
                    type: "POST",   //use only POST!
                    // data: "{'num':'" + num + "' }",
                    data: "{'ID':'" + ID + "','Message_Content':'" + Message_Content + "','Message_datetime':'" + Message_datetime + "'}",

                    contentType: "application/json; charset=utf-8",
                    error: function (jqXHR, exception) {
                        debugger;
                        debugger;
                    },

                    success: function (data) {
                        debugger;
                        WorkersInfoManger();
                        $("#MessagesTable").empty();
                        MessagesForums();
                    }
                });
            }





            //ניקוי פורום
            function ForumsCleaning() {
                Firstdatearraycounter = 0;
                $("#MessagesTable").empty();
            }




            ////////////////////////////////////////////////////////////////////
            function ExitApp() {
                navigator.app.exitApp();
            }


            function MangerEnterence() {
                $.mobile.changePage('#MangerEnterence',{ 'transition': 'none' });;
            }

            ///"דו"ח  עובדים


            function ReportCleaningManger() {
                $("#ReportTables").empty();
            }

            function ReportEventsTableManger() {
                flag = false;
                VacationsReportEventsTableManger();
                return;
            }



            function VacationUpdatessClean() {
                $("#VacationLegalornot2").html(" ");
                $("#VacationsKind").val("");
                $("#Vacations2Yearss").val("");
                $("#Vacations2Yearsends").val("");
                $("#VacationsSTatus").val("");

            }


            //function MainPageManger() {
            //    $.mobile.changePage('#IndexPageManger',{ 'transition': 'none' });;
            //   // $.mobile.changePage('#IndexPageManger',{ 'transition': 'none' });;
            //}

            //מראה הודעת שגיאה במידה ולא מצליח להתחבר לדטה בייס

            function formatErrorMessage(jqXHR, exception) {
                if (jqXHR.status === 0) {
                    return ('Not connected.\nPlease verify your network connection.');
                } else if (jqXHR.status == 404) {
                    return ('The requested page not found. [404]');
                } else if (jqXHR.status == 500) {
                    return ('Internal Server Error [500].');
                } else if (exception === 'parsererror') {
                    return ('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    return ('Time out error.');
                } else if (exception === 'abort') {
                    return ('Ajax request aborted.');
                } else {
                    return ('Uncaught Error.\n' + jqXHR.responseText);
                }
            }

            $(document).ready(function () {
                $("div").scroll(function () {
                    $("span").text(x += 1);
                });
            });


        </script>

</head>



<!--דפי HTML-->
<body>
    <!--<!--דפי עובד-->
    <!-- This is the first page -->
    <div id="firstpage" data-role="page">
        <div data-role="header">
            <h1>
               Info
            </h1>
        </div>
        <div data-role="content">
            <form action="">
                <label for="fpInputNameId">הכנס מייל :</label>
                <input type="text" id="fpInputNameId" name="fpInputName" placeholder="insert your mail" />


                <div data-role="fieldcontain">
                    <label for="fpInputName3">הכנס ססמא:</label>
                    <br>

                    <input type="password" id="fpInputName3" name="fpInputName3" placeholder="password" />
                </div>

                <br>


            </form>

            <br>
            <label id="LoginError"></label>

            <br>

        </div>
        <div data-role="footer" class="ui-bar" data-position="fixed">
            <a href="#" id="loginBTN" data-icon="grid">היכנס</a>
        </div>
    </div>


    <div id="IndexPage" data-role="page">
        <div data-role="header">
            <a data-icon="home" class="ui-btn-right" onclick=Exit();>חזור לעמוד ההתחברות</a>
            <br />
            <br />
            Current Date:
            <label  data-icon="clock"  id="Times1"></label> Current Time:<br /><label data-icon="clock" id="Times2"></label>
            <br>
            <br>
            <label id="DistenceOrNOT"></label>
            <br>

        </div>
        <br>


        <!--<button id="myBtn" onclick=IDEvents();>התחל עבודה</button>

        <br>
        

        <button id="myBtn2" onclick=UpdateEvents();>עדכן סיום עבודה</button>

        <br>
        -->

        <label id="Distence"></label>

        <button data-icon="cloud" id="myBtn7" onclick=VacationsPage();>חופשות</button>
        <br>

        <button data-icon="navigation" id="myBtn8" onclick=WorkStatus();>עדכון נוכחות בעבודה</button>

        <br>

        <!--<button id="myBtn4" onclick=getLocation2();>בדוק מיקום</button>


        <brWorkersInfo()
        -->

        <button data-icon="comment"  id="myBtn5" onclick=WorkersInfo();>פורום מחלקה</button>
        <br>
        

        <button data-icon="info" id="myBtn6" onclick=VacationsReport();>תצוגת דו"ח עובד</button>
        <br>


        <!--<button id="myBtn6" onclick=ReportEvents();>תצוגת ד"וח עובד</button>-->


        <!--<div data-role="header">
            <a onclick=ConnectEvents();>צור קשר</a>
        </div>
        <br>
        
        <br>
        
        <br>
        -->

        <div data-role="footer">
            <br />


            <label id="Times3"></label>
            <br />
            <div data-role="footer" class="ui-bar" data-position="locked">
                <a data-icon="phone" onclick=ConnectManger();>צור קשר עם מנהל חברה</a>
            </div>
        </div>
    </div>

    <div id="WorkersInfo" data-role="page">
        <div data-role="header">
            <a data-icon="back" onclick=MainPage();>חזור לדף הראשי </a>
            <br />
            <br />
            <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
            Current Date:
            <label data-icon="clock" id="WorkersInfoTimes1"></label> Current Time:<br /><label data-icon="clock" id="WorkersInfoTimes2"></label>
            <br>
            <div data-role="navbar">
                <ul>

                    <li>
                        <a data-icon="user" onclick=UserDetails();>פרטי עובד </a>

                    </li>
                    <li>

                        <a data-icon="comment" onclick=MessagesForums();>פורום </a>
                    </li>
                    <li>
                        <a data-icon="action" onclick=MessagsCleaning();>ניקוי </a>
                    </li>
                    <li>
                        <a data-icon="arrow-u" onclick=MessageOld2New();>ישן לחדש</a>
                    </li>
                    <li>
                        <a data-icon="arrow-d" onclick=MessagNew2Old();>חדש לישן</a>
                    </li>
                </ul>
            </div>
        </div>

        <div data-role="content">
            <h3>פורום מחלקת:</h3>
            <div data-role="collapsible-set" id="Departmentname"></div>
        </div>


        <select id="DepartmentsForums">בחר עובד </select>
        <br>

        <label for="SearchMessages"></label>
        <input type="text" id="SearchMessages" name="SearchMessages" placeholder="הכנס הודעה לחיפוש...." />
        <br>
        <br>

        <label for="ByYear">תאריך הודעה:</label>
        <input type="date" id="ByYear" value="תאריך הודעה">
        <br>


        <div data-role="content">
            <div data-role="collapsible-set" id="ForumsMessagesTable"></div>
        </div>
        <br>





        <div data-role="footer" class="ui-bar" data-position="locked">
            <div data-role="navbar">
                <ul>

                    <li>
                        <a data-icon="edit" onclick=CreateTopicPage();>צור הודעה </a>

                    </li>
                    <li>

                        <a data-icon="alert" onclick=LoadtextWorker();>דווח </a>
                    </li>
                    <li>

                        <a data-icon="search" onclick=SearchMessages();>חפש הודעה</a>
                    </li>
                    <li>
                        <a data-icon="action" onclick=TextCleaning();>נקה חיפוש</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div id="CreateTopicPage" data-role="page">
        <div data-role="header">
            <a data-icon="back" onclick=BackToman();>חזור לפורום</a>
            <!--<h1>צור הודעה לפורום מחלקה</h1>-->
        </div>
        <div data-role="content">
            <form action="">
                <br>
                <label id="DepartmentForumsError"></label>
                <fieldset data-role="fieldcontain" style="border:1px solid black;padding:5px;">
                    <legend>צור הודועה:</legend>
                    <label for="text">כותרת הודעה:</label>
                    <input type="text" id="textTopic" name="text" placeholder="הכנס טקסט" />
                    <br>

                    <textarea id="AreaTexts" name="AreaText" placeholder="הכנס הודעה"></textarea>
                </fieldset>
            </form>
        </div>
        <div data-role="footer" class="ui-bar" data-position="fixed">
            <a data-icon="edit" onclick=GetDMessagesID(); >צור הודעה חדשה</a>
        </div>
    </div>


    <div id="SendPrivate" data-role="page">
        <div data-role="header">
            <a onclick=WorkersInfoManger();>חזור לפורום</a>
            <h1>שליחת הודעה פרטית</h1>
        </div>
        <div data-role="content">
            <form action="">
                <label id="Message_datetime" for="text"></label>
                <label id="textID" for="text"></label>
                <label id="textQoute" for="text"></label>
                <label id="MessageID" for="text"></label>
                
                <fieldset data-role="fieldcontain" style="border:1px solid black;padding:5px;">

                    <textarea id="AreaTextsPrivate" name="AreaText" placeholder="הכנס הודעה"></textarea>
                </fieldset>
            </form>
        </div>
        <div data-role="footer" class="ui-bar" data-position="fixed">
            <a onclick=SendPrivateMessage();> שלח הודעה</a>
        </div>
    </div>


    <div id="UpdateOrDeletePage" data-role="page">
        <div data-role="header">
            <a onclick=WorkersInfoManger();>חזור לפורום</a>
            <h1>ערוך הודעה</h1>
        </div>
        <div data-role="content">
            <form action="">
                <fieldset data-role="fieldcontain" style="border:1px solid black;padding:5px;">
                    <legend>הודעה לעריכה:</legend>
                    <br>
                    <label id="textDate" for="text">תאריך הודועה:</label>
                    <br>
                    <br>
                    <!--<label for="number">Number:</label>
                    <input type="number" id="number" name="number" placeholder="insert number" />
                    <label for="email">Email:</label>
                    <input type="email" id="email" name="email" placeholder="insert email" />
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" placeholder="insert date" />
                    <label for="search">Search:</label>
                    <input type="search" id="search" name="search" placeholder="insert search" />
                    <label for="textarea">Textarea:</label>-->
                    <textarea id="AreaTexts4update" name="AreaText" placeholder="הכנס הודעה"></textarea>
                </fieldset>
            </form>
        </div>
        <div data-role="footer" class="ui-bar" data-position="fixed">
            <a onclick=UpdateDepartmentsMassaging();>עדכן הודעה</a>
            <a onclick=Search4Last();>מחק הודעה</a>
        </div>
    </div>
   

    <div id="UpdateOrDeletePageWithTopic" data-role="page">
        <div data-role="header">
            <a onclick=WorkersInfoManger();>חזור לפורום</a>
            <h1>ערוך או מחק הודעה</h1>
        </div>
        <div data-role="content">
            <form action="">
                <label id="DepartmentsMessagesID"></label>
                <fieldset data-role="fieldcontain" style="border:1px solid black;padding:5px;">
                    <legend>הודעה לעריכה:</legend>
                    <br>
                    <label id="textDate2" for="text">תאריך הודעה:</label>
                    
                    <br>
                    <label for="text">נושא הודעה:</label>
                    <input type="text" id="textUpdateTopic" name="textUpdateTopic" placeholder="הכנס טקסט" />
                    <br>
                    <br>

                    <textarea id="AreaTexts4update2" name="AreaText" placeholder="הכנס הודעה"></textarea>
                </fieldset>
            </form>
        </div>
        <div data-role="footer" class="ui-bar" data-position="fixed">
            <a onclick=UpdateWithTopic();>עדכן הודעה</a>
            <a onclick=Search4LasTopic();>מחק הודעה</a>
        </div>
    </div>



  

    <div id="Report" data-role="page">
        <div data-role="header">
            Current Date:
            <label data-icon="clock" id="ReportTimes1"></label> Current Time:<br /><label data-icon="clock" id="ReportTimes2"></label>
        </div>

        <div data-role="header">
            <a  class="ui-btn-right" data-icon="back" onclick=BackToman();>חזור לדך הראשי</a>
            <br />
            <br />
            <!-- <!--<a onclick=Exit();> צא מאפליקציה</a>-->-->
            <a data-icon="action" onclick=ReportCleaning();>נקה תוכן</a>
            <br>
            <br>

        </div>
        <br >

        <div data-role="content">
            <form action="">
                <br>
                <label id="ReportFailedOrNot"></label>
                    
                <label for="ReportYears"></label>
                <input type="text" id="ReportYears" name="ReportYears" placeholder="insert year" />
                <br>
                


                <p>
                    <select data-icon="calendar" id="Months2" name="בחר חודש" onchange=ReportEvents2Manger();>
                        <option value="00">בחר חודש</option>
                        <option value="01">ינואר</option>
                        <option value="02">פבואר</option>
                        <option value="03">מרץ</option>
                        <option value="04">אפריל</option>
                        <option value="05">מאי</option>
                        <option value="06">יוני</option>
                        <option value="07">יולי</option>
                        <option value="08">אוגוסט</option>
                        <option value="09">ספטמבר</option>
                        <option value="10">אוקטובר</option>
                        <option value="11">נובמבר</option>
                        <option value="12">דצמבר</option>

                    </select>

                    <div data-role="fieldcontain">
                        <label for="fpInputName3">טבלת עבודה שנתית לפי חודשים:</label>
                        <br>
                        
                    </div>
                    <div id="StartHour"></div> <div id="FinishHour"></div>


                    <br>
                    
                    
                    <label for="something">סכום שעות כולל של עובד:</label>
                    <div id="SumHours"></div> <!--</li>-->
                    <br>

                    <br>
                    


                    <label for="something">סכום  כולל של ימי עבודה:</label>
                    <div id="SumDays"></div> <!--</li>-->
                    <br>



                    <label for="something">מספר איחורים:</label>
                    <div id="SumLates"></div> <!--</li>-->
                    <br>


            </form>


        </div>
    </div>



    <div id="Vacations" data-role="page">
        <div data-role="header">
            <h1>
            </h1>
            <a class="ui-btn-right" data-icon="back" onclick=MainPage();>חזור לדך הראשי </a>
            <br />
            <br />
            <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
            Current Date:
            <label data-icon="clock" id="VacationsTimes1"></label> Current Time:<br /><label data-icon="clock" id="VacationsTimes2"></label>
        </div>




            <!-- <!--<a onclick=Exit();> צא מאפליקציה</a>-->
      
        <br />

        <div data-role="content">



               <!--<button id="VecationsR" onclick=VacationsReport();>ד"וח ימי חופש</button>
                <br>
                -->

                 <label id="VacationStaus"></label>

            <button data-icon="arrow-d-l" id="VecationsM" onclick=VacationsUpdates();>הגש בקשת ימי חופשה</button>
                <br>
            <!--VacationsUpdates();-->

            <!--<button id="VecationsDelete" onclick=VacationDeleteSelect();>מחיקת בקשות חופשה</button>
            <br>-->

            <button data-icon="gear" id="VecationsU" onclick=VacationsUpdatess();>סטטוס וניהול בקשות חופשה</button>
            <br>


        </div>
    </div>



    <div id="VacationsReport" data-role="page">
        <div data-role="header">
            <a class="ui-btn-right" data-icon="back" onclick=BackToman();>חזור לדך הראשי</a>
            <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
            <br />
            <br />
            <!-- <!--<a onclick=Exit();> צא מאפליקציה</a>-->
            <br />
            <label id="VacationsReportStatus"></label>
            <h1>
            </h1>
            Current Date:
            <label data-icon="clock" id="VacationsReportTimes1"></label> Current Time:<br /><label data-icon="clock" id="VacationsReportTimes2"></label>
        </div>


        <div data-role="navbar">
            <ul>
                <li>
                    <a data-icon="action" onclick=ReportCleaning();>נקה תוכן </a>
                </li>
            </ul>
        </div>

        <div data-role="content">
            <form action="">

                <br>
                <label for="Yearstring"></label>
                <input type="text" id="Yearstring" name="Yearstring" placeholder="insert year" />
                <br>

                <p>
                    <select id="Moneths2" name="בחר חודש" onchange=ReportEvents2();>
                        <option value="00">בחר חודש</option>
                        <option value="01">ינואר</option>
                        <option value="02">פבואר</option>
                        <option value="03">מרץ</option>
                        <option value="04">אפריל</option>
                        <option value="05">מאי</option>
                        <option value="06">יוני</option>
                        <option value="07">יולי</option>
                        <option value="08">אוגוסט</option>
                        <option value="09">ספטמבר</option>
                        <option value="10">אוקטובר</option>
                        <option value="11">נובמבר</option>
                        <option value="12">דצמבר</option>

                    </select>


            </form>

            <br>
            <div data-role="content">
                <div data-role="collapsible-set" id="WorkersSelect4"></div>
            </div>


            <div data-role="footer" class="ui-bar" data-position="locked">

                <div data-role="navbar">
                    <ul>
                        <li>

                            <a data-icon="calendar" onclick=ReportEventsTable();>טבלה</a>
                        </li>
                        <li>
                            <a data-icon="info" onclick=ReportDaily();>יומי</a>
                        </li>
                        <li>
                            <a data-icon="tag" onclick=Reportsums();>סיכום</a>
                        </li>
                        <li>
                            <a data-icon="cloud" onclick=VacationsReportEvents();> חופשות</a>
                        </li>
                    </ul>

                    <!--<a onclick=PrivatePage();>הצג פרטי חופשות מהישנות לחדשות</a>-->
                </div>
            </div>
        </div>
    </div>



        <div id="VacationUpdates" data-role="page">
            <div data-role="header">
                <h1>
                </h1>
                Current Date:
                <br />
                <br />
                <label data-icon="clock" id="VacationUpdatesTimes1"></label> Current Time:<br /><label data-icon="clock" id="VacationUpdatesTimes2"></label>
                <br>
                <a data-icon="back" class="ui-btn-right" onclick=BackToman();>חזור לעמוד החופשות </a>
                <br />
                <br />
                <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
            </div>


            <div data-role="content">
                <form action=""></form>


                <p>
                    <select id="Reasons" name="סיבת העדרות">
                        <option value="Sick">חופשת מחלה</option>
                        <option value="NormalVacation">חופשה כללית</option>
                    </select>



                    <label id="VacationStart">תאריך התחלת חופשה:</label>

                    <input type="date" id="Vacations2Years" value="הכנס תאריך התחלה">


                    <label id="VacationEnd">תאריך סיום חופשה:</label>
                    <input type="date" id="Vacations2Yearsend" value="הכנס תאריך סיום">

                    <br>
                </p>
                <div data-role="footer" class="ui-bar" data-position="locked">
                    <div data-role="navbar">
                        <ul>

                            <li>
                                <a data-icon="arrow-u-l" onclick=UpdatePresence();>שלח בקשת חופשה</a>
                            </li>
                        </ul>
                    </div>
                </div>

                <label id="VacationLegalornot"></label>
            </div>
        </div>







        <div id="VacationUpdatess" data-role="page">
            <div data-role="header">
                <h1>

                </h1>
                <br>
                Current Date:
                <label data-icon="clock" id="VacationUpdatessTimes1"></label> Current Time:<br /><label data-icon="clock" id="VacationUpdatessTimes2"></label>
                <br>
                <a class="ui-btn-right" data-icon="back" onclick=BackToman();>חזור לעמוד החופשות </a>
                <br />
                <br />
                <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
            </div>


            <div data-role="content">
                <form action=""></form>

                <select id="VacationUpdatesSelect" onchange=GetWorkerVacations();>בחר חופשה </select>
                <br>


                <p>
                    <select id="Reasonss" name="סיבת העדרות" onchange=ChangeVacationsKind();>
                        <option value="Sick">חופשת מחלה</option>
                        <option value="NormalVacation">חופשה כללית</option>
                    </select>


                    <label for="VacationsKind"></label>
                    <input type="text" id="VacationsKind" name="VacationsKind" placeholder="סוג חופשה" />
                    <br>

                    <label id="VacationLegalornot2"></label>
                    <br>



                    <label id="VacationStarts">תאריך התחלת חופשה:</label>
                    <input type="date" id="Vacations2Yearss" value="הכנס תאריך התחלה">

 
                    <label id="VacationEnds">תאריך סיום חופשה:</label>
                    <input type="date" id="Vacations2Yearsends" value="הכנס תאריך סיום">

                    <label id="OriginalStat_Date"></label>
                    <br>



                    <label for="VacationsSTatus"></label>
                    <input type="text" id="VacationsSTatus" name="VacationsSTatus" placeholder="מצב חופשה" />
                    <br>


                    <div data-role="navbar">

                        <div data-role="footer" class="ui-bar" data-position="locked">
                            <div data-role="navbar">
                                <ul>
                                    <li>
                                        <a data-icon="gear" onclick=UpdatePresences();>עדכן בקשה</a>
                                    </li>
                                    <li>
                                        <a data-icon="check" id="VecationStart" onclick=VacationsConfrimed();>אשרר  חופשה</a>
                                    </li>
                                    <li>
                                        <a data-icon="delete" id="VacationDeleteSelect" onclick=DeleteVacations();>מחק בקשה </a>
                                    </li>
                                </ul>
                                <br>
                            </div>


                        </div>
                    </div>
            </div>
        </div>






        <div id="WorkStatus" data-role="page">
            <div data-role="header">
                <h4>
                    <!--עדכון נוכחות-->
                </h4>

                Current Date:
                <br />
                <label data-icon="calendar" id="WorkStatusTimes1"></label>
                <br />
                Current Time:
                <br />
                <label data-icon="clock" id="WorkStatusTimes2"></label>

                <a class="ui-btn-right" data-icon="back" onclick=BackToman();>חזור לדף הראשי</a>
                <br />
                <br />
                <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>

            </div>
            <br>



            <button data-icon="location" id="myBtn" onclick=IDEvents();>התחל עבודה</button>

            <br>


            <button data-icon="clock" id="myBtn2" onclick=UpdateEvents();>עדכן סיום עבודה</button>

            <br>

            <label id="DistancefromWork"></label>

            <br>

            <br>

            <label id="StarWorking"></label>

            <br>

            <label id="EndWorking"></label>

            <div data-role="footer">
                <label id="WorkStatusTimes3"></label>
            </div>
        </div>



    <div id="ConnectManger" data-role="page">
        <div data-role="header">
            <h6>
                <!--יצירת קשר עם מנהל-->
            </h6>
            <br>
            Current Date:
            <label data-icon="clock" id="ConnectMangerTimes1"></label> Current Time:<br /><label data-icon="clock" id="ConnectMangerTimes2"></label>

            <a class="ui-btn-right" data-icon="back" onclick=BackToman();>חזור לדף הראשי</a>
            <br />
            <br />
            <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
            <br />

        </div>
        <div data-role="navbar">
            <ul>
                <li>
                    <a data-icon="gear" onclick=CleanManagers();> נקה תוכן</a>
                </li>
            </ul>
        </div>
        <br>
        <br>

                            <label id="ShowManagerses">בחירת מנהל ליצירת קשר:</label>
                            <br>
                            <select data-icon="user" id="MangerSelect" onchange=ShowManagers();>בחר מחלקה </select>
                            <br>
                            <label id="ShowManagers"></label>
</div>


                <!--דפי מנהל-->
                <div id="IndexPageManger" data-role="page">
                    <div data-role="header">
                        <a class="ui-btn-right" data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
                        <br />
                        <br>
                        <br>
                        Current Date:
                        <br />
                        <label id="TimesManger1"></label>
                        <br />
                        Current Time:
                        <br />
                        <label id="TimesManger2"></label>

                        <!--<a onclick=ExitApp();> צא מאפליקציה</a>-->
                    </div>
                    <br>

                    <button data-icon="cloud" id="myBtn4" onclick=VacationsManger();>ניהול חופשות עובדים</button>


                    <br>


                    <button data-icon="star" id="myBtn4" onclick=Departments();> ניהול מחלקות והודעות</button>


                    <br>



                    <button data-icon="user" id="myBtn5" onclick=WorkersStatus();>ניהול עובדים בחברה</button>

                    <br>



                    <button id="myBtn3" data-icon="location" onclick=DistencePageChange();>עדכן מרחק מינימלי מהעבודה</button>


                    <br>


                    <button data-icon="info" id="myBtn2" onclick=GetDepartmentSelect();>תצוגת דו"ח עובדים</button>

                    <br>



                    <div data-role="footer">
                        <p><br><br></p>

                        <br><br>
                        <br><br>

                    </div>
                </div>



                <div id="UPDistance" data-role="page">
                    <div data-role="header">

                        <div data-role="header">
                            <a data-icon="back" onclick=BackToIndexManger();>חזור לדף ראשי</a>
                            <br />
                            <br />
                            <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
                            <br>
                            Current Date:<label data-icon="clock" id="UPDistanceTimes1"></label> Current Time:<br /><label data-icon="clock" id="UPDistanceTimes2"></label>
                            <br>
                            <label id="UPDistanceStatus"></label>
                        </div>

                        <br>
                        <div data-role="Destination">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-location ui-btn-icon-notext"></a>
                            <br>

                            <input type="text" id="Destination" name="Destination" placeholder="הכנס יעד" />
                        </div>


                        <div data-role="Distance">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-navigation ui-btn-icon-notext"></a>
                            <br>


                            <input type="text" id="Distance" name="Distance" placeholder="הכנס מרחק מינימלי" />
                        </div>




                        <div data-role="Country">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-home ui-btn-icon-notext"></a>
                            <br>


                            <input type="text" id="Country" name="Country" placeholder="הכנס ארץ" />
                        </div>


                        <div data-role="footer" class="ui-bar" data-position="locked">
                            <div data-role="navbar">
                                <ul>
                                    <li>
                                        <a data-icon="info" id="something" onclick=codeAddress();>צפה במיקום</a>
                                    </li>
                                </ul>

                            </div>
                        </div>
                    </div>
                </div>


                <div id="ReportManger" data-role="page">
                    <div data-role="header">
                        <h1>
                            <!--דו"ח עובד נבחר-->
                        </h1>

                        <a class="ui-btn-right" data-icon="back" onclick=BackToIndexManger();>חזור לדף הראשי</a>

                        <br />
                        <br />
                        <!--<a onclick=Exit();> צא מאפליקציה</a>-->
                        <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
                        <br>
                        Current Date:<label data-icon="clock" id="ReportMangerTimes1"></label> Current Time:<br /><label data-icon="clock" id="ReportMangerTimes2"></label>
                    </div>
                    <div data-role="navbar">
                        <ul>
                            <li>
                                <a data-icon="action" onclick=ReportCleaningManger();>נקה תוכן</a>
                            </li>
                        </ul>
                    </div>
                    <br>
                    <label id="daysinmonth"></label>
                    <br>
                    <div data-role="content">
                        <form action="">

                            <label id="ReportTablesStatusing"></label>
                            <br>
                            <input type="text" id="ReportYearsManger" name="ReportYears" placeholder="insert year" />
                            <br>


                            <select data-icon="tag" id="DepartmentSelect" onchange=NamesTable2();>בחר מחלקה </select>
                            <br>


                            <label id="WorkersSelectMangering">בחר עובד:</label>
                            <select data-icon="user" id="WorkersSelectManger">בחר עובד</select>


                            <br>
                            <br />
                            <p>
                                <select data-icon="calendar" id="MonthsManger" name="בחר חודש" onchange=ReportEvents2Manger();>
                                    <option value="00">בחר חודש</option>
                                    <option value="01">ינואר</option>
                                    <option value="02">פבואר</option>
                                    <option value="03">מרץ</option>
                                    <option value="04">אפריל</option>
                                    <option value="05">מאי</option>
                                    <option value="06">יוני</option>
                                    <option value="07">יולי</option>
                                    <option value="08">אוגוסט</option>
                                    <option value="09">ספטמבר</option>
                                    <option value="10">אוקטובר</option>
                                    <option value="11">נובמבר</option>
                                    <option value="12">דצמבר</option>

                                </select>


                                <div data-role="content">
                                    <div data-role="collapsible-set" id="ReportTables"></div>
                                </div>

                                <br />
                                <label id="ChooshenDepartment"></label>

                                <label id="daysinmonth"></label>

                                <div id="StartHour"></div> <div id="FinishHour"></div>


                                <br>


                                <!--<label for="something">סכום שעות כולל של עובד:</label>-->
                                <div id="SumHours"></div> <!--</li>-->
                                <br>
                        </form>
                        <div data-role="footer" class="ui-bar" data-position="locked">
                            <div data-role="navbar">
                                <ul>
                                    <li>
                                        <a data-icon="calendar" id="DoubleClick" onclick=VacationsReportEventsTableManger();>דו"ח בטבלה</a>
                                    </li>
                                    <li>
                                        <a data-icon="info" onclick=ReportDailyManger();>יומי</a>
                                    </li>
                                    <li>
                                        <a data-icon="tag" onclick=ReportsumsManger();>הצג סיכום</a>
                                    </li>
                                    <li>
                                        <a data-icon="cloud" onclick=VacationsReportEventsManger();>חופשות</a>
                                    </li>
                                </ul>
                            </div>

                        </div>
                    </div>
                </div>


                <div id="AddWorkers" data-role="page">
                    <div data-role="header">

                        <div data-role="header">
                            <a data-icon="back" onclick=WorkersStatusPre();>חזור לדף עובדים</a>
                            <br />
                            <br />
                            <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
                            Current Date:<label data-icon="clock" id="AddWorkersTimes1"></label> Current Time:<br /><label data-icon="clock" id="AddWorkersTimes2"></label>

                        </div>

                        <br>

                        <label id="WorkerEnterStatus"></label>

                        <!--<div data-role="ID">
                            <label data-icon="user" for="ID"></label>
                            <input type="text" id="ID" name="ID" placeholder="הכנס ת.ז" />
                        </div>-->


                        <div data-role="WorkerName">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-user ui-btn-icon-notext"></a>

                            <br>
                            <input type="text" id="WorkerName" name="WorkerName" placeholder="הכנס שם עובד" />
                        </div>


                        <div data-role="WorkerMails">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-mail ui-btn-icon-notext"></a>
                            <br>
                            <input type="text" id="WorkerMails" name="WorkerMails" placeholder="הכנס מייל" />
                        </div>



                        <div data-role="PassWord">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-lock ui-btn-icon-notext"></a>
                            <br>
                            <input type="text" id="PassWord" name="PassWord" placeholder="הכנס ססמא" />
                        </div>



                        <div data-role="WorkerDepartments">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-tag ui-btn-icon-notext" name="בחר מחלקה">בחר מחלקה</a>
                            <br>
                            <label data-icon="tag" id="WorkerDepartmentsss">בחר מחלקה</label>
                            <select data-icon="calendar" id="WorkerDepartments" name="בחר מחלקה"></select>
                        </div>


                        <div data-role="WorkerLocation">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-location ui-btn-icon-notext"></a>
                            <br>
                            <input type="text" id="WorkerLocation" name="WorkerLocation" placeholder="הכנס מיקום" />
                        </div>



                        <div data-role="WorkerPhone">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-phone ui-btn-icon-notext"></a>
                            <br>
                            <input type="text" id="WorkerPhone" name="WorkerPhone" placeholder="הכנס מספר טלפון" />
                        </div>


                        <div data-role="WorkerDistance">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-navigation ui-btn-icon-notext"></a>
                            <br>
                            <input type="text" id="WorkerDistance" name="WorkerDistance" placeholder="הכנס מרחק" />
                        </div>



                        <div data-role="WorkerAddress">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-navigation ui-btn-icon-notext"></a>
                            <br>

                            <input type="text" id="WorkerAddress" name="WorkerAddress" placeholder="הכנס כתובת" />
                        </div>

                        <div data-role="Active">
                            <label for="Active"></label>
                            <br>


                            <select id="Active" name="מצב עובד">
                                <option data-icon="check" value="true">פעיל</option>
                                <option data-icon="delete" value="false">לא פעיל</option>
                            </select>

                            <label id="DepartmentID"></label>

                            <div data-role="footer" class="ui-bar" data-position="locked">
                                <div data-role="navbar">
                                    <ul>

                                        <li>
                                            <a data-icon="plus" onclick=GetDepartmentToAdd();>הכנס עובד</a>
                                        </li>
                                    </ul>
                                </div>

                                <br>


                            </div>
                        </div>
                    </div>
                </div>



                <div id="UpdateWorkers" data-role="page">
                    <div data-role="header">
                        <h1>
                            <!--מעדכן מצב עובד בחברה-->
                        </h1>
                        Current Date:<label data-icon="clock" id="UpdateWorkersTimes1"></label> Current Time:<br /><label data-icon="clock" id="UpdateWorkersTimes2"></label>
                        <a data-icon="back" onclick=WorkersStatusPre();>חזור לדף עובדים</a>
                        <br />
                        <br />
                        <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
                    </div>
                    <div data-role="content">
                        <form action="">
                            <h1>
                                <!--מצב עובד:-->
                            </h1>
                            <label id="WorkStatusManger"></label>
                            <br />

                            <label id="WorkStatusAtive"></label>
                            <br />

                            <label id="WorkerUpdatedStatus"></label>
                            <br />



                            <label id="IfUpdateWorked"></label>
                            <br />


                            <label id="StartWorkStatus"></label>
                            <br />

                            <label id="EndWorkStatus"></label>
                            <br />
                        </form>

                        <h1>
                            עובדיים כלליים בחברה
                        </h1>

                        <select id="DepartmentSelect2" onchange=NamesTable2();>בחר מחלקה </select>
                        <br>



                        <label id="WorkersSelect2ing">בחר עובד:</label>
                        <select id="WorkersSelect2" onchange=GetWorkerByID();>בחר עובד </select>


                        <br>

                        <button id="finish" data-icon="clock" onclick=ForceEndWorking();>סיים עבודה יומית</button>
                        <br>


                        <button data-icon="minus" onclick=setflag0();>עדכן לא פעיל</button>
                        <br>
                        <button data-icon="plus" onclick=setflag1();>עדכן פעיל</button>
                        <br>

                        <!--<button onclick=DeleteWorker();>מחק עובד</button>

                        <br>
                        -->

                        <h3>עדכן פרטים נוספים:</h3>


                        <div data-role="ID">
                            <label for="ID"></label>
                            <br>

                            <input type="text" id="ID2" name="ID" placeholder="תעודת זהות:" />
                        </div>


                        <div data-role="WorkerName">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-user ui-btn-icon-notext"></a>
                            <input type="text" id="WorkerName2" name="WorkerName" placeholder="שם משתמש:" />
                        </div>


                        <div data-role="WorkerMail">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-mail ui-btn-icon-notext"></a>
                            <input type="text" id="WorkerMail" name="WorkerMail" placeholder="מייל עובד:" />
                        </div>
                        <br>



                        <div data-role="PassWord">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-lock ui-btn-icon-notext"></a>
                            <br>


                            <input type="text" id="PassWord2" name="PassWord" placeholder="ססמא:" />
                        </div>

                        <br>



                        <input type="button" data-icon="tag" value="בחר מחלקה">
                        <select data-icon="calendar" id="WorkerDepartmentsUpdate" name="בחר מחלקה" onchange="FlagToShowWorker();">בחר מחלקה</select>

                        <div data-role="WorkerDepartments">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-tag ui-btn-icon-notext"></a>

                            <br>

                            <label id="WorkerDepartment2"></label>
                        </div>


                        <div data-role="WorkerLocation">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-location ui-btn-icon-notext"></a>
                            <br>


                            <input type="text" id="WorkerLocation2" name="WorkerLocation" placeholder="מיקום:" />
                        </div>

                        <br>

                        <div data-role="WorkerPhone">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-phone ui-btn-icon-notext"></a>
                            <br>


                            <input type="text" id="WorkerPhone2" name="WorkerPhone" placeholder="מספר טלפון:" />
                        </div>


                        <div data-role="WorkerDistance">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-navigation ui-btn-icon-notext"></a>
                            <br>


                            <input type="text" id="WorkerDistance2" name="WorkerDistance" placeholder="מרחק:" />
                        </div>



                        <div data-role="WorkerAddress">
                            <a href="#" class="ui-btn ui-corner-all ui-icon-navigation ui-btn-icon-notext"></a>
                            <br>


                            <input type="text" id="WorkerAddress2" name="WorkerAddress" placeholder="כתובת:" />
                        </div>

                        <br>

                        <div data-role="navbar">
                            <ul>
                                <li>



                                    <button data-icon="gear" onclick=FlagupdateWorker();>שלח עדכון</button>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>




                <div id="WorkersStatus" data-role="page">
                    <div data-role="header">
                        <h1></h1>

                    </div>

                    <div data-role="header">
                        <a data-icon="back" onclick=BackToIndexManger();>חזור לדף ראשי </a>
                        <br />
                        <br />
                        <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
                        Current Date:<label id="WorkersStatusTimes1"></label>
                        Current Time:<label id="WorkersStatusTimes2"></label>
                    </div>
                    <br />

                    <div data-role="content">
                        <form action="">

                            <button data-icon="user" id="VecationsR" onclick=AddWorkers();>הוסף עובד</button>
                            <br>



                            <button data-icon="info" id="VecationsM" onclick=UpdateWorkers();>עדכן מצב עובד בחברה</button>
                            <br>

                            <br>


                            <button data-icon="info" id="VecationsM" onclick=WorkersDepartments();>מחלקות ועובדים</button>
                            <br>


                        </form>


                    </div>
                </div>



                <div id="VacationsManger" data-role="page">
                    <div data-role="header">
                        <h1>
                            <!--ניהול חופשות עובדים-->
                        </h1>

                        <a data-icon="back" class="ui-btn-right" onclick=BackToIndexManger();>חזור לדך הראשי </a>
                        <br />
                        <br />
                        <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
                        Current Date:<label data-icon="clock" id="VacationsMangerTimes1"></label> Current Time:<br /><label data-icon="clock" id="VacationsMangerTimes2"></label>

                    </div>
                    <br>
                    <br>
                    <br>
                    <button data-icon="user" id="VecationsManger" onclick=VacationsArray();> ניהול בקשת חופשות</button>
                    <br>


                    <button data-icon="info" id="VecationsM" onclick=GetPresenceHistory();> דו"ח  היסטוריית חופשות</button>
                    <br>

                </div>


                <div id="VecationsManger" data-role="page">
                    <div data-role="header">
                        <h1>
                            <!--ניהול בקשת חופשות-->
                        </h1>
                        Current Date:<label data-icon="clock" id="VecationsMangerTimes1"></label> Current Time:<br /><label data-icon="clock" id="VecationsMangerTimes2"></label>

                        <a class="ui-btn-right" data-icon="back" onclick=BackToman();>חזור לדף ניהול חופשות </a>
                        <br />
                        <br />
                        <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
                    </div>
                    <br />

                    <br>

                    <br>


                    <h3>
                        בקשות חופשה שהתקבלו:
                    </h3>
                    <div data-role="content">
                        <div data-role="collapsible-set" id="WorkersSelect3"></div>
                    </div>

                    <div data-role="footer" class="ui-bar" data-position="fixed">
                    </div>
                </div>


                <div id="VacationsHistory" data-role="page">
                    <div data-role="header">
                        <h1>
                            <!--ניהול בקשת חופשות-->
                        </h1>
                        Current Date:<label data-icon="clock" id="VacationsHistoryTimes1"></label> Current Time:<br /><label data-icon="clock" id="VacationsHistoryTimes2"></label>
                        <a class="ui-btn-right" data-icon="back" onclick=BackToman();>חזור אחורה </a>
                        <br />
                        <br />
                        <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
                    </div>
                    <br />

                    <br>

                    <br>


                    <h3>
                        היסטוריית בקשות חופשה לפי עובד
                    </h3>

                    <div data-role="content">
                        <div data-role="collapsible-set" id="WorkersSelect4Manger"></div>

                    </div>
                    <!--<h3>היסטוריית בקשות חופשה</h3>-->

                    <div data-role="footer" class="ui-bar" data-position="fixed">
                    </div>
                </div>


                <div id="Departments" data-role="page">
                    <div data-role="header">
                        <h1>
                            <!--מחלקות והודעות-->
                        </h1>
                        Current Date:<label data-icon="clock" id="DepartmentsTimes1"></label> Current Time:<br /><label data-icon="clock" id="DepartmentsTimes2"></label>

                        <a class="ui-btn-right" onclick=BackToIndexManger();>חזור לדך הראשי </a>
                        <br />
                        <br />
                        <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
                    </div>
                    <br />

                    <div data-role="content">
                        <form action="">


                            <button data-icon="comment" id="" onclick=DepartmentForumManger();>ניהול פורום מחלקות</button>
                            <br>



                            <button data-icon="shop" id="DepartmentsReport" onclick=DepartmentsManagement();>ניהול מחלקות</button>
                            <br>




                        </form>


                    </div>
                </div>




                <div id="DepartmentsManagement" data-role="page">
                    <div data-role="header">
                        <h1>
                            <!--ניהול מחלקות-->
                        </h1>

                        <a data-icon="back" class="ui-btn-corner-all" onclick=MainDepartments();>חזור לניהול מחלקות</a>

                        <a data-icon="home" onclick=Exit();>חזור לעמוד ההתחברות</a>


                        Current Date:<label data-icon="clock" id="DepartmentsManagementTimes1"></label> Current Time:<br /><label data-icon="clock" id="DepartmentsManagementTimes2"></label>
                    </div>
                    <div data-role="content">
                        <div data-role="collapsible-set" id="Departmentable"></div>
                        <br>
                    </div>

                    <label id="AddDepartmentorNot"></label>
                    <br>
                    <br>

                    <div data-role="Department">
                        <label for="Department"></label>
                        <br>

                        <input type="text" placeholder="שם מחלקה:" id="EnterDepartment" name="ID" />
                    </div>


                    <div data-role="DepartmentPhone">
                        <label for="DepartmentPhone"></label>
                        <br>


                        <input placeholder="מספר טלפון:" type="text" id="DepartmentPhone" name="DepartmentPhone" />
                    </div>


                    <div data-role="DepartmentPhonemail">
                        <label for="DepartmentPhonemail"></label>

                        <input placeholder="אי מייל:" type="text" id="DepartmentPhonemail" name="DepartmentPhonemail" />
                    </div>


                    <br>


                    <select id="DepartmenActive" name="מצב מחלקה">
                        <option value="true">פעילה</option>
                        <option value="false">לא פעילה</option>
                    </select>

                    <br>


                    <button data-icon="plus" onclick=CompareDepartments();>הוסף מחלקה</button>

                </div>






                <div id="Chet" data-role="page">

                    <div data-role="header">


                        <a data-icon="back" onclick=MainDepartments();>חזור לניהול מחלקות</a>
                        <br />
                        <br />
                        <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>


                        Current Date:
                        <label data-icon="clock" id="ChetTimes1"></label> Current Time:
                        <br />
                        <label data-icon="clock" id="ChetTimes2"></label>
                    </div>

                    <div data-role="navbar">
                        <ul>
                            <li>
                                <a data-icon="action" onclick=ForumsCleaning();>ניקוי </a>
                            </li>
                        </ul>
                    </div>
                    <div data-role="content">
                        <div data-role="collapsible-set" id="Users"></div>
                    </div>
                    <br>

                    <label id="ChetID"></label>

                    <!--<input type="text" id="LSname" />-->

                    <label for="SearchMessages"></label>
                    <textarea rows="4" id="TextArea" cols="50" placeholder="טען הודעה לעריכה"></textarea>

                    <!--<fieldset style="width:440px;clear:both;display:block;margin:5px;">
                    <p style="text-align:center;">-->
                    <!--</p>
                    </fieldset>-->


                    <label for="SearchMessages"></label>
                    <input type="text" id="SearchMessages" name="SearchMessages" placeholder="הכנס הודעה לחיפוש...." />
                    <br>
                    <br>

                    <label for="ByYear">תאריך הודעה:</label>
                    <input type="date" id="ByYearManger" value="תאריך הודעה">
                    <br>
                    <div data-role="content">
                        <div data-role="collapsible-set" id="MessagesTable"></div>
                    </div>
                    <br>




                    <div data-role="footer" class="ui-bar" data-position="locked">

                        <div data-role="navbar">



                            <ul>
                                <li>
                                    <a data-icon="comment" onclick=CreateTopicPageManger();>הגב למחלקה</a>
                                </li>

                                <li>
                                    <a data-icon="arrow-u-l" onclick=Loadtextblank();>טען לטקסטבוקס</a>
                                </li>
                                <li>

                                    <a data-icon="check" onclick=FlagUpdateManger();>עריכה מהירה</a>
                                </li>

                                <li>
                                    <a data-icon="delete" onclick=FlagDeleteManger();>מחיקה מהירה</a>
                                </li>
                                <li>
                                    <a data-icon="eye" onclick=LoadtextWithTopic();>לעריכה מלאה</a>
                                </li>
                                <li>
                                    <a data-icon="minus" onclick=FlagReport();>הסר דיווח </a>
                                </li>
                            </ul>
                        </div>

                        <!--<input type="button" id="TextUpdate" value="צור נושא חדש לפורום מחלקה נבחר" onclick="UpdateDepartmentsMassaging()" />-->
                        <!--<button id="TextUpdate" onclick=UpdateDepartmentsMassaging();> צפה בהודעה המלאה כולל נושא</button>-->
                        <!--<button id="TextUpdate" onclick=UpdateDepartmentsMassaging();> אשר עדכון הודעה</button>

                        <button id="TextDelete" onclick=DeleteDepartmentsMassaging();>מחק הודעה</button>-->

                    </div>


                </div>

                <!--/שליחת הודעות פורום-->
                <div id="UpdateOrDeletePageWithTopicManger" data-role="page">
                    <div data-role="header">
                        <a data-icon="back" onclick=BackToForums();>חזור לפורום</a>
                        <h1>ערוך או מחק הודעה</h1>
                    </div>
                    <div data-role="content">
                        <form action="">
                            <label id="DepartmentsMessagesID"></label>
                            <fieldset data-role="fieldcontain" style="border:1px solid black;padding:5px;">
                                <legend>הודעה לעריכה:</legend>
                                <br>
                                <label id="textDate2Manger" for="text">תאריך הודעה:</label>
                                <br>
                                <label for="text">כותרת  הודעה:</label>
                                <input type="text" id="textUpdateTopicManger" name="textUpdateTopic" placeholder="הכנס טקסט" />
                                <br>
                                <br>
                                <textarea id="AreaTexts4update2Manger" name="AreaText" placeholder="הכנס הודעה"></textarea>
                            </fieldset>
                        </form>
                        <label id="MessageIDManger"></label>
                        <label id="TopicIDManger"></label>
                        <label id="DepartmentssMessages"></label>
                    </div>
                    <div data-role="footer" class="ui-bar" data-position="fixed">
                        <a onclick=UpdateWithTopicManger();>עדכן הודעה</a>
                        <a onclick=DeleteMassagingManger();>מחק הודעה</a>
                    </div>
                </div>



                <div id="CreateTopicPageManger" data-role="page">
                    <div data-role="header">
                        <!--onclick=BackToman();-->

                        <a data-icon="back" onclick=BackToForums();>חזור לפורום</a>
                        <!--<h1>הכנס נושא לפורום מחלקה נבחר</h1>-->
                    </div>
                    <br>
                    <br>
                    <br>
                    <br>
                    <label id="DepartmentForumsMangerSelectings">בחר מחלקה להגיב:</label>
                    <br>
                    <br>
                    <select id="DepartmentSelectForums">בחר מחלקה </select>
                    <br>
                    <br>
                    <label id="DepartmentForumsMangerError"></label>


                    <br>
                    <br>
                    <div data-role="content">
                        <form action="">
                            <fieldset data-role="fieldcontain" style="border:1px solid black;padding:5px;">
                                <legend>צור הודעה:</legend>
                                <label for="text">כותרת הודעה:</label>
                                <input type="text" id="textTopicManger" name="text" placeholder="הכנס טקסט" />
                                <br>
                                <textarea id="AreaTextsManger" name="AreaText" placeholder="הכנס הודעה"></textarea>
                            </fieldset>
                        </form>
                    </div>
                    <div data-role="footer" class="ui-bar" data-position="locked">
                        <a onclick=GetDMessagesIDManger();>צור הודעה</a>
                    </div>
                </div>





                <div id="UpdateOrDeletePageManger" data-role="page">
                    <div data-role="header">
                        <a onclick=WorkersInfoManger();>חזור לפורום</a>
                        <h1>הכנס נושא לפורום</h1>
                    </div>
                    <div data-role="content">
                        <form action="">
                            <fieldset data-role="fieldcontain" style="border:1px solid black;padding:5px;">
                                <legend>הודעה לעריכה:</legend>
                                <br>

                                <input type="date" id="textDateManger" value="הכנס תאריך התחלה">

                                <br>
                                <br>

                                <textarea id="AreaTexts4updateManger" name="AreaText" placeholder="הכנס הודעה"></textarea>
                            </fieldset>
                        </form>
                    </div>
                    <div data-role="footer" class="ui-bar" data-position="fixed">
                        <a onclick=UpdateDepartmentsMassagingManger();>עדכן הודעה</a>
                        <a onclick=Search4Last();>מחק הודעה</a>
                    </div>
                </div>


                <div id="LocationConfirm" data-role="page">
                    <div data-role="header">
                        <h1></h1>
                        Current Date:<label data-icon="clock" id="LocationConfirmTimes1"></label> Current Time:<br /><label data-icon="clock" id="LocationConfirmTimes2"></label>
                        <a class="ui-btn-right" data-icon="back" onclick=DistencePageChange();>חזור אחורה </a>
                        <br />
                        <br />
                        <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
                    </div>
                    <div data-role="navbar">



                        <ul>
                            <li>
                                <button data-icon="check" onclick="UpdateDistence();">אשר מיקום</button>

                            </li>
                            <li>
                                <button data-icon="action" onclick="CleanMap();">נקה מפה</button>
                            </li>
                            <li>
                                <button data-icon="location" onclick="LoadLocation();">צפה במיקום</button>
                            </li>
                        </ul>
                        <br>
                        <br>
                    </div>
                    <div id="googleMap" style="width:500px;height:380px;"></div>
                </div>


    <div id="UpdateOrDeletePageManger" data-role="page">
        <div data-role="header">
            <a onclick=WorkersInfoManger();>חזור לפורום</a>
            <h1>הכנס נושא לפורום</h1>
        </div>
        <div data-role="content">
            <form action="">
                <fieldset data-role="fieldcontain" style="border:1px solid black;padding:5px;">
                    <legend>הודעה לעריכה:</legend>
                    <br>

                    <input type="date" id="textDateManger" value="הכנס תאריך התחלה">

                    <br>
                    <br>

                    <textarea id="AreaTexts4updateManger" name="AreaText" placeholder="הכנס הודעה"></textarea>
                </fieldset>
            </form>
        </div>
        <div data-role="footer" class="ui-bar" data-position="fixed">
            <a onclick=UpdateDepartmentsMassagingManger();>עדכן הודעה</a>
            <a onclick=Search4Last();>מחק הודעה</a>
        </div>
    </div>


    <div id="WorkersDepartments" data-role="page">
        <div data-role="header">
            <h1></h1>
            Current Date:<label data-icon="clock" id="WorkersDepartmentsTimes1"></label> Current Time:<br /><label data-icon="clock" id="WorkersDepartmentsTimes2"></label>
            <a class="ui-btn-right" data-icon="back" onclick=DistencePageChange();>חזור אחורה </a>
            <br />
            <br />
            <a data-icon="home" onclick=Exit();>חזור לעמוד התחברות </a>
        </div>

        <!--<label id="WorkersDepartmentsTables"></label>-->
        <br>
    </div>

</body>
        </html>


